[
	{
		"desc": "parserTests"
	},
	{
		"desc": "Simple paragraph",
		"wikitext": "This is a simple paragraph.",
		"tokens": [
			{
				"text": "This is a simple paragraph.",
				"name": ""
			}
		]
	},
	{
		"desc": "Paragraphs with extra newline spacing",
		"wikitext": "a\n\nb (+2 nls)\n\n\nc (+3 nls)\n\n\n\nd (+4 nls)\n\n\n\n\ne (+5 nls)",
		"tokens": [
			{
				"text": "ab (+2 nls)c (+3 nls)d (+4 nls)e (+5 nls)",
				"name": ""
			}
		]
	},
	{
		"desc": "Paragraphs with newline spacing with comment lines in between",
		"wikitext": "----\na\n<!--foo-->\nb\n----\na\n<!--foo--><!--More than 1 comment, still stripped-->\nb\n----\na\n <!--foo--> <!----> <!-- bar --> \nb\n----\na\n<!--foo-->\n\nb\n----\na\n\n<!--foo-->\nb\n----\na\n<!--foo-->\n\n\nb\n----\na\n\n\n<!--foo-->\nb\n----",
		"tokens": [
			{
				"text": "----",
				"name": "hr"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": "<!--foo-->",
				"name": "comment"
			},
			{
				"text": "b",
				"name": ""
			},
			{
				"text": "----",
				"name": "hr"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": "<!--foo--><!--More than 1 comment, still stripped-->",
				"name": "comment"
			},
			{
				"text": "b",
				"name": ""
			},
			{
				"text": "----",
				"name": "hr"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "<!--foo-->",
				"name": "comment"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "<!---->",
				"name": "comment"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "<!-- bar -->",
				"name": "comment"
			},
			{
				"text": " b",
				"name": ""
			},
			{
				"text": "----",
				"name": "hr"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": "<!--foo-->",
				"name": "comment"
			},
			{
				"text": "b",
				"name": ""
			},
			{
				"text": "----",
				"name": "hr"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": "<!--foo-->",
				"name": "comment"
			},
			{
				"text": "b",
				"name": ""
			},
			{
				"text": "----",
				"name": "hr"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": "<!--foo-->",
				"name": "comment"
			},
			{
				"text": "b",
				"name": ""
			},
			{
				"text": "----",
				"name": "hr"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": "<!--foo-->",
				"name": "comment"
			},
			{
				"text": "b",
				"name": ""
			},
			{
				"text": "----",
				"name": "hr"
			}
		]
	},
	{
		"desc": "Paragraphs with newline spacing with non-empty white-space lines in between",
		"wikitext": "----\na\n \nb\n----\na\n \n \nb\n----",
		"tokens": [
			{
				"text": "----",
				"name": "hr"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "b",
				"name": ""
			},
			{
				"text": "----",
				"name": "hr"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": "  ",
				"name": "skipformatting"
			},
			{
				"text": "b",
				"name": ""
			},
			{
				"text": "----",
				"name": "hr"
			}
		]
	},
	{
		"desc": "Paragraphs with newline spacing with non-empty mixed comment and white-space lines in between",
		"wikitext": "----\na\n <!--foo-->\nb\n----\na\n <!--foo--><!--More than 1 comment doesn't disable stripping of this line!-->\nb\n----\na\n \n<!--foo-->\n <!--bar-->\nb\n----\na\n \n <!--foo-->\n <!--bar-->\n \nb\n----",
		"tokens": [
			{
				"text": "----",
				"name": "hr"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "<!--foo-->",
				"name": "comment"
			},
			{
				"text": "b",
				"name": ""
			},
			{
				"text": "----",
				"name": "hr"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "<!--foo--><!--More than 1 comment doesn't disable stripping of this line!-->",
				"name": "comment"
			},
			{
				"text": "b",
				"name": ""
			},
			{
				"text": "----",
				"name": "hr"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "<!--foo-->",
				"name": "comment"
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "<!--bar-->",
				"name": "comment"
			},
			{
				"text": "b",
				"name": ""
			},
			{
				"text": "----",
				"name": "hr"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": "  ",
				"name": "skipformatting"
			},
			{
				"text": "<!--foo-->",
				"name": "comment"
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "<!--bar-->",
				"name": "comment"
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "b",
				"name": ""
			},
			{
				"text": "----",
				"name": "hr"
			}
		]
	},
	{
		"desc": "Extra newlines: More paragraphs with indented comment",
		"wikitext": "a\n\n   <!--boo-->\n\nb",
		"tokens": [
			{
				"text": "a",
				"name": ""
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "  ",
				"name": ""
			},
			{
				"text": "<!--boo-->",
				"name": "comment"
			},
			{
				"text": "b",
				"name": ""
			}
		]
	},
	{
		"desc": "Extra newlines followed by heading",
		"wikitext": "a\n\n\n=b=\n[[a]]\n\n\n=b=",
		"tokens": [
			{
				"text": "a",
				"name": ""
			},
			{
				"text": "=",
				"name": "section-header section--1"
			},
			{
				"text": "b",
				"name": "section"
			},
			{
				"text": "=",
				"name": "section-header"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "a",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "=",
				"name": "section-header section--1"
			},
			{
				"text": "b",
				"name": "section"
			},
			{
				"text": "=",
				"name": "section-header"
			}
		]
	},
	{
		"desc": "Extra newlines between heading and content are swallowed (Parsoid does not)",
		"wikitext": "=b=\n\n\n\n[[a]]",
		"tokens": [
			{
				"text": "=",
				"name": "section-header section--1"
			},
			{
				"text": "b",
				"name": "section"
			},
			{
				"text": "=",
				"name": "section-header"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "a",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Extra new lines before and after lists are preserved",
		"wikitext": "a\n\n\n*b\n\n\nc",
		"tokens": [
			{
				"text": "a",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "bc",
				"name": ""
			}
		]
	},
	{
		"desc": "Multiple newlines after tables are converted to p-br-p tags",
		"wikitext": "{|\n|x\n|}\n\n\n\n\n=b=",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "x",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			},
			{
				"text": "=",
				"name": "section-header section--1"
			},
			{
				"text": "b",
				"name": "section"
			},
			{
				"text": "=",
				"name": "section-header"
			}
		]
	},
	{
		"desc": "Heading with line break in nowiki",
		"wikitext": "==A <nowiki>B\nC</nowiki>==",
		"tokens": [
			{
				"text": "==A ",
				"name": ""
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "BC",
				"name": "tag-nowiki"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "==",
				"name": ""
			}
		]
	},
	{
		"desc": "Heading with nonbreaking space in prefix/suffix (T235684)",
		"wikitext": "== &nbsp; A &nbsp; B &nbsp; ==",
		"tokens": [
			{
				"text": "==",
				"name": "section-header section--2"
			},
			{
				"text": " ",
				"name": "section"
			},
			{
				"text": "&nbsp;",
				"name": "entity"
			},
			{
				"text": " A ",
				"name": "section"
			},
			{
				"text": "&nbsp;",
				"name": "entity"
			},
			{
				"text": " B ",
				"name": "section"
			},
			{
				"text": "&nbsp;",
				"name": "entity"
			},
			{
				"text": " ",
				"name": "section"
			},
			{
				"text": "==",
				"name": "section-header"
			}
		]
	},
	{
		"desc": "Heading with literal wikitext - the wikitext is not parsed in section edit link tooltip",
		"wikitext": "== <nowiki>{{PAGENAME}}</nowiki> ==\n== &#123;&#123;PAGENAME}} ==",
		"tokens": [
			{
				"text": "==",
				"name": "section-header section--2"
			},
			{
				"text": " ",
				"name": "section"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "{{PAGENAME}}",
				"name": "tag-nowiki"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": " ",
				"name": "section"
			},
			{
				"text": "==",
				"name": "section-header"
			},
			{
				"text": "==",
				"name": "section-header section--2"
			},
			{
				"text": " ",
				"name": "section"
			},
			{
				"text": "&#123;&#123;",
				"name": "entity"
			},
			{
				"text": "PAGENAME}} ",
				"name": "section"
			},
			{
				"text": "==",
				"name": "section-header"
			}
		]
	},
	{
		"desc": "Parsing an URL",
		"wikitext": "http://fr.wikipedia.org/wiki/üç∫\n<!-- EasterEgg we love beer, better be able be able to link to it -->",
		"tokens": [
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "fr.wikipedia.org/wiki/üç∫",
				"name": "free-extlink"
			},
			{
				"text": "<!-- EasterEgg we love beer, better be able be able to link to it -->",
				"name": "comment"
			}
		]
	},
	{
		"desc": "Simple list",
		"wikitext": "*Item 1\n*Item 2",
		"tokens": [
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "Item 1",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "Item 2",
				"name": ""
			}
		]
	},
	{
		"desc": "Non-html5 tags should be accepted",
		"wikitext": "<center>''foo''</center>\n<big>''foo''</big>\n<font style=\"123\">''foo''</font>\n<strike>''foo''</strike>\n<tt>''foo''</tt>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "center",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "foo",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "center",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "big",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "foo",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "big",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "font ",
				"name": "htmltag-name"
			},
			{
				"text": "style=\"123\"",
				"name": "htmltag-attribute html-font"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "foo",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "font",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "strike",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "foo",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "strike",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "tt",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "foo",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "tt",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "<wbr> is valid wikitext (T54468)",
		"wikitext": "<wbr>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "wbr",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "<s> or <strike> for strikethrough",
		"wikitext": "<strike>strike</strike>\n\n<s>s</s>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "strike",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "strike",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "strike",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "s",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "s",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "s",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Text-level semantic html elements in wikitext",
		"wikitext": "<em>text</em>\n<strong>text</strong>\n<small>text</small>\n<s>text</s>\n<cite>text</cite>\n<q>text</q>\n<dfn>text</dfn>\n<abbr>text</abbr>\n<data>text</data>\n<time>text</time>\n<code>text</code>\n<var>text</var>\n<samp>text</samp>\n<kbd>text</kbd>\n<sub>text</sub>\n<u>text</u>\n<mark>text</mark>\n<ruby><rb>ÊòéÊó•</rb><rp>(</rp><rt>Ashita</rt><rp> </rp><rtc>„ÅÇ„Åó„Åü</rtc><rp>)</rp></ruby>\n<bdi>text</bdi>\n<bdo>text</bdo>\n<span>text</span>\n<wbr />",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "em",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "text",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "em",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "strong",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "text",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "strong",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "small",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "text",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "small",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "s",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "text",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "s",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "cite",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "text",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "cite",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "q",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "text",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "q",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "dfn",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "text",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "dfn",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "abbr",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "text",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "abbr",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "data",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "text",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "data",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "time",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "text",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "time",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "code",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "text",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "code",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "var",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "text",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "var",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "samp",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "text",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "samp",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "kbd",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "text",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "kbd",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "sub",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "text",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "sub",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "u",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "text",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "u",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "mark",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "text",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "mark",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "ruby",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "rb",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "ÊòéÊó•",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "rb",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "rp",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "(",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "rp",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "rt",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Ashita",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "rt",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "rp",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "rp",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "rtc",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "„ÅÇ„Åó„Åü",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "rtc",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "rp",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": ")",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "rp",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "ruby",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "bdi",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "text",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "bdi",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "bdo",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "text",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "bdo",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "span",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "text",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "span",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "wbr ",
				"name": "htmltag-name"
			},
			{
				"text": "/>",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Ruby markup (W3C-style)",
		"wikitext": ";Mono-ruby for individual base characters\n:<ruby>Êó•<rt>„Å´</rt>Êú¨<rt>„Åª„Çì</rt>Ë™û<rt>„Åî</rt></ruby>\n;Group ruby\n:<ruby>‰ªäÊó•<rt>„Åç„Çá„ÅÜ</rt></ruby>\n;Jukugo ruby\n:<ruby>Ê≥ï<rb>ËèØ</rb><rb>Áµå</rb><rt>„Åª</rt><rt>„Åë</rt><rt>„Åç„Çá„ÅÜ</rt></ruby>\n;Inline ruby\n:<ruby>Êù±<rb>‰∫¨</rb><rp>(</rp><rt>„Å®„ÅÜ</rt><rt>„Åç„Çá„ÅÜ</rt><rp>)</rp></ruby>\n;Double-sided ruby\n:<ruby><rb>Êóß</rb><rb>Èáë</rb><rb>Â±±</rb><rt>ji√π</rt><rt>jƒ´n</rt><rt>shƒÅn</rt><rtc>San Francisco</rtc></ruby>\n\n<ruby>\n<rb>‚ô•</rb><rtc><rt>Heart</rt></rtc><rtc lang=\"fr\"><rt>C≈ìur</rt></rtc>\n<rb>‚òò</rb><rtc><rt>Shamrock</rt></rtc><rtc lang=\"fr\"><rt>Tr√®fle</rt></rtc>\n<rb>‚ú∂</rb><rtc><rt>Star</rt></rtc><rtc lang=\"fr\"><rt>√âtoile</rt></rtc>\n</ruby>",
		"tokens": [
			{
				"text": ";",
				"name": "list"
			},
			{
				"text": "Mono-ruby for individual base characters",
				"name": "strong"
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "ruby",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Êó•",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "rt",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "„Å´",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "rt",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Êú¨",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "rt",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "„Åª„Çì",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "rt",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Ë™û",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "rt",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "„Åî",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "rt",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "ruby",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": ";",
				"name": "list"
			},
			{
				"text": "Group ruby",
				"name": "strong"
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "ruby",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "‰ªäÊó•",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "rt",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "„Åç„Çá„ÅÜ",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "rt",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "ruby",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": ";",
				"name": "list"
			},
			{
				"text": "Jukugo ruby",
				"name": "strong"
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "ruby",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Ê≥ï",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "rb",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "ËèØ",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "rb",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "rb",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Áµå",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "rb",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "rt",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "„Åª",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "rt",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "rt",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "„Åë",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "rt",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "rt",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "„Åç„Çá„ÅÜ",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "rt",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "ruby",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": ";",
				"name": "list"
			},
			{
				"text": "Inline ruby",
				"name": "strong"
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "ruby",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Êù±",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "rb",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "‰∫¨",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "rb",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "rp",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "(",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "rp",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "rt",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "„Å®„ÅÜ",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "rt",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "rt",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "„Åç„Çá„ÅÜ",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "rt",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "rp",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": ")",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "rp",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "ruby",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": ";",
				"name": "list"
			},
			{
				"text": "Double-sided ruby",
				"name": "strong"
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "ruby",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "rb",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Êóß",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "rb",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "rb",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Èáë",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "rb",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "rb",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Â±±",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "rb",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "rt",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "ji√π",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "rt",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "rt",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "jƒ´n",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "rt",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "rt",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "shƒÅn",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "rt",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "rtc",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "San Francisco",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "rtc",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "ruby",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "ruby",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "rb",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "‚ô•",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "rb",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "rtc",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "rt",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Heart",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "rt",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "rtc",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "rtc ",
				"name": "htmltag-name"
			},
			{
				"text": "lang=\"fr\"",
				"name": "htmltag-attribute html-rtc"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "rt",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "C≈ìur",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "rt",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "rtc",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "rb",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "‚òò",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "rb",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "rtc",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "rt",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Shamrock",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "rt",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "rtc",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "rtc ",
				"name": "htmltag-name"
			},
			{
				"text": "lang=\"fr\"",
				"name": "htmltag-attribute html-rtc"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "rt",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Tr√®fle",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "rt",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "rtc",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "rb",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "‚ú∂",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "rb",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "rtc",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "rt",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Star",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "rt",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "rtc",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "rtc ",
				"name": "htmltag-name"
			},
			{
				"text": "lang=\"fr\"",
				"name": "htmltag-attribute html-rtc"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "rt",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "√âtoile",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "rt",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "rtc",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "ruby",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Non-word characters don't terminate tag names (T19663, T42670, T54022)",
		"wikitext": "<blockquote|>a</blockquote>\n\n<b‚Üí> doesn't terminate </b‚Üí>\n\n<b√§> doesn't terminate </b√§>\n\n<boo> doesn't terminate </boo>\n\n<s.foo> doesn't terminate </s.foo>\n\n<sub-ID#1>",
		"tokens": [
			{
				"text": "<blockquote|>a",
				"name": ""
			},
			{
				"text": "</blockquote>",
				"name": "error"
			},
			{
				"text": "<b‚Üí> doesn't terminate </b‚Üí><b√§> doesn't terminate </b√§><boo> doesn't terminate </boo><s.foo> doesn't terminate </s.foo><sub-ID#1>",
				"name": ""
			}
		]
	},
	{
		"desc": "Isolated close tags should be treated as literal text (T54760)",
		"wikitext": "</b>\n\n<s.foo>s</s>",
		"tokens": [
			{
				"text": "</b>",
				"name": "error"
			},
			{
				"text": "<s.foo>s",
				"name": ""
			},
			{
				"text": "</s>",
				"name": "error"
			}
		]
	},
	{
		"desc": "Self-closed tag hooks",
		"wikitext": "<pre />\n<gallery />\n<indicator name=\"something\" />",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "pre ",
				"name": "exttag-name"
			},
			{
				"text": "/><",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery ",
				"name": "exttag-name"
			},
			{
				"text": "/><",
				"name": "exttag-bracket"
			},
			{
				"text": "indicator ",
				"name": "exttag-name"
			},
			{
				"text": "name=\"something\" ",
				"name": "exttag-attribute ext-indicator"
			},
			{
				"text": "/>",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Bare pipe character (T54363)",
		"wikitext": "|",
		"tokens": [
			{
				"text": "|",
				"name": ""
			}
		]
	},
	{
		"desc": "Bare pipe character from a template (T54363)",
		"wikitext": "{{pipe}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "pipe",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Implicit newline insertion/sol when expanding templates (T241150/T14974/T2529)",
		"wikitext": "{{1x|#foo}}{{1x|#foo}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "#foo",
				"name": "template-ground template"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "#foo",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "<nowiki> unordered list",
		"wikitext": "<nowiki>* This is not an unordered list item.</nowiki>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "* This is not an unordered list item.",
				"name": "tag-nowiki"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "<nowiki> spacing",
		"wikitext": "<nowiki>Lorem ipsum dolor\n\nsed abit.\n  sed nullum.\n\n:and a colon\n</nowiki>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "Lorem ipsum dolorsed abit.  sed nullum.:and a colon",
				"name": "tag-nowiki"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Don't parse <nowiki><span class=\"error\"></nowiki> (T149622)",
		"wikitext": "<nowiki><span class=\"error\"></nowiki>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "<span class=\"error\">",
				"name": "tag-nowiki"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "nowiki 3",
		"wikitext": ":There is not nowiki.\n:There is <nowiki>nowiki</nowiki>.\n\n#There is not nowiki.\n#There is <nowiki>nowiki</nowiki>.\n\n*There is not nowiki.\n*There is <nowiki>nowiki</nowiki>.",
		"tokens": [
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "There is not nowiki.",
				"name": ""
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "There is ",
				"name": ""
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "tag-nowiki"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": ".",
				"name": ""
			},
			{
				"text": "#",
				"name": "list"
			},
			{
				"text": "There is not nowiki.",
				"name": ""
			},
			{
				"text": "#",
				"name": "list"
			},
			{
				"text": "There is ",
				"name": ""
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "tag-nowiki"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": ".",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "There is not nowiki.",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "There is ",
				"name": ""
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "tag-nowiki"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": ".",
				"name": ""
			}
		]
	},
	{
		"desc": "Entities inside <nowiki>",
		"wikitext": "<nowiki>&lt;</nowiki>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "&lt;",
				"name": "tag-nowiki entity"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Entities inside template parameters",
		"wikitext": "{{1x|&ndash;}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "&ndash;",
				"name": "template-ground entity"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Nowiki with newlines in list",
		"wikitext": ":<nowiki>test\n123</nowiki>",
		"tokens": [
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "test123",
				"name": "tag-nowiki"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Nowiki and french spacing",
		"wikitext": "<nowiki>test : 123</nowiki>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "test : 123",
				"name": "tag-nowiki"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "French spacing and spans",
		"wikitext": "[[Test]] : <span>123</span>\n¬´ Test ¬ª<span>123</span>",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Test",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " : ",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "span",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "123",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "span",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "¬´ Test ¬ª",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "span",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "123",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "span",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "multiple templates that are redirects",
		"wikitext": "{{redirect to foo}}\n{{redirect to foo}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "redirect to foo",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "redirect to foo",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "T53086: Double newlines in blockquotes should be turned into paragraphs",
		"wikitext": "<blockquote>\nFoo\n\nBar\n</blockquote>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "blockquote",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "FooBar",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "blockquote",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "T17491: <ins>/<del> in blockquote",
		"wikitext": "<blockquote>\nFoo <del>bar</del> <ins>baz</ins> quux\n</blockquote>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "blockquote",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Foo ",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "del",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "bar",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "del",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "ins",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "baz",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "ins",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " quux",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "blockquote",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "T17491: <ins>/<del> in blockquote (2)",
		"wikitext": "<blockquote>Foo <del>bar</del> <ins>baz</ins> quux\n</blockquote>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "blockquote",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Foo ",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "del",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "bar",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "del",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "ins",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "baz",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "ins",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " quux",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "blockquote",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Don't paragraph-wrap empty newlines between HTML list items",
		"wikitext": "<ol>\n<li>foo</li>\n\n\n\n<li>foo</li>\n</ol>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "ol",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "ol",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Templates: Strip leading and trailing whitespace from named-param values",
		"wikitext": "{{1x|1= a }}\n\n{{1x|1= {{1x|b}} }}\n\n{{1x| 1 =\n c }}\n\n{{1x| 1 =\n* d\n}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "1=",
				"name": "template-ground template-argument-name"
			},
			{
				"text": " a ",
				"name": "template-ground template"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "1=",
				"name": "template-ground template-argument-name"
			},
			{
				"text": " ",
				"name": "template-ground template"
			},
			{
				"text": "{{",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template2-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template2-ground template-delimiter"
			},
			{
				"text": "b",
				"name": "template2-ground template"
			},
			{
				"text": "}}",
				"name": "template2-ground template-bracket"
			},
			{
				"text": " }}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": " 1 =",
				"name": "template-ground template-argument-name"
			},
			{
				"text": " c ",
				"name": "template-ground template"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": " 1 =",
				"name": "template-ground template-argument-name"
			},
			{
				"text": "*",
				"name": "template-ground list"
			},
			{
				"text": " d",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates: Don't strip whitespace from positional-param values",
		"wikitext": "{{1x|a }}\n\n{{1x|{{1x|b}} }}\n\n{{1x| c \n}}\n\n{{1x| {{1x|d}}\n}}\n\n{{1x|\n e}}\n\n{{1x|\n*f}}\n\n{{1x|\n }}g",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "a ",
				"name": "template-ground template"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "{{",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template2-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template2-ground template-delimiter"
			},
			{
				"text": "b",
				"name": "template2-ground template"
			},
			{
				"text": "}}",
				"name": "template2-ground template-bracket"
			},
			{
				"text": " }}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": " c ",
				"name": "template-ground template"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": " ",
				"name": "template-ground template"
			},
			{
				"text": "{{",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template2-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template2-ground template-delimiter"
			},
			{
				"text": "d",
				"name": "template2-ground template"
			},
			{
				"text": "}}",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": " e",
				"name": "template-ground template"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "*",
				"name": "template-ground list"
			},
			{
				"text": "f",
				"name": "template-ground template"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": " }}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "g",
				"name": ""
			}
		]
	},
	{
		"desc": "Templates: Don't recognize targets split by newlines",
		"wikitext": "{{ech\no|foo}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "ech",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "o|foo}}",
				"name": ""
			}
		]
	},
	{
		"desc": "Templates: Recognize targets when newlines and comments don't split the target",
		"wikitext": "{{  \n <!--X--> 1<!--X-->x<!--X-->  \n   <!--X-->   <!--X-->\n\n |foo}}",
		"tokens": [
			{
				"text": "{{  ",
				"name": "template-ground template-bracket"
			},
			{
				"text": " ",
				"name": "template-ground"
			},
			{
				"text": "<!--X-->",
				"name": "template-ground comment"
			},
			{
				"text": " 1",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "<!--X-->",
				"name": "template-ground comment"
			},
			{
				"text": "x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "<!--X-->",
				"name": "template-ground comment"
			},
			{
				"text": "  ",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "   ",
				"name": "template-ground"
			},
			{
				"text": "<!--X-->",
				"name": "template-ground comment"
			},
			{
				"text": "   ",
				"name": "template-ground"
			},
			{
				"text": "<!--X-->",
				"name": "template-ground comment"
			},
			{
				"text": " |",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "foo",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates: Target with an extension tag",
		"wikitext": "{{{{1x|1x}}<nowiki>hi</nowiki>|ho}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "{{",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template2-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template2-ground template-delimiter"
			},
			{
				"text": "1x",
				"name": "template2-ground template"
			},
			{
				"text": "}}",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "<",
				"name": "template-ground error"
			},
			{
				"text": "nowiki",
				"name": "template-ground template-name pagename"
			},
			{
				"text": ">",
				"name": "template-ground error"
			},
			{
				"text": "hi",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "<",
				"name": "template-ground error"
			},
			{
				"text": "/nowiki",
				"name": "template-ground template-name pagename"
			},
			{
				"text": ">",
				"name": "template-ground error"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "ho",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates: Handle empty comment-and-ws-only lines correctly",
		"wikitext": "{{1x|foo\n<!--should be ignored-->\n <!--should be ignored as well-->\nbar}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "foo",
				"name": "template-ground template"
			},
			{
				"text": "<!--should be ignored-->",
				"name": "template-ground comment"
			},
			{
				"text": " ",
				"name": "template-ground template"
			},
			{
				"text": "<!--should be ignored as well-->",
				"name": "template-ground comment"
			},
			{
				"text": "bar",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates: Handle comments in the target",
		"wikitext": "{{1x\n<!-- should be ignored -->\n|foo}}\n\n{{1x\n<!-- should be ignored and spaces on next line should not trip us up (T147742) -->\n  |foo}}\n\n{{1x<!-- should be ignored -->\n|foo}}\n\n{{1x<!-- should be ignored -->|foo}}\n\n{{<!-- should be ignored -->1x|foo}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "<!-- should be ignored -->",
				"name": "template-ground comment"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "foo",
				"name": "template-ground template"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "<!-- should be ignored and spaces on next line should not trip us up (T147742) -->",
				"name": "template-ground comment"
			},
			{
				"text": "  |",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "foo",
				"name": "template-ground template"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "<!-- should be ignored -->",
				"name": "template-ground comment"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "foo",
				"name": "template-ground template"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "<!-- should be ignored -->",
				"name": "template-ground comment"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "foo",
				"name": "template-ground template"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "<!-- should be ignored -->",
				"name": "template-ground comment"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "foo",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates: Handle comments in parameter names (T69657)",
		"wikitext": "{{1x|1\n<!-- should be ignored -->\n=foo}}\n\n{{1x|\n<!-- should be ignored -->\n1 = foo}}\n\n{{1x|1<!-- should be ignored -->=foo}}\n\n{{1x|<!-- should be ignored -->1=foo}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "1",
				"name": "template-ground template"
			},
			{
				"text": "<!-- should be ignored -->",
				"name": "template-ground comment"
			},
			{
				"text": "=",
				"name": "template-ground template-argument-name"
			},
			{
				"text": "foo",
				"name": "template-ground template"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "<!-- should be ignored -->",
				"name": "template-ground comment"
			},
			{
				"text": "1 =",
				"name": "template-ground template-argument-name"
			},
			{
				"text": " foo",
				"name": "template-ground template"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "1",
				"name": "template-ground template-argument-name"
			},
			{
				"text": "<!-- should be ignored -->",
				"name": "template-ground comment"
			},
			{
				"text": "=",
				"name": "template-ground template-argument-name"
			},
			{
				"text": "foo",
				"name": "template-ground template"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "<!-- should be ignored -->",
				"name": "template-ground comment"
			},
			{
				"text": "1=",
				"name": "template-ground template-argument-name"
			},
			{
				"text": "foo",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates: Other wikitext in parameter names (T69657)",
		"wikitext": "{{1x|''1''=foo}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "''1''=",
				"name": "template-ground template-argument-name"
			},
			{
				"text": "foo",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates: With colons",
		"wikitext": "{{With: Colon}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "With: Colon",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates: Parsoid parameter escaping test 1",
		"wikitext": "{{1x|[foo]|{{1x|[bar]}}}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "[foo]",
				"name": "template-ground template"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "{{",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template2-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template2-ground template-delimiter"
			},
			{
				"text": "[bar]",
				"name": "template2-ground template"
			},
			{
				"text": "}}",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Parsoid: Pipes in external links in template parameter",
		"wikitext": "{{1x|[{{1x|http://example.com}} link]}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "[",
				"name": "template-ground template"
			},
			{
				"text": "{{",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template2-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template2-ground template-delimiter"
			},
			{
				"text": "http://example.com",
				"name": "template2-ground template"
			},
			{
				"text": "}}",
				"name": "template2-ground template-bracket"
			},
			{
				"text": " link]",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Parsoid: pipe in transclusion parameter",
		"wikitext": "{{1x|http://foo.com/a&#124;b}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "http://foo.com/a",
				"name": "template-ground template"
			},
			{
				"text": "&#124;",
				"name": "template-ground entity"
			},
			{
				"text": "b",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Parsoid: Pipe in template with nested template in external link target in template parameter (seriously)",
		"wikitext": "{{1x|[{{fullurl:{{FULLPAGENAME}}|action=edit}} bar]}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "[",
				"name": "template-ground template"
			},
			{
				"text": "{{",
				"name": "template-ext-ground parserfunction-bracket"
			},
			{
				"text": "fullurl",
				"name": "template-ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "template-ext-ground parserfunction-delimiter"
			},
			{
				"text": "{{",
				"name": "template-ext2-ground parserfunction-bracket"
			},
			{
				"text": "FULLPAGENAME",
				"name": "template-ext2-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "template-ext2-ground parserfunction-bracket"
			},
			{
				"text": "|",
				"name": "template-ext-ground parserfunction-delimiter"
			},
			{
				"text": "action=edit",
				"name": "template-ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "template-ext-ground parserfunction-bracket"
			},
			{
				"text": " bar]",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates parameters with special tokenizing behavior dont get modified because of arg escaping",
		"wikitext": "{{1x|a : b}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "a : b",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates: Preserve blank parameter names",
		"wikitext": "{{1x|=foo}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "=",
				"name": "template-ground template-argument-name"
			},
			{
				"text": "foo",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates: Preserve blank parameter names in other positions",
		"wikitext": "{{blank_param|bar|=foo}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "blank_param",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "bar",
				"name": "template-ground template"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "=",
				"name": "template-ground template-argument-name"
			},
			{
				"text": "foo",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Broken wikilinks (but not external links) prevent templates from closing",
		"wikitext": "[http://example.com x\n\n{{1x|[http://example.com x}}\n\n[[Foo\n\n{{1x|[[Foo}}",
		"tokens": [
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "example.com",
				"name": "link-ground extlink"
			},
			{
				"text": " x",
				"name": "link-ground extlink-text"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "[",
				"name": "template-link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "template-link-ground extlink-protocol"
			},
			{
				"text": "example.com",
				"name": "template-link-ground extlink"
			},
			{
				"text": " x}}",
				"name": "template-link-ground extlink-text"
			},
			{
				"text": "[[",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "Foo",
				"name": "template-link-ground link-pagename pagename"
			},
			{
				"text": "{{",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template2-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template2-ground template-delimiter"
			},
			{
				"text": "[[",
				"name": "template2-link-ground link-bracket"
			},
			{
				"text": "Foo",
				"name": "template2-link-ground link-pagename pagename"
			},
			{
				"text": "}}",
				"name": "template2-link-ground error"
			}
		]
	},
	{
		"desc": "Wikilinks with embedded newlines are not broken",
		"wikitext": "{{1x|[[ Foo\nB\nC]]}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "[[ ",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "Foo",
				"name": "template-link-ground link-pagename pagename"
			},
			{
				"text": "BC]]",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Broken templates",
		"wikitext": "{{1x|[[Foo|}}]]\n\n[[Foo|{{1x|]]}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "[[",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "Foo",
				"name": "template-link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground link-delimiter"
			},
			{
				"text": "}}",
				"name": "template-link-ground link-text"
			},
			{
				"text": "]][[",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "Foo",
				"name": "template-link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground link-delimiter"
			},
			{
				"text": "{{",
				"name": "template2-link-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template2-link-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template2-link-ground template-delimiter"
			},
			{
				"text": "]]",
				"name": "template2-link-ground template"
			},
			{
				"text": "}}",
				"name": "template2-link-ground template-bracket"
			}
		]
	},
	{
		"desc": "Template returning pipe used in wikilink target",
		"wikitext": "[[{{pipe page}}]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "pipe page",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "T4702: Mismatched <i>, <b> and <a> tags are invalid",
		"wikitext": "''[http://example.com text'']\n[http://example.com '''text]'''\n''Something [http://example.com in italic'']\n''Something [http://example.com mixed''''', even bold]'''\n'''''Now [http://example.com both''''']",
		"tokens": [
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "example.com",
				"name": "link-ground extlink"
			},
			{
				"text": " text",
				"name": "link-ground extlink-text em"
			},
			{
				"text": "''",
				"name": "link-ground apostrophes"
			},
			{
				"text": "][",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "example.com",
				"name": "link-ground extlink"
			},
			{
				"text": " ",
				"name": "link-ground extlink-text"
			},
			{
				"text": "'''",
				"name": "link-ground apostrophes"
			},
			{
				"text": "text",
				"name": "link-ground extlink-text strong"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "'''''",
				"name": "apostrophes"
			},
			{
				"text": "Something ",
				"name": "em"
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "example.com",
				"name": "link-ground extlink"
			},
			{
				"text": " in italic",
				"name": "link-ground extlink-text em"
			},
			{
				"text": "''",
				"name": "link-ground apostrophes"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "Something ",
				"name": "em"
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "example.com",
				"name": "link-ground extlink"
			},
			{
				"text": " mixed",
				"name": "link-ground extlink-text em"
			},
			{
				"text": "'''''",
				"name": "link-ground apostrophes"
			},
			{
				"text": ", even bold",
				"name": "link-ground extlink-text strong"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "''''''''",
				"name": "apostrophes"
			},
			{
				"text": "Now ",
				"name": "strong em"
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "example.com",
				"name": "link-ground extlink"
			},
			{
				"text": " both",
				"name": "link-ground extlink-text strong em"
			},
			{
				"text": "'''''",
				"name": "link-ground apostrophes"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "Break on | in element attribute in template",
		"wikitext": "{{1x|1=<div class=\"hi|ho\">ha</div>}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "1=",
				"name": "template-ground template-argument-name"
			},
			{
				"text": "<",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "template-ground htmltag-name"
			},
			{
				"text": "class=\"hi|ho\"",
				"name": "template-ground htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "ha",
				"name": "template-ground template"
			},
			{
				"text": "</",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "div",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Plain link, capitalized",
		"wikitext": "[[Main Page]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Plain link, uncapitalized",
		"wikitext": "[[main Page]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Piped link",
		"wikitext": "[[Main Page|The Main Page]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "The Main Page",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Piped link with comment in link text",
		"wikitext": "[[Main Page|The Main<!--front--> Page]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "The Main",
				"name": "link-ground link-text"
			},
			{
				"text": "<!--front-->",
				"name": "link-ground comment"
			},
			{
				"text": " Page",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Piped link with multiple pipe characters in link text",
		"wikitext": "[[Main Page||The|Main|Page|]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "|The|Main|Page|",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Piped link with empty link text",
		"wikitext": "[[Main Page|<nowiki/>]] - empty nowiki\n[[Main Page|&nbsp;]] - empty non breaking space",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "<",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "link-ground exttag-name"
			},
			{
				"text": "/>",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " - empty nowiki",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "&nbsp;",
				"name": "link-ground entity"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " - empty non breaking space",
				"name": ""
			}
		]
	},
	{
		"desc": "Piped link with empty link text - 2",
		"wikitext": "[[Main Page| ]] - empty space",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "| ",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " - empty space",
				"name": ""
			}
		]
	},
	{
		"desc": "Broken link",
		"wikitext": "[[Zigzagzogzagzig]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Zigzagzogzagzig",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Broken link with fragment",
		"wikitext": "[[Zigzagzogzagzig#zug]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Zigzagzogzagzig",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "#zug",
				"name": "link-ground link-tosection"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Special page link with fragment",
		"wikitext": "[[Special:Version#anchor]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Special:Version",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "#anchor",
				"name": "link-ground link-tosection"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Nonexistent special page link with fragment",
		"wikitext": "[[Special:ThisNameWillHopefullyNeverBeUsed#anchor]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Special:ThisNameWillHopefullyNeverBeUsed",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "#anchor",
				"name": "link-ground link-tosection"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Link with prefix",
		"wikitext": "xxx[[main Page]], xxx[[Main Page]], Xxx[[main Page]] XXX[[main Page]], XXX[[Main Page]]",
		"tokens": [
			{
				"text": "xxx",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": ", xxx",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": ", Xxx",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " XXX",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": ", XXX",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Link with suffix",
		"wikitext": "[[Main Page]]xxx, [[Main Page]]XXX, [[Main Page]]!!!",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "xxx, ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "XXX, ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "!!!",
				"name": ""
			}
		]
	},
	{
		"desc": "T45661: Piped links with identical prefixes",
		"wikitext": "[[prefixed article|prefixed articles with spaces]]\n\n[[prefixed article|prefixed articlesaoeu]]\n\n[[Main Page|Main Page test]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "prefixed article",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "prefixed articles with spaces",
				"name": "link-ground link-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "prefixed article",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "prefixed articlesaoeu",
				"name": "link-ground link-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Main Page test",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Link with HTML entity in suffix / tail",
		"wikitext": "[[Main Page]]&quot;, [[Main Page]]&#97;",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "&quot;",
				"name": "entity"
			},
			{
				"text": ", ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "&#97;",
				"name": "entity"
			}
		]
	},
	{
		"desc": "Link with 3 brackets",
		"wikitext": "[[[Main Page]]]\nFoo [[[Main Page]]]",
		"tokens": [
			{
				"text": "[[[Main Page]]]Foo [[[Main Page]]]",
				"name": ""
			}
		]
	},
	{
		"desc": "Link with 4 brackets",
		"wikitext": "[[[[Main Page]]]]",
		"tokens": [
			{
				"text": "[[",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "]]",
				"name": ""
			}
		]
	},
	{
		"desc": "Piped link with 3 brackets",
		"wikitext": "[[[main page|the main page]]]",
		"tokens": [
			{
				"text": "[[[main page|the main page]]]",
				"name": ""
			}
		]
	},
	{
		"desc": "Piped link with extlink-like text",
		"wikitext": "[[Main Page|[bar]]]\n[[Main Page|This is a [bar]]]\n[[Main Page|[bar]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "[bar]",
				"name": "link-ground link-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "This is a [bar]",
				"name": "link-ground link-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "[bar",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Link with multiple pipes",
		"wikitext": "[[Main Page|The|Main|Page]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "The|Main|Page",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Anchor containing a #. (T65430)",
		"wikitext": "[[Main Page#And#Link]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "#And#Link",
				"name": "link-ground link-tosection"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Link to namespaces",
		"wikitext": "[[Talk:Parser testing]], [[Meta:Disclaimers]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Talk:Parser testing",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": ", ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Meta:Disclaimers",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Link with space in namespace",
		"wikitext": "[[User talk:Foo bar]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "User talk:Foo bar",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Namespace takes precedence over interwiki link (T53680)",
		"wikitext": "[[MemoryAlpha:AlphaTest]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "MemoryAlpha:AlphaTest",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Piped link to namespace",
		"wikitext": "[[Meta:Disclaimers|The disclaimers]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Meta:Disclaimers",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "The disclaimers",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Link containing }",
		"wikitext": "[[Usually caused by a typo (oops}]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Usually caused by a typo (oops",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "}",
				"name": "link-ground error"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Link containing % (not as a hex sequence)",
		"wikitext": "[[7% Solution]]\n[[7% Solution|7%25 Solution]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "7% Solution",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "7% Solution",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "7%25 Solution",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Link containing % as a double hex sequence interpreted to hex sequence",
		"wikitext": "[[7%2525 Solution]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "7%2525 Solution",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Link containing \"#<\" and \"#>\" % as a hex sequences- these are valid section anchors",
		"wikitext": "[[%23%3c]][[%23%3e]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "%23%3c",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "%23%3e",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Link containing \"#<\" and \"#>\" % as a hex sequences- these are valid section anchors (legacy)",
		"wikitext": "[[%23%3c]][[%23%3e]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "%23%3c",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "%23%3e",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Link containing \"<#\" and \">#\" as a hex sequences",
		"wikitext": "[[%3c%23]][[%3e%23]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "%3c%23",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "%3e%23",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Link containing an equals sign",
		"wikitext": "[[Special:BookSources/isbn=4-00-026157-6]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Special:BookSources/isbn=4-00-026157-6",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Link containing an ampersand",
		"wikitext": "[[Foo & bar]]\n\n[[Foo &amp; bar]]\n\n[[Foo &amp;amp; bar]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Foo & bar",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Foo &amp; bar",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Foo &amp;amp; bar",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Link containing a tilde",
		"wikitext": "[[Foo~bar]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Foo~bar",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Link containing double-single-quotes '' (T6598)",
		"wikitext": "[[Lista d''e paise d''o munno]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Lista d''e paise d''o munno",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Link containing double quotes and spaces",
		"wikitext": "[[Cool \"Gator\"]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Cool \"Gator\"",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Link containing double-single-quotes '' in text (T6598 check)",
		"wikitext": "Some [[Link|pretty ''italics'' and stuff]]!",
		"tokens": [
			{
				"text": "Some ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Link",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "pretty ",
				"name": "link-ground link-text"
			},
			{
				"text": "''",
				"name": "link-ground apostrophes"
			},
			{
				"text": "italics",
				"name": "link-ground link-text em"
			},
			{
				"text": "''",
				"name": "link-ground apostrophes"
			},
			{
				"text": " and stuff",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "!",
				"name": ""
			}
		]
	},
	{
		"desc": "Link containing double-single-quotes '' in text embedded in italics (T6598 check)",
		"wikitext": "''Some [[Link|pretty ''italics'' and stuff]]!''",
		"tokens": [
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "Some ",
				"name": "em"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Link",
				"name": "link-ground link-pagename pagename em"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "pretty ",
				"name": "link-ground link-text em"
			},
			{
				"text": "''",
				"name": "link-ground apostrophes"
			},
			{
				"text": "italics",
				"name": "link-ground link-text em em"
			},
			{
				"text": "''",
				"name": "link-ground apostrophes"
			},
			{
				"text": " and stuff",
				"name": "link-ground link-text em"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "!",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Link with double quotes in title part (literal) and alternate part (interpreted)",
		"wikitext": "[[File:Denys_Savchenko_''Pentecoste''.jpg]]\n\n[[''Pentecoste'']]\n\n[[''Pentecoste''|Pentecoste]]\n\n[[''Pentecoste''|''Pentecoste'']]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Denys_Savchenko_''Pentecoste''.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "''Pentecoste''",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "''Pentecoste''",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Pentecoste",
				"name": "link-ground link-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "''Pentecoste''",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "''",
				"name": "link-ground apostrophes"
			},
			{
				"text": "Pentecoste",
				"name": "link-ground link-text em"
			},
			{
				"text": "''",
				"name": "link-ground apostrophes"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Plain link to URL",
		"wikitext": "[[http://www.example.com]]",
		"tokens": [
			{
				"text": "[",
				"name": ""
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "www.example.com",
				"name": "link-ground extlink"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "]",
				"name": ""
			}
		]
	},
	{
		"desc": "Plain link to URL with link text",
		"wikitext": "[[http://www.example.com Link text]]",
		"tokens": [
			{
				"text": "[",
				"name": ""
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "www.example.com",
				"name": "link-ground extlink"
			},
			{
				"text": " Link text",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "]",
				"name": ""
			}
		]
	},
	{
		"desc": "Plain link to URL containing special characters, with link text (see T213950).",
		"wikitext": "[[http://www.example.com/?q=%7Babc%7D Link text]]",
		"tokens": [
			{
				"text": "[",
				"name": ""
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "www.example.com/?q=%7Babc%7D",
				"name": "link-ground extlink"
			},
			{
				"text": " Link text",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "]",
				"name": ""
			}
		]
	},
	{
		"desc": "Plain link to protocol-relative URL",
		"wikitext": "[[//www.example.com]]",
		"tokens": [
			{
				"text": "[",
				"name": ""
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "//",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "www.example.com",
				"name": "link-ground extlink"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "]",
				"name": ""
			}
		]
	},
	{
		"desc": "Plain link to protocol-relative URL with link text",
		"wikitext": "[[//www.example.com Link text]]",
		"tokens": [
			{
				"text": "[",
				"name": ""
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "//",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "www.example.com",
				"name": "link-ground extlink"
			},
			{
				"text": " Link text",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "]",
				"name": ""
			}
		]
	},
	{
		"desc": "Plain link to page with question mark in title",
		"wikitext": "[[A?b]]\n\n[[A?b|Baz]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "A?b",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "A?b",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Baz",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Piped link to URL",
		"wikitext": "Piped link to URL: [[http://www.example.com|an example URL]]",
		"tokens": [
			{
				"text": "Piped link to URL: [",
				"name": ""
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "www.example.com|an",
				"name": "link-ground extlink"
			},
			{
				"text": " example URL",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "]",
				"name": ""
			}
		]
	},
	{
		"desc": "Nested wikilink syntax in wikilink syntax that parses as wikilink in extlink",
		"wikitext": "[[http://example.com|[[Example]]]]",
		"tokens": [
			{
				"text": "[",
				"name": ""
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "example.com|",
				"name": "link-ground extlink"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Example",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "]",
				"name": ""
			}
		]
	},
	{
		"desc": "Plain link in template argument",
		"wikitext": "{{1x|[http://www.example.com |123]}}\n\n{{1x|[[http://www.example.com |123]]}}\n\n{{1x|[[http://www.example.com |123]}}\n\n{{1x|[http://www.example.com |123]]}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "[",
				"name": "template-link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "template-link-ground extlink-protocol"
			},
			{
				"text": "www.example.com",
				"name": "template-link-ground extlink"
			},
			{
				"text": " |123",
				"name": "template-link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "template-link-ground extlink-bracket"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "[",
				"name": "template-ground template"
			},
			{
				"text": "[",
				"name": "template-link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "template-link-ground extlink-protocol"
			},
			{
				"text": "www.example.com",
				"name": "template-link-ground extlink"
			},
			{
				"text": " |123",
				"name": "template-link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "template-link-ground extlink-bracket"
			},
			{
				"text": "]",
				"name": "template-ground template"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "[",
				"name": "template-ground template"
			},
			{
				"text": "[",
				"name": "template-link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "template-link-ground extlink-protocol"
			},
			{
				"text": "www.example.com",
				"name": "template-link-ground extlink"
			},
			{
				"text": " |123",
				"name": "template-link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "template-link-ground extlink-bracket"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "[",
				"name": "template-link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "template-link-ground extlink-protocol"
			},
			{
				"text": "www.example.com",
				"name": "template-link-ground extlink"
			},
			{
				"text": " |123",
				"name": "template-link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "template-link-ground extlink-bracket"
			},
			{
				"text": "]",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "T2002: [[page|http://url/]] should link to page, not http://url/",
		"wikitext": "[[Main Page|http://url/]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "http://url/",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "T2337: Escaped self-links should be bold",
		"wikitext": "[[Bu&#103;462]] [[Bug462]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Bu&",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "#103;462",
				"name": "link-ground link-tosection"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Bug462",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Self-link to section should not be bold",
		"wikitext": "[[Main Page#section]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "#section",
				"name": "link-ground link-tosection"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Self-link hash fragment should be escaped",
		"wikitext": "[[Main Page#section with spaces]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "#section with spaces",
				"name": "link-ground link-tosection"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Self-link to numeric title",
		"wikitext": "[[0]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "0",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Link to numeric-equivalent title",
		"wikitext": "[[00]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "00",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "<nowiki> inside a link",
		"wikitext": "[[Main<nowiki> Page</nowiki>]] [[Main Page|the main page <nowiki>[it's not very good]</nowiki>]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "<",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "link-ground exttag-name"
			},
			{
				"text": ">",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": " Page",
				"name": "tag-nowiki"
			},
			{
				"text": "</",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "link-ground exttag-name"
			},
			{
				"text": ">",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": "]] ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "the main page ",
				"name": "link-ground link-text"
			},
			{
				"text": "<",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "link-ground exttag-name"
			},
			{
				"text": ">",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": "[it's not very good]",
				"name": "tag-nowiki"
			},
			{
				"text": "</",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "link-ground exttag-name"
			},
			{
				"text": ">",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "<pre> inside a link",
		"wikitext": "[[Main<pre> Page</pre>]] [[Main Page|the main page <pre>[it's not very good]</pre>]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "<",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": "pre",
				"name": "link-ground exttag-name"
			},
			{
				"text": ">",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": " Page",
				"name": "tag-pre"
			},
			{
				"text": "</",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": "pre",
				"name": "link-ground exttag-name"
			},
			{
				"text": ">",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": "]] ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "the main page ",
				"name": "link-ground link-text"
			},
			{
				"text": "<",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": "pre",
				"name": "link-ground exttag-name"
			},
			{
				"text": ">",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": "[it's not very good]",
				"name": "tag-pre"
			},
			{
				"text": "</",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": "pre",
				"name": "link-ground exttag-name"
			},
			{
				"text": ">",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Non-breaking spaces in title",
		"wikitext": "[[&nbsp; Main &nbsp; Page &nbsp;]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "&nbsp; Main &nbsp; Page &nbsp;",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Multiple spaces in titles should normalize to a single underscore",
		"wikitext": "[[Foo bar baz|x]]\n[[Foo  bar baz|x]]\n[[Foo  bar   baz|x]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Foo bar baz",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "x",
				"name": "link-ground link-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Foo  bar baz",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "x",
				"name": "link-ground link-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Foo  bar   baz",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "x",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Link with multiple \":\" in a subpage-supporting namespace (T65636)",
		"wikitext": "[[User:Foo/Test/63636:Bar|Test]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "User:Foo/Test/63636:Bar",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Test",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Handle title parsing for subpages",
		"wikitext": "123",
		"tokens": [
			{
				"text": "123",
				"name": ""
			}
		]
	},
	{
		"desc": "Link to a subpage from a namespace other than main",
		"wikitext": "[[/123]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "/123",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Ensure that transclusion titles are not url-decoded",
		"wikitext": "{{Bar%C3%A9}} {{/Bar%C3%A9}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "Bar%C3%A9",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "/Bar%C3%A9",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Purely hash wikilink",
		"wikitext": "[[#a|b]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "#a",
				"name": "link-ground link-tosection"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "b",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "1. Interaction of linktrail and template encapsulation",
		"wikitext": "{{1x|[[Foo]]}}l\n\n{{1x|[[Foo]]l}}\n\n{{1x|[[Foo]]l}}s\n\n{{1x|[[Foo]]<span>ls</span>}}\n\n[[{{1x|Foo}}]]l",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "[[",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "Foo",
				"name": "template-link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "l",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "[[",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "Foo",
				"name": "template-link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "l",
				"name": "template-ground template"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "[[",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "Foo",
				"name": "template-link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "l",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "s",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "[[",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "Foo",
				"name": "template-link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "<",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "span",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "ls",
				"name": "template-ground template"
			},
			{
				"text": "</",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "span",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground template-delimiter"
			},
			{
				"text": "Foo",
				"name": "template-link-ground template"
			},
			{
				"text": "}}",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "l",
				"name": ""
			}
		]
	},
	{
		"desc": "2. Interaction of linktrail and template encapsulation",
		"wikitext": "{{1x|Some [[Fool]]}}s",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "Some ",
				"name": "template-ground template"
			},
			{
				"text": "[[",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "Fool",
				"name": "template-link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "s",
				"name": ""
			}
		]
	},
	{
		"desc": "3. Interaction of linktrail and template encapsulation",
		"wikitext": "{{1x|Some [[Fool]]s are '''bold and foolish'''}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "Some ",
				"name": "template-ground template"
			},
			{
				"text": "[[",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "Fool",
				"name": "template-link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "s are ",
				"name": "template-ground template"
			},
			{
				"text": "'''",
				"name": "template-ground apostrophes"
			},
			{
				"text": "bold and foolish",
				"name": "template-ground template"
			},
			{
				"text": "'''",
				"name": "template-ground apostrophes"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Parsoid-centric test: Whitespace in ext- and wiki-links should be preserved",
		"wikitext": "[[Foo|  bar]]\n\n[[Foo|  ''bar'']]\n\n[http://wp.org   foo]\n\n[http://wp.org   ''foo'']",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Foo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|  ",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "bar",
				"name": "link-ground link-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Foo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|  ",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "''",
				"name": "link-ground apostrophes"
			},
			{
				"text": "bar",
				"name": "link-ground link-text em"
			},
			{
				"text": "''",
				"name": "link-ground apostrophes"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "wp.org",
				"name": "link-ground extlink"
			},
			{
				"text": "   foo",
				"name": "link-ground extlink-text"
			},
			{
				"text": "][",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "wp.org",
				"name": "link-ground extlink"
			},
			{
				"text": "   ",
				"name": "link-ground extlink-text"
			},
			{
				"text": "''",
				"name": "link-ground apostrophes"
			},
			{
				"text": "foo",
				"name": "link-ground extlink-text em"
			},
			{
				"text": "''",
				"name": "link-ground apostrophes"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "Link with angle bracket after anchor",
		"wikitext": "[[Foo#<bar>]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Foo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "#<bar>",
				"name": "link-ground link-tosection"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Link with angle bracket after anchor (legacy)",
		"wikitext": "[[Foo#<bar>]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Foo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "#<bar>",
				"name": "link-ground link-tosection"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Wikilink in wikilink",
		"wikitext": "[[Hi|[[Ho]]]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Hi",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Ho",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "]]",
				"name": ""
			}
		]
	},
	{
		"desc": "Parsoid: handle constructor well",
		"wikitext": "[[constructor]]\n\n[[constructor:foo]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "constructor",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "constructor:foo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "<br> to <br />",
		"wikitext": "1<br>2<br />3",
		"tokens": [
			{
				"text": "1",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "br",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "2",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "br ",
				"name": "htmltag-name"
			},
			{
				"text": "/>",
				"name": "htmltag-bracket"
			},
			{
				"text": "3",
				"name": ""
			}
		]
	},
	{
		"desc": "Broken br tag sanitization",
		"wikitext": "</br>",
		"tokens": [
			{
				"text": "</br>",
				"name": "error"
			}
		]
	},
	{
		"desc": "Parsoid: Broken br tag recognition",
		"wikitext": "</br>\n\n<br/ >",
		"tokens": [
			{
				"text": "</br>",
				"name": "error"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "br",
				"name": "htmltag-name"
			},
			{
				"text": "/ ",
				"name": "htmltag-attribute html-br"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Incorrecly removing closing slashes from correctly formed XHTML",
		"wikitext": "<br style=\"clear:both;\" />",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "br ",
				"name": "htmltag-name"
			},
			{
				"text": "style=\"clear:both;\" ",
				"name": "htmltag-attribute html-br"
			},
			{
				"text": "/>",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Failing to transform badly formed HTML into correct XHTML",
		"wikitext": "<br style=\"clear: left;\">\n<br style=\"clear: right;\">\n<br style=\"clear: both;\">",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "br ",
				"name": "htmltag-name"
			},
			{
				"text": "style=\"clear: left;\"",
				"name": "htmltag-attribute html-br"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "br ",
				"name": "htmltag-name"
			},
			{
				"text": "style=\"clear: right;\"",
				"name": "htmltag-attribute html-br"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "br ",
				"name": "htmltag-name"
			},
			{
				"text": "style=\"clear: both;\"",
				"name": "htmltag-attribute html-br"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Handling html with a div self-closing tag",
		"wikitext": "<div title />\n<div title/>\n<div title/ >\n<div title=bar />\n<div title=bar/>\n<div title=bar/ >",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "title ",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": "/><",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "title",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": "/><",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "title/ ",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "title=bar ",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": "/><",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "title=bar",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": "/><",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "title=bar/ ",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Elements with solidus in various attribute positions",
		"wikitext": "<div cla/ss=\"123\">ha</div>\n\n<div / class=\"123\">ha</div>\n\n<div class= / \"123\">ha</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "cla/ss=\"123\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "ha",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "/ class=\"123\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "ha",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "class= / \"123\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "ha",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Handling html with a br self-closing tag",
		"wikitext": "<br title />\n<br title/>\n<br title/ >\n<br title=bar />\n<br title=bar/>\n<br title=bar/ >",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "br ",
				"name": "htmltag-name"
			},
			{
				"text": "title ",
				"name": "htmltag-attribute html-br"
			},
			{
				"text": "/><",
				"name": "htmltag-bracket"
			},
			{
				"text": "br ",
				"name": "htmltag-name"
			},
			{
				"text": "title",
				"name": "htmltag-attribute html-br"
			},
			{
				"text": "/><",
				"name": "htmltag-bracket"
			},
			{
				"text": "br ",
				"name": "htmltag-name"
			},
			{
				"text": "title/ ",
				"name": "htmltag-attribute html-br"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "br ",
				"name": "htmltag-name"
			},
			{
				"text": "title=bar ",
				"name": "htmltag-attribute html-br"
			},
			{
				"text": "/><",
				"name": "htmltag-bracket"
			},
			{
				"text": "br ",
				"name": "htmltag-name"
			},
			{
				"text": "title=bar",
				"name": "htmltag-attribute html-br"
			},
			{
				"text": "/><",
				"name": "htmltag-bracket"
			},
			{
				"text": "br ",
				"name": "htmltag-name"
			},
			{
				"text": "title=bar/ ",
				"name": "htmltag-attribute html-br"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Quoted attributes without spaces",
		"wikitext": "<div class=\"foo\"style=\"color:red\">red</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "class=\"foo\"style=\"color:red\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "red",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Horizontal ruler (should it add that extra space?)",
		"wikitext": "<hr>\n<hr >\nfoo <hr\n> bar",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "hr",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "hr ",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "foo ",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "hr",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " bar",
				"name": ""
			}
		]
	},
	{
		"desc": "Horizontal ruler -- 4+ dashes render hr",
		"wikitext": "----",
		"tokens": [
			{
				"text": "----",
				"name": "hr"
			}
		]
	},
	{
		"desc": "Horizontal ruler -- eats additional dashes on the same line",
		"wikitext": "---------",
		"tokens": [
			{
				"text": "---------",
				"name": "hr"
			}
		]
	},
	{
		"desc": "Horizontal ruler -- does not collapse dashes on consecutive lines",
		"wikitext": "----\n----",
		"tokens": [
			{
				"text": "--------",
				"name": "hr"
			}
		]
	},
	{
		"desc": "Horizontal ruler -- <4 dashes render as plain text",
		"wikitext": "---",
		"tokens": [
			{
				"text": "---",
				"name": ""
			}
		]
	},
	{
		"desc": "Horizontal ruler -- Supports content following dashes on same line",
		"wikitext": "---- Foo",
		"tokens": [
			{
				"text": "----",
				"name": "hr"
			},
			{
				"text": " Foo",
				"name": ""
			}
		]
	},
	{
		"desc": "Common list",
		"wikitext": "*Common list\n*item 2\n*item 3",
		"tokens": [
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "Common list",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "item 2",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "item 3",
				"name": ""
			}
		]
	},
	{
		"desc": "Numbered list",
		"wikitext": "#Numbered list\n#item 2\n#item 3",
		"tokens": [
			{
				"text": "#",
				"name": "list"
			},
			{
				"text": "Numbered list",
				"name": ""
			},
			{
				"text": "#",
				"name": "list"
			},
			{
				"text": "item 2",
				"name": ""
			},
			{
				"text": "#",
				"name": "list"
			},
			{
				"text": "item 3",
				"name": ""
			}
		]
	},
	{
		"desc": "Mixed list",
		"wikitext": "*Mixed list\n*#with numbers\n**and bullets\n*#and numbers\n*bullets again\n**bullet level 2\n***bullet level 3\n***#Number on level 4\n**bullet level 2\n**#Number on level 3\n**#Number on level 3\n*#number level 2\n*Level 1\n***Level 3\n#**Level 3, but ordered",
		"tokens": [
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "Mixed list",
				"name": ""
			},
			{
				"text": "*#",
				"name": "list"
			},
			{
				"text": "with numbers",
				"name": ""
			},
			{
				"text": "**",
				"name": "list"
			},
			{
				"text": "and bullets",
				"name": ""
			},
			{
				"text": "*#",
				"name": "list"
			},
			{
				"text": "and numbers",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "bullets again",
				"name": ""
			},
			{
				"text": "**",
				"name": "list"
			},
			{
				"text": "bullet level 2",
				"name": ""
			},
			{
				"text": "***",
				"name": "list"
			},
			{
				"text": "bullet level 3",
				"name": ""
			},
			{
				"text": "***#",
				"name": "list"
			},
			{
				"text": "Number on level 4",
				"name": ""
			},
			{
				"text": "**",
				"name": "list"
			},
			{
				"text": "bullet level 2",
				"name": ""
			},
			{
				"text": "**#",
				"name": "list"
			},
			{
				"text": "Number on level 3",
				"name": ""
			},
			{
				"text": "**#",
				"name": "list"
			},
			{
				"text": "Number on level 3",
				"name": ""
			},
			{
				"text": "*#",
				"name": "list"
			},
			{
				"text": "number level 2",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "Level 1",
				"name": ""
			},
			{
				"text": "***",
				"name": "list"
			},
			{
				"text": "Level 3",
				"name": ""
			},
			{
				"text": "#**",
				"name": "list"
			},
			{
				"text": "Level 3, but ordered",
				"name": ""
			}
		]
	},
	{
		"desc": "1. Nested mixed wikitext and html list",
		"wikitext": "*hi\n*<ul><li>ho</li></ul>\n*hi\n**ho",
		"tokens": [
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "hi",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "ul",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "ho",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "ul",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "hi",
				"name": ""
			},
			{
				"text": "**",
				"name": "list"
			},
			{
				"text": "ho",
				"name": ""
			}
		]
	},
	{
		"desc": "2. Nested mixed wikitext and html list (incompatible)",
		"wikitext": ";hi\n:{{1x|<li>ho</li>}}",
		"tokens": [
			{
				"text": ";",
				"name": "list"
			},
			{
				"text": "hi",
				"name": "strong"
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "<",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "li",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "ho",
				"name": "template-ground template"
			},
			{
				"text": "</",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "li",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Nested lists 1",
		"wikitext": "*foo\n**bar",
		"tokens": [
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "**",
				"name": "list"
			},
			{
				"text": "bar",
				"name": ""
			}
		]
	},
	{
		"desc": "Nested lists 2",
		"wikitext": "**foo\n*bar",
		"tokens": [
			{
				"text": "**",
				"name": "list"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "bar",
				"name": ""
			}
		]
	},
	{
		"desc": "Nested lists 3 (first element empty)",
		"wikitext": "*\n**bar",
		"tokens": [
			{
				"text": "***",
				"name": "list"
			},
			{
				"text": "bar",
				"name": ""
			}
		]
	},
	{
		"desc": "Nested lists 4 (first element empty)",
		"wikitext": "**\n*bar",
		"tokens": [
			{
				"text": "***",
				"name": "list"
			},
			{
				"text": "bar",
				"name": ""
			}
		]
	},
	{
		"desc": "Nested lists 5 (both elements empty)",
		"wikitext": "**\n*",
		"tokens": [
			{
				"text": "***",
				"name": "list"
			}
		]
	},
	{
		"desc": "Nested lists 6 (both elements empty)",
		"wikitext": "*\n**",
		"tokens": [
			{
				"text": "***",
				"name": "list"
			}
		]
	},
	{
		"desc": "Nested lists 7 (skip initial nesting levels)",
		"wikitext": "***foo",
		"tokens": [
			{
				"text": "***",
				"name": "list"
			},
			{
				"text": "foo",
				"name": ""
			}
		]
	},
	{
		"desc": "Nested lists 8 (multiple nesting transitions)",
		"wikitext": "*foo\n***bar\n**baz\n*boo",
		"tokens": [
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "***",
				"name": "list"
			},
			{
				"text": "bar",
				"name": ""
			},
			{
				"text": "**",
				"name": "list"
			},
			{
				"text": "baz",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "boo",
				"name": ""
			}
		]
	},
	{
		"desc": "1. Lists and block-element interaction",
		"wikitext": "*<div>a\n*b\n</div>‡≤ï",
		"tokens": [
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "b",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "‡≤ï",
				"name": ""
			}
		]
	},
	{
		"desc": "2. Lists and block-element interaction",
		"wikitext": "*{{1x|<div>a\n*b\n}}</div>‡≤ï",
		"tokens": [
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "<",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "div",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "a",
				"name": "template-ground template"
			},
			{
				"text": "*",
				"name": "template-ground list"
			},
			{
				"text": "b",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "‡≤ï",
				"name": ""
			}
		]
	},
	{
		"desc": "1. Lists with start-of-line-transparent tokens before bullets: Comments",
		"wikitext": "*foo\n*<!--cmt-->bar\n<!--cmt-->*baz",
		"tokens": [
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "<!--cmt-->",
				"name": "comment"
			},
			{
				"text": "bar",
				"name": ""
			},
			{
				"text": "<!--cmt-->",
				"name": "comment"
			},
			{
				"text": "*baz",
				"name": ""
			}
		]
	},
	{
		"desc": "2. Lists with start-of-line-transparent tokens before bullets: Template close",
		"wikitext": "*foo {{1x|bar\n}}*baz",
		"tokens": [
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "foo ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "bar",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "*baz",
				"name": ""
			}
		]
	},
	{
		"desc": "List items are not parsed correctly following a <pre> block (T2785)",
		"wikitext": "*<pre>foo</pre>\n*<pre>bar</pre>\n*zar",
		"tokens": [
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "foo",
				"name": "tag-pre"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "bar",
				"name": "tag-pre"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "zar",
				"name": ""
			}
		]
	},
	{
		"desc": "List items from template",
		"wikitext": "{{inner list}}\n*item 2\n\n*item 0\n{{inner list}}\n*item 2\n\n*item 0\n*notSOL{{inner list}}\n*item 2",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "inner list",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "item 2",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "item 0",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "inner list",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "item 2",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "item 0",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "notSOL",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "inner list",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "item 2",
				"name": ""
			}
		]
	},
	{
		"desc": "List interrupted by empty line or heading",
		"wikitext": "*foo\n\n**bar\n==A heading==\n*Another list item",
		"tokens": [
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "**",
				"name": "list"
			},
			{
				"text": "bar",
				"name": ""
			},
			{
				"text": "==",
				"name": "section-header section--2"
			},
			{
				"text": "A heading",
				"name": "section"
			},
			{
				"text": "==",
				"name": "section-header"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "Another list item",
				"name": ""
			}
		]
	},
	{
		"desc": "Multiple list tags generated by templates",
		"wikitext": "{{1x|<li>}}a\n{{1x|<li>}}b\n{{1x|<li>}}c",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "<",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "li",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "<",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "li",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "b",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "<",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "li",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "c",
				"name": ""
			}
		]
	},
	{
		"desc": "Multiple newlines in between HTML list items don't induce paragraph wrapping",
		"wikitext": "<ul>\n<li>hi</li>\n\n\n\n\n<li>ho</li>\n</ul>\n\n<dl>\n<dt>hi</dt>\n<dd>ho<div>123</div>\n</dd>\n\n\n</dl>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "ul",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "hi",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "ho",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "ul",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "dl",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "dt",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "hi",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "dt",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "dd",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "ho",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "123",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "dd",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "dl",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Single-comment whitespace lines dont break lists, and neither do multi-comment whitespace lines",
		"wikitext": "*a\n<!--This line will NOT split the list-->\n*b\n <!--This line will NOT split the list either-->\n*c\n <!--foo--> <!----> <!--This line NOT split the list either--> \n*d",
		"tokens": [
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": "<!--This line will NOT split the list-->",
				"name": "comment"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "b",
				"name": ""
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "<!--This line will NOT split the list either-->",
				"name": "comment"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "c",
				"name": ""
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "<!--foo-->",
				"name": "comment"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "<!---->",
				"name": "comment"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "<!--This line NOT split the list either-->",
				"name": "comment"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "d",
				"name": ""
			}
		]
	},
	{
		"desc": "Replacing whitespace with tabs still doesn't break the list (gerrit 78327)",
		"wikitext": "*a\n<!--This line will NOT split the list-->\t\n*b\n\t<!--This line will NOT split the list either--> \t\n*c\n\t<!--foo--> <!---->\t<!--This line NOT split the list\n        either-->\t \n*d",
		"tokens": [
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": "<!--This line will NOT split the list-->",
				"name": "comment"
			},
			{
				"text": "\t",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "b\t",
				"name": ""
			},
			{
				"text": "<!--This line will NOT split the list either-->",
				"name": "comment"
			},
			{
				"text": " \t",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "c\t",
				"name": ""
			},
			{
				"text": "<!--foo-->",
				"name": "comment"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "<!---->",
				"name": "comment"
			},
			{
				"text": "\t",
				"name": ""
			},
			{
				"text": "<!--This line NOT split the list        either-->",
				"name": "comment"
			},
			{
				"text": "\t ",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "d",
				"name": ""
			}
		]
	},
	{
		"desc": "Test the li-hack (a hack from Tidy days, but doesn't work as advertised with Remex)",
		"wikitext": "*foo\n*<li>li-hack\n**bar1\n*{{1x|<li>templated li-hack}}\n**bar2\n*<!--foo--><li> unsupported li-hack with preceding comments\n\n<ul>\n<li><li>not a li-hack\n</li>\n</ul>",
		"tokens": [
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "li-hack",
				"name": ""
			},
			{
				"text": "**",
				"name": "list"
			},
			{
				"text": "bar1",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "<",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "li",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "templated li-hack",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "**",
				"name": "list"
			},
			{
				"text": "bar2",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "<!--foo-->",
				"name": "comment"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " unsupported li-hack with preceding comments",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "ul",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "not a li-hack",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "</ul>",
				"name": "error"
			}
		]
	},
	{
		"desc": "Parsoid: Make sure nested lists are serialized on their own line even if HTML contains no newlines",
		"wikitext": "#foo\n##bar\n\n*foo\n**bar\n\n:foo\n::bar",
		"tokens": [
			{
				"text": "#",
				"name": "list"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "##",
				"name": "list"
			},
			{
				"text": "bar",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "**",
				"name": "list"
			},
			{
				"text": "bar",
				"name": ""
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "::",
				"name": "list"
			},
			{
				"text": "bar",
				"name": ""
			}
		]
	},
	{
		"desc": "Parsoid: Test of whitespace serialization with Templated bullets",
		"wikitext": "* {{bullet}}",
		"tokens": [
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "bullet",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Unbalanced closing block tags break a list",
		"wikitext": "<div>\n*a</div><div>\n*b</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "b",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Unbalanced closing wikitext block tags break a list",
		"wikitext": "<p>\n*a</p><p>\n*b</p>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "p",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "p",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "p",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "b",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "p",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Unbalanced closing non-block tags don't break a list",
		"wikitext": "<span>\n*a</span><span>\n*b</span>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "span",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "span",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "span",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "b",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "span",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Unclosed formatting tags that straddle lists are closed and reopened",
		"wikitext": "#<s> a\n#b </s>",
		"tokens": [
			{
				"text": "#",
				"name": "list"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "s",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " a",
				"name": ""
			},
			{
				"text": "#",
				"name": "list"
			},
			{
				"text": "b ",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "s",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "1. List embedded in a formatting tag",
		"wikitext": "<small>\n*foo\n</small>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "small",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "small",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "2. List embedded in a formatting tag in a misnested way",
		"wikitext": "<small>\n*a\n*b</small>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "small",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "b",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "small",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "3. List embedded in a formatting tag in a misnested way",
		"wikitext": "<small>\n\n** 123</small>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "small",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "**",
				"name": "list"
			},
			{
				"text": " 123",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "small",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Parsoid: unknown parser function (T314524)",
		"wikitext": "{{#tag:b|This is a known parser function}}\n\nNow show the unknown parser functions for comparison.\n\n{{#foo}}\n\n{{#foo:bar|bat}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "#tag",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "b",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "This is a known parser function",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "Now show the unknown parser functions for comparison.",
				"name": ""
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "#foo",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "#foo",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "bar",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "bat",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Namespace 1 {{ns:1}}",
		"wikitext": "{{ns:1}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "ns",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "1",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Namespace 1 {{ns:01}}",
		"wikitext": "{{ns:01}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "ns",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "01",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Namespace 0 {{ns:0}} (T6783)",
		"wikitext": "{{ns:0}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "ns",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "0",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Namespace 0 {{ns:00}} (T6783)",
		"wikitext": "{{ns:00}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "ns",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "00",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Namespace -1 {{ns:-1}}",
		"wikitext": "{{ns:-1}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "ns",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "-1",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Namespace User {{ns:User}}",
		"wikitext": "{{ns:User}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "ns",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "User",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Namespace User talk {{ns:User_talk}}",
		"wikitext": "{{ns:User_talk}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "ns",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "User_talk",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Namespace User talk {{ns:uSeR tAlK}}",
		"wikitext": "{{ns:uSeR tAlK}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "ns",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "uSeR tAlK",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Namespace File {{ns:File}}",
		"wikitext": "{{ns:File}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "ns",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "File",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Namespace File {{ns:Image}}",
		"wikitext": "{{ns:Image}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "ns",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "Image",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Urlencode",
		"wikitext": "{{urlencode:hi world?!}}\n{{urlencode:hi world?!|WIKI}}\n{{urlencode:hi world?!|PATH}}\n{{urlencode:hi world?!|QUERY}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "urlencode",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "hi world?!",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "urlencode",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "hi world?!",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "WIKI",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "urlencode",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "hi world?!",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "PATH",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "urlencode",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "hi world?!",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "QUERY",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "__proto__ is treated as normal wikitext (T105997)",
		"wikitext": "__proto__",
		"tokens": [
			{
				"text": "__proto__",
				"name": "double-underscore"
			}
		]
	},
	{
		"desc": "Template titles with entities in them",
		"wikitext": "*{{Foo‚Äìbar}}\n*{{Foo&ndash;bar}}",
		"tokens": [
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "Foo‚Äìbar",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "Foo&ndash;bar",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Nonexistent template",
		"wikitext": "{{thistemplatedoesnotexist}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "thistemplatedoesnotexist",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Template with invalid target containing tags",
		"wikitext": "{{a<b>b</b>|{{1x|foo}}|{{1x|a}}={{1x|b}}|a = b}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "a",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "<",
				"name": "template-ground error"
			},
			{
				"text": "b",
				"name": "template-ground template-name pagename"
			},
			{
				"text": ">",
				"name": "template-ground error"
			},
			{
				"text": "b",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "<",
				"name": "template-ground error"
			},
			{
				"text": "/b",
				"name": "template-ground template-name pagename"
			},
			{
				"text": ">",
				"name": "template-ground error"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "{{",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template2-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template2-ground template-delimiter"
			},
			{
				"text": "foo",
				"name": "template2-ground template"
			},
			{
				"text": "}}",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "{{",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template2-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template2-ground template-delimiter"
			},
			{
				"text": "a",
				"name": "template2-ground template"
			},
			{
				"text": "}}",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "=",
				"name": "template-ground template-argument-name"
			},
			{
				"text": "{{",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template2-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template2-ground template-delimiter"
			},
			{
				"text": "b",
				"name": "template2-ground template"
			},
			{
				"text": "}}",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "a =",
				"name": "template-ground template-argument-name"
			},
			{
				"text": " b",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Template with invalid target containing unclosed tag",
		"wikitext": "{{a<b>|{{1x|foo}}|{{1x|a}}={{1x|b}}|a = b}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "a",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "<",
				"name": "template-ground error"
			},
			{
				"text": "b",
				"name": "template-ground template-name pagename"
			},
			{
				"text": ">",
				"name": "template-ground error"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "{{",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template2-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template2-ground template-delimiter"
			},
			{
				"text": "foo",
				"name": "template2-ground template"
			},
			{
				"text": "}}",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "{{",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template2-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template2-ground template-delimiter"
			},
			{
				"text": "a",
				"name": "template2-ground template"
			},
			{
				"text": "}}",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "=",
				"name": "template-ground template-argument-name"
			},
			{
				"text": "{{",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template2-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template2-ground template-delimiter"
			},
			{
				"text": "b",
				"name": "template2-ground template"
			},
			{
				"text": "}}",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "a =",
				"name": "template-ground template-argument-name"
			},
			{
				"text": " b",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Template with invalid target containing wikilink",
		"wikitext": "{{[[Main Page]]}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "[[",
				"name": "template-ground error"
			},
			{
				"text": "Main Page",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "]]",
				"name": "template-ground error"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Template with just whitespace in it, T70421",
		"wikitext": "{{1x|{{ }}}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "{{ }}",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Template with just whitespace (bad template brace matching)",
		"wikitext": "{{1x|{{ }<nowiki>}</nowiki>}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "{{ ",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "}<",
				"name": "template2-ground error"
			},
			{
				"text": "nowiki",
				"name": "template2-ground template-name pagename"
			},
			{
				"text": ">}<",
				"name": "template2-ground error"
			},
			{
				"text": "/nowiki",
				"name": "template2-ground template-name pagename"
			},
			{
				"text": ">",
				"name": "template2-ground error"
			},
			{
				"text": "}}",
				"name": "template2-ground template-bracket"
			}
		]
	},
	{
		"desc": "Simple template",
		"wikitext": "{{test}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "test",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Template with explicit namespace",
		"wikitext": "{{Template:test}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "Template:test",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Template parameter",
		"wikitext": "{{paramtest|param=foo}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "paramtest",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "param=",
				"name": "template-ground template-argument-name"
			},
			{
				"text": "foo",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Template unnamed parameter",
		"wikitext": "{{paramtestnum|Main Page|the main page}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "paramtestnum",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "Main Page",
				"name": "template-ground template"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "the main page",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Template with template name as unnamed argument",
		"wikitext": "{{templateasargtestnum|templatesimple}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "templateasargtestnum",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "templatesimple",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Template with template name as argument",
		"wikitext": "{{templateasargtest|templ=simple}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "templateasargtest",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "templ=",
				"name": "template-ground template-argument-name"
			},
			{
				"text": "simple",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Template with template name as argument (2)",
		"wikitext": "{{templateasargtest2|templ=templatesimple}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "templateasargtest2",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "templ=",
				"name": "template-ground template-argument-name"
			},
			{
				"text": "templatesimple",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Template with default value",
		"wikitext": "{{templateasargtestdefault}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "templateasargtestdefault",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Template with default value (value set)",
		"wikitext": "{{templateasargtestdefault|templ=templa}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "templateasargtestdefault",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "templ=",
				"name": "template-ground template-argument-name"
			},
			{
				"text": "templa",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Template redirect",
		"wikitext": "{{templateredirect}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "templateredirect",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Template with argument in separate line",
		"wikitext": "{{ templateasargtest  |\n templ = simple }}",
		"tokens": [
			{
				"text": "{{ ",
				"name": "template-ground template-bracket"
			},
			{
				"text": "templateasargtest  ",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": " templ =",
				"name": "template-ground template-argument-name"
			},
			{
				"text": " simple ",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Template with complex template as argument",
		"wikitext": "{{paramtest|\n  param ={{ templateasargtest  |\n templ = simple }}}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "paramtest",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "  param =",
				"name": "template-ground template-argument-name"
			},
			{
				"text": "{{ ",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "templateasargtest  ",
				"name": "template2-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template2-ground template-delimiter"
			},
			{
				"text": " templ =",
				"name": "template2-ground template-argument-name"
			},
			{
				"text": " simple ",
				"name": "template2-ground template"
			},
			{
				"text": "}}",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates with templated name",
		"wikitext": "{{{{1x|1x}}|foo}}\n{{{{1x|inner list}} }}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "{{",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template2-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template2-ground template-delimiter"
			},
			{
				"text": "1x",
				"name": "template2-ground template"
			},
			{
				"text": "}}",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "foo",
				"name": "template-ground template"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "{{",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template2-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template2-ground template-delimiter"
			},
			{
				"text": "inner list",
				"name": "template2-ground template"
			},
			{
				"text": "}}",
				"name": "template2-ground template-bracket"
			},
			{
				"text": " }}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates with templated name and top level template args",
		"wikitext": "{{1{{2{{{3}}}|4=5}}}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "{{",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "2",
				"name": "template2-ground template-name pagename"
			},
			{
				"text": "{{{",
				"name": "template2-ground templatevariable-bracket"
			},
			{
				"text": "3",
				"name": "template2-ground templatevariable-name"
			},
			{
				"text": "}}}",
				"name": "template2-ground templatevariable-bracket"
			},
			{
				"text": "|",
				"name": "template2-ground template-delimiter"
			},
			{
				"text": "4=",
				"name": "template2-ground template-argument-name"
			},
			{
				"text": "5",
				"name": "template2-ground template"
			},
			{
				"text": "}}",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates with invalid templated targets",
		"wikitext": "{{1x\n{{1x|foo}}\n}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "foo",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "}}",
				"name": ""
			}
		]
	},
	{
		"desc": "Template with complex arguments",
		"wikitext": "{{complextemplate|\n  param ={{ templateasargtest  |\n templ = simple }}|[[Template:complextemplate|link]]}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "complextemplate",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "  param =",
				"name": "template-ground template-argument-name"
			},
			{
				"text": "{{ ",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "templateasargtest  ",
				"name": "template2-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template2-ground template-delimiter"
			},
			{
				"text": " templ =",
				"name": "template2-ground template-argument-name"
			},
			{
				"text": " simple ",
				"name": "template2-ground template"
			},
			{
				"text": "}}",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "[[",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "Template:complextemplate",
				"name": "template-link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground link-delimiter"
			},
			{
				"text": "link",
				"name": "template-link-ground link-text"
			},
			{
				"text": "]]",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "T2553: link with two variables in a piped link",
		"wikitext": "{|\n|[[{{{1}}}|{{{2}}}]]\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "{{{",
				"name": "link-ground templatevariable-bracket"
			},
			{
				"text": "1",
				"name": "link-ground templatevariable-name"
			},
			{
				"text": "}}}",
				"name": "link-ground templatevariable-bracket"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "{{{",
				"name": "link-ground templatevariable-bracket"
			},
			{
				"text": "2",
				"name": "link-ground templatevariable-name"
			},
			{
				"text": "}}}",
				"name": "link-ground templatevariable-bracket"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Bail on table cell attribute parsing on wikilink",
		"wikitext": "{|\n|testing [[one|two]] |three||four\n|testing one two |three||four\n|testing=\"[[one|two]]\" |three||four\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "testing ",
				"name": "table-definition html-td"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "one",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "two",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " ",
				"name": "table-definition html-td"
			},
			{
				"text": "|",
				"name": "table-delimiter2"
			},
			{
				"text": "three",
				"name": ""
			},
			{
				"text": "||",
				"name": "table-delimiter"
			},
			{
				"text": "four",
				"name": ""
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "testing one two ",
				"name": "table-definition html-td"
			},
			{
				"text": "|",
				"name": "table-delimiter2"
			},
			{
				"text": "three",
				"name": ""
			},
			{
				"text": "||",
				"name": "table-delimiter"
			},
			{
				"text": "four",
				"name": ""
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "testing=\"",
				"name": "table-definition html-td"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "one",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "two",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "\" ",
				"name": "table-definition html-td"
			},
			{
				"text": "|",
				"name": "table-delimiter2"
			},
			{
				"text": "three",
				"name": ""
			},
			{
				"text": "||",
				"name": "table-delimiter"
			},
			{
				"text": "four",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Magic variable as template parameter",
		"wikitext": "{{paramtest|param={{SITENAME}}}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "paramtest",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "param=",
				"name": "template-ground template-argument-name"
			},
			{
				"text": "{{",
				"name": "template-ext-ground parserfunction-bracket"
			},
			{
				"text": "SITENAME",
				"name": "template-ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "template-ext-ground parserfunction-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Template parameter as link source",
		"wikitext": "{{linktest|param=Main Page}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "linktest",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "param=",
				"name": "template-ground template-argument-name"
			},
			{
				"text": "Main Page",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Template passing argument to another template",
		"wikitext": "{{paramtest2|arg='hmm'}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "paramtest2",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "arg=",
				"name": "template-ground template-argument-name"
			},
			{
				"text": "'hmm'",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Template as link source",
		"wikitext": "[[{{linktest2}}]]\n\n[[{{linktest2}}|Main Page]]\n\n[[{{linktest2}}]]Page",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "linktest2",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "linktest2",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "linktest2",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Page",
				"name": ""
			}
		]
	},
	{
		"desc": "Template infinite loop",
		"wikitext": "{{loop1}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "loop1",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Template from main namespace",
		"wikitext": "{{:Main Page}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": ":Main Page",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "T2529: Template with table, not included at beginning of line",
		"wikitext": "foo {{table}}",
		"tokens": [
			{
				"text": "foo ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "table",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "T2523: Template shouldn't eat newline (or add an extra one before table)",
		"wikitext": "foo\n{{table}}",
		"tokens": [
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "table",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "T2041: Template parameters shown as broken links",
		"wikitext": "{{{parameter}}}",
		"tokens": [
			{
				"text": "{{{",
				"name": "templatevariable-bracket"
			},
			{
				"text": "parameter",
				"name": "templatevariable-name"
			},
			{
				"text": "}}}",
				"name": "templatevariable-bracket"
			}
		]
	},
	{
		"desc": "Template with targets containing wikilinks",
		"wikitext": "{{[[foo]]}}\n\n{{[[{{1x|foo}}]]}}\n\n{{{{1x|[[foo}}]]}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "[[",
				"name": "template-ground error"
			},
			{
				"text": "foo",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "]]",
				"name": "template-ground error"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "[[",
				"name": "template-ground error"
			},
			{
				"text": "{{",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template2-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template2-ground template-delimiter"
			},
			{
				"text": "foo",
				"name": "template2-ground template"
			},
			{
				"text": "}}",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "]]",
				"name": "template-ground error"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "{{",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template2-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template2-ground template-delimiter"
			},
			{
				"text": "[[",
				"name": "template2-link-ground link-bracket"
			},
			{
				"text": "foo",
				"name": "template2-link-ground link-pagename pagename"
			},
			{
				"text": "}}",
				"name": "template2-link-ground error"
			},
			{
				"text": "]]",
				"name": "template2-link-ground link-bracket"
			},
			{
				"text": "}}",
				"name": "template2-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates: Double quotes as template target",
		"wikitext": "foo {{''}} baz",
		"tokens": [
			{
				"text": "foo ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "''",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": " baz",
				"name": ""
			}
		]
	},
	{
		"desc": "Templates with intersecting and overlapping ranges",
		"wikitext": "{|{{1x|1=class=\"foo\"\n<p>ha</p>}}\n{|{{1x|1=class=\"bar\"\n<p>ho</p>}}\n{{1x|{{!}}hi}}\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "1=",
				"name": "template-ground template-argument-name"
			},
			{
				"text": "class=\"foo\"",
				"name": "template-ground template"
			},
			{
				"text": "<",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "p",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "ha",
				"name": "template-ground template"
			},
			{
				"text": "</",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "p",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "1=",
				"name": "template-ground template-argument-name"
			},
			{
				"text": "class=\"bar\"",
				"name": "template-ground template"
			},
			{
				"text": "<",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "p",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "ho",
				"name": "template-ground template"
			},
			{
				"text": "</",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "p",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "{{",
				"name": "template-ext-ground parserfunction-bracket"
			},
			{
				"text": "!",
				"name": "template-ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "template-ext-ground parserfunction-bracket"
			},
			{
				"text": "hi",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "msgnw keyword",
		"wikitext": "{{msgnw:MSGNW test}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "msgnw",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "MSGNW test",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "int keyword",
		"wikitext": "{{int:new-messages|lots of money|not!}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "int",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "new-messages",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "lots of money",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "not!",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "int keyword - non-existing message",
		"wikitext": "{{int:var}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "int",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "var",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "<includeonly> and <noinclude> being included",
		"wikitext": "{{Includes}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "Includes",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "<onlyinclude> being included",
		"wikitext": "{{Includes2}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "Includes2",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "<onlyinclude> and <includeonly> being included",
		"wikitext": "{{Includes3}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "Includes3",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "<includeonly> and <noinclude> on a page",
		"wikitext": "Foo<noinclude>zar</noinclude><includeonly>bar</includeonly>",
		"tokens": [
			{
				"text": "Foo",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "noinclude",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "zar",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "noinclude",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "includeonly",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "bar",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "includeonly",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Un-closed <noinclude>",
		"wikitext": "<noinclude>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "noinclude",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Empty <noinclude>",
		"wikitext": "Hello<noinclude></noinclude>!",
		"tokens": [
			{
				"text": "Hello",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "noinclude",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "noinclude",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "!",
				"name": ""
			}
		]
	},
	{
		"desc": "Nested <noinclude>s",
		"wikitext": "<noinclude>\nx\n<noinclude>y</noinclude>\nz\n</noinclude>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "noinclude",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "x",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "noinclude",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "y",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "noinclude",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "z",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "noinclude",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "<onlyinclude> on a page",
		"wikitext": "<onlyinclude>Foo</onlyinclude>bar",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "onlyinclude",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Foo",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "onlyinclude",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "bar",
				"name": ""
			}
		]
	},
	{
		"desc": "Un-closed <onlyinclude>",
		"wikitext": "<onlyinclude>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "onlyinclude",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Self-closed noinclude, includeonly, onlyinclude tags",
		"wikitext": "<noinclude />\n<includeonly />\n<onlyinclude />",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "noinclude ",
				"name": "htmltag-name"
			},
			{
				"text": "/><",
				"name": "htmltag-bracket"
			},
			{
				"text": "includeonly ",
				"name": "htmltag-name"
			},
			{
				"text": "/><",
				"name": "htmltag-bracket"
			},
			{
				"text": "onlyinclude ",
				"name": "htmltag-name"
			},
			{
				"text": "/>",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Unbalanced includeonly and noinclude tags",
		"wikitext": "{|\n|a</noinclude>\n|b</noinclude></noinclude>\n|c</noinclude></includeonly>\n|d</includeonly></includeonly>\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": "</noinclude>",
				"name": "error"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "b",
				"name": ""
			},
			{
				"text": "</noinclude></noinclude>",
				"name": "error"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "c",
				"name": ""
			},
			{
				"text": "</noinclude></includeonly>",
				"name": "error"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "d",
				"name": ""
			},
			{
				"text": "</includeonly></includeonly>",
				"name": "error"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "T8563: Edit link generation for section shown by <includeonly>",
		"wikitext": "{{includeonly section}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "includeonly section",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "T8563: Edit link generation for section suppressed by <includeonly>",
		"wikitext": "<includeonly>\n==Includeonly section==\n</includeonly>\n==Section 1==",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "includeonly",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "==",
				"name": "section-header section--2"
			},
			{
				"text": "Includeonly section",
				"name": "section"
			},
			{
				"text": "==",
				"name": "section-header"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "includeonly",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "==",
				"name": "section-header section--2"
			},
			{
				"text": "Section 1",
				"name": "section"
			},
			{
				"text": "==",
				"name": "section-header"
			}
		]
	},
	{
		"desc": "Un-closed <includeonly>",
		"wikitext": "<includeonly>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "includeonly",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Includes and comments at SOL",
		"wikitext": "<!-- comment --><noinclude><!-- comment --></noinclude><!-- comment -->==hu==\n\n<noinclude>\nsome\n</noinclude>*stuff\n*here\n\n<noinclude>\nsome</noinclude>* stuff\n* here\n\n<includeonly>can have stuff</includeonly>===here===\n\n__INDEX__== hi ==",
		"tokens": [
			{
				"text": "<!-- comment -->",
				"name": "comment"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "noinclude",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "<!-- comment -->",
				"name": "comment"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "noinclude",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "<!-- comment -->",
				"name": "comment"
			},
			{
				"text": "==hu==",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "noinclude",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "some",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "noinclude",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "*stuff",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "here",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "noinclude",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "some",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "noinclude",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "* stuff",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": " here",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "includeonly",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "can have stuff",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "includeonly",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "===here===",
				"name": ""
			},
			{
				"text": "__INDEX__",
				"name": "double-underscore"
			},
			{
				"text": "== hi ==",
				"name": ""
			}
		]
	},
	{
		"desc": "Parsoid: Merge double tds (T52603)",
		"wikitext": "{|\n|{{1x|{{!}} foo}}\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "{{",
				"name": "template-ext-ground parserfunction-bracket"
			},
			{
				"text": "!",
				"name": "template-ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "template-ext-ground parserfunction-bracket"
			},
			{
				"text": " foo",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Parsoid: Merge double tds in nested transclusion content (T52603)",
		"wikitext": "{{1x|<div>}}\n{|\n|{{1x|{{!}} foo}}\n|}\n{{1x|</div>}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "<",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "div",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "{{",
				"name": "template-ext-ground parserfunction-bracket"
			},
			{
				"text": "!",
				"name": "template-ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "template-ext-ground parserfunction-bracket"
			},
			{
				"text": " foo",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "</",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "div",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "0. includeonly around the entire attribute",
		"wikitext": "<span <includeonly>id=\"v1\"</includeonly><noinclude>id=\"v2\"</noinclude>>bar</span>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "span ",
				"name": "htmltag-name"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "includeonly",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "id=\"v1\"",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "includeonly",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "noinclude",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "id=\"v2\"",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "noinclude",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": ">bar",
				"name": ""
			},
			{
				"text": "</span>",
				"name": "error"
			}
		]
	},
	{
		"desc": "1. includeonly in html attr key",
		"wikitext": "<span <noinclude>id</noinclude><includeonly>about</includeonly>=\"foo\">bar</span>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "span ",
				"name": "htmltag-name"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "noinclude",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "id",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "noinclude",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "includeonly",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "about",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "includeonly",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "=\"foo\">bar",
				"name": ""
			},
			{
				"text": "</span>",
				"name": "error"
			}
		]
	},
	{
		"desc": "2. includeonly in html attr value",
		"wikitext": "<span id=\"<noinclude>v1</noinclude><includeonly>v2</includeonly>\">bar</span>\n<span id=<noinclude>\"v1\"</noinclude><includeonly>\"v2\"</includeonly>>bar</span>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "span ",
				"name": "htmltag-name"
			},
			{
				"text": "id=\"",
				"name": "htmltag-attribute html-span"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "noinclude",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "v1",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "noinclude",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "includeonly",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "v2",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "includeonly",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "\">bar",
				"name": ""
			},
			{
				"text": "</span>",
				"name": "error"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "span ",
				"name": "htmltag-name"
			},
			{
				"text": "id=",
				"name": "htmltag-attribute html-span"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "noinclude",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "\"v1\"",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "noinclude",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "includeonly",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "\"v2\"",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "includeonly",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": ">bar",
				"name": ""
			},
			{
				"text": "</span>",
				"name": "error"
			}
		]
	},
	{
		"desc": "3. includeonly in part of an attr value",
		"wikitext": "<span style=\"color:<noinclude>red</noinclude><includeonly>blue</includeonly>;\">bar</span>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "span ",
				"name": "htmltag-name"
			},
			{
				"text": "style=\"color:",
				"name": "htmltag-attribute html-span"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "noinclude",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "red",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "noinclude",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "includeonly",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "blue",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "includeonly",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": ";\">bar",
				"name": ""
			},
			{
				"text": "</span>",
				"name": "error"
			}
		]
	},
	{
		"desc": "4. includeonly in table attributes",
		"wikitext": "{|\n|- <noinclude>\n|-\n|a\n</noinclude>\n|- <includeonly>\n|-\n|b\n</includeonly>\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|- ",
				"name": "table-delimiter"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "noinclude",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "|-|",
				"name": "table-delimiter"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "noinclude",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "|- ",
				"name": "table-delimiter"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "includeonly",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "|-|",
				"name": "table-delimiter"
			},
			{
				"text": "b",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "includeonly",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Table wikitext syntax outside wiki-tables",
		"wikitext": "a\n|+ not a caption\n! not a table heading\n|- not a table row\n| not a table cell\n| class=\"foo bar\" | baz\nb\n|}\n|-\nc",
		"tokens": [
			{
				"text": "a|+ not a caption! not a table heading|- not a table row| not a table cell| class=\"foo bar\" | bazb|}|-c",
				"name": ""
			}
		]
	},
	{
		"desc": "Content after <tr> like wikitext should get fully processed",
		"wikitext": "x\n|- [[Foo]] and {{1x|bar}}\ny",
		"tokens": [
			{
				"text": "x|- ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Foo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " and ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "bar",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "y",
				"name": ""
			}
		]
	},
	{
		"desc": "P-wrapping should not break after <td>s separated by newlines are converted back to pipes",
		"wikitext": "a\n|b\n\n|c\nd",
		"tokens": [
			{
				"text": "a|b|cd",
				"name": ""
			}
		]
	},
	{
		"desc": "Orphaned table row wikitext with templated table for an attribute should not duplicate table",
		"wikitext": "|-{{1x|\n{{{!}}\n{{!}}foo\n{{!}}}\n}}",
		"tokens": [
			{
				"text": "|-",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "{{{!}}",
				"name": "template-ground table-bracket"
			},
			{
				"text": "{{!}}",
				"name": "template-ground table-delimiter"
			},
			{
				"text": "foo",
				"name": "template-ground"
			},
			{
				"text": "{{!}}}",
				"name": "template-ground table-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates: Template Name/Arg clash: 1. Use of positional param",
		"wikitext": "{{quote|foo}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "quote",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "foo",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates: Template Name/Arg clash: 2. Use of named param",
		"wikitext": "{{quote|quote=foo}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "quote",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "quote=",
				"name": "template-ground template-argument-name"
			},
			{
				"text": "foo",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates: 1. Simple use",
		"wikitext": "{{1x|Foo}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "Foo",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates: 2. Inside a block tag",
		"wikitext": "<div>{{1x|Foo}}</div>\n<blockquote>{{1x|Foo}}</blockquote>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "Foo",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "blockquote",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "Foo",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "blockquote",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Templates: P-wrapping: 1a. Templates on consecutive lines",
		"wikitext": "{{1x|Foo}}\n{{1x|bar}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "Foo",
				"name": "template-ground template"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "bar",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates: P-wrapping: 1b. Templates on consecutive lines",
		"wikitext": "Foo\n\n{{1x|bar}}\n{{1x|baz}}",
		"tokens": [
			{
				"text": "Foo",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "bar",
				"name": "template-ground template"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "baz",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates: P-wrapping: 1c. Templates on consecutive lines",
		"wikitext": "{{1x|Foo}}\n{{1x|bar}} <div>baz</div>",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "Foo",
				"name": "template-ground template"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "bar",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "baz",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Templates: P-wrapping: 1d. Template preceded by comment-only line",
		"wikitext": "<!-- foo -->\n{{1x|Bar}}",
		"tokens": [
			{
				"text": "<!-- foo -->",
				"name": "comment"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "Bar",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates: Scopes should not be expanded unnecessarily",
		"wikitext": "{{1x|<div>a</div>}}b{{1x|\n<div>c</div>}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "<",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "div",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "a",
				"name": "template-ground template"
			},
			{
				"text": "</",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "div",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "b",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "<",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "div",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "c",
				"name": "template-ground template"
			},
			{
				"text": "</",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "div",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates: Inline Text: 1. Multiple template uses",
		"wikitext": "{{1x|Foo}}bar{{1x|baz}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "Foo",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "bar",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "baz",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates: Inline Text: 2. Back-to-back template uses",
		"wikitext": "{{1x|Foo}}{{1x|bar}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "Foo",
				"name": "template-ground template"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "bar",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates: Block Tags: 1. Multiple template uses",
		"wikitext": "{{1x|<div>Foo</div>}}<div>bar</div>{{1x|<div>baz</div>}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "<",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "div",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "Foo",
				"name": "template-ground template"
			},
			{
				"text": "</",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "div",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "bar",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "<",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "div",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "baz",
				"name": "template-ground template"
			},
			{
				"text": "</",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "div",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates: Block Tags: 2. Back-to-back template uses",
		"wikitext": "{{1x|<div>Foo</div>}}{{1x|<div>bar</div>}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "<",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "div",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "Foo",
				"name": "template-ground template"
			},
			{
				"text": "</",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "div",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "<",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "div",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "bar",
				"name": "template-ground template"
			},
			{
				"text": "</",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "div",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates: Correctly encapsulate templates producing </p> tag without a corresponding <p> tag",
		"wikitext": "{{1x|a\nb</p>}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "ab",
				"name": "template-ground template"
			},
			{
				"text": "</p>",
				"name": "template-ground error"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Drop stripped tag markers, unless they have encapsulation info",
		"wikitext": "{{1x|<tr></tr>}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "<",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "tr",
				"name": "template-ground htmltag-name"
			},
			{
				"text": "></",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "tr",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates: Links: 1. Simple example",
		"wikitext": "{{1x|[[Foo|bar]]}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "[[",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "Foo",
				"name": "template-link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground link-delimiter"
			},
			{
				"text": "bar",
				"name": "template-link-ground link-text"
			},
			{
				"text": "]]",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates: Links: 2. Generation of link href",
		"wikitext": "[[{{1x|Foo}}|bar]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground template-delimiter"
			},
			{
				"text": "Foo",
				"name": "template-link-ground template"
			},
			{
				"text": "}}",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "bar",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Templates: Links: 3. Generation of part of a link href",
		"wikitext": "[[Fo{{1x|o}}|bar]]\n\n[[Foo{{1x|bar}}]]\n\n[[Foo{{1x|bar}}baz]]\n\n[[Foo{{1x|bar}}|bar]]\n\n[[:Foo{{1x|bar}}]]\n\n[[:Foo{{1x|bar}}|bar]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Fo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground template-delimiter"
			},
			{
				"text": "o",
				"name": "template-link-ground template"
			},
			{
				"text": "}}",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "bar",
				"name": "link-ground link-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Foo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground template-delimiter"
			},
			{
				"text": "bar",
				"name": "template-link-ground template"
			},
			{
				"text": "}}",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Foo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground template-delimiter"
			},
			{
				"text": "bar",
				"name": "template-link-ground template"
			},
			{
				"text": "}}",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "baz",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Foo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground template-delimiter"
			},
			{
				"text": "bar",
				"name": "template-link-ground template"
			},
			{
				"text": "}}",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "bar",
				"name": "link-ground link-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": ":Foo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground template-delimiter"
			},
			{
				"text": "bar",
				"name": "template-link-ground template"
			},
			{
				"text": "}}",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": ":Foo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground template-delimiter"
			},
			{
				"text": "bar",
				"name": "template-link-ground template"
			},
			{
				"text": "}}",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "bar",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Templates: Links: 4. Multiple templates generating link href",
		"wikitext": "[[{{1x|F}}{{1x|o}}ob{{1x|ar}}]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground template-delimiter"
			},
			{
				"text": "F",
				"name": "template-link-ground template"
			},
			{
				"text": "}}{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground template-delimiter"
			},
			{
				"text": "o",
				"name": "template-link-ground template"
			},
			{
				"text": "}}",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "ob",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground template-delimiter"
			},
			{
				"text": "ar",
				"name": "template-link-ground template"
			},
			{
				"text": "}}",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Templates: Links: 5. Generation of link text",
		"wikitext": "[[Foo|{{1x|bar}}]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Foo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground template-delimiter"
			},
			{
				"text": "bar",
				"name": "template-link-ground template"
			},
			{
				"text": "}}",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Templates: Links: 5. Nested templates (only outermost template should be marked)",
		"wikitext": "{{1x|[[{{1x|Foo}}|bar]]}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "[[",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "{{",
				"name": "template2-link-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template2-link-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template2-link-ground template-delimiter"
			},
			{
				"text": "Foo",
				"name": "template2-link-ground template"
			},
			{
				"text": "}}",
				"name": "template2-link-ground template-bracket"
			},
			{
				"text": "|",
				"name": "template-link-ground link-delimiter"
			},
			{
				"text": "bar",
				"name": "template-link-ground link-text"
			},
			{
				"text": "]]",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates: HTML Tag: 1. Generation of HTML attr. key",
		"wikitext": "<div {{1x|style}}=\"color:red;\">foo</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "style",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "=\"color:red;\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Templates: HTML Tag: 2. Generation of HTML attr. value",
		"wikitext": "<div style={{1x|'color:red;'}}>foo</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "style=",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "'color:red;'",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Templates: HTML Tag: 3. Generation of HTML attr key and value",
		"wikitext": "<div {{1x|style}}={{1x|'color:red;'}}>foo</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "style",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "=",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "'color:red;'",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Templates: HTML Tag: 4. Generation of starting piece of HTML attr value",
		"wikitext": "<div title=\"{{1x|This is a long title}} with just one piece templated\">foo</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "title=\"{{1x|This is a long title}} with just one piece templated\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Templates: HTML Tag: 5. Generation of middle piece of HTML attr value",
		"wikitext": "<div title=\"This is a long title with just {{1x|one piece}} templated\">foo</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "title=\"This is a long title with just {{1x|one piece}} templated\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Templates: HTML Tag: 6. Generation of end piece of HTML attr value",
		"wikitext": "<div title=\"This is a long title with just one piece {{1x|templated}}\">foo</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "title=\"This is a long title with just one piece {{1x|templated}}\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Templates: HTML Tag: 7. Generation of partial attribute key string",
		"wikitext": "<div st{{1x|yle}}=\"color:red;\">foo</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "st",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "yle",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "=\"color:red;\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Templates: HTML Tag: 8. Template-generated attribute (k=v)",
		"wikitext": "<div {{1x|1=id=\"v1\"}}>bar</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "1=",
				"name": "template-ground template-argument-name"
			},
			{
				"text": "id=\"v1\"",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "bar",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Templates: HTML Tag: 9. Multiple template-generated attributes",
		"wikitext": "<div {{1x|1=id=\"v1\" title=\"foo\"}}>bar</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "1=",
				"name": "template-ground template-argument-name"
			},
			{
				"text": "id=\"v1\" title=\"foo\"",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "bar",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Templates: Support for templates generating attributes and content",
		"wikitext": "{| {{mixed_attr_content_template}}\n|-\n|bar\n|}",
		"tokens": [
			{
				"text": "{| ",
				"name": "table-bracket"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "mixed_attr_content_template",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "|-|",
				"name": "table-delimiter"
			},
			{
				"text": "bar",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Templates: Support for templates generating table attributes and content (with fostered categories)",
		"wikitext": "{| {{mixed_attr_content_template_2}}\n|-\n|bar\n|}",
		"tokens": [
			{
				"text": "{| ",
				"name": "table-bracket"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "mixed_attr_content_template_2",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "|-|",
				"name": "table-delimiter"
			},
			{
				"text": "bar",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "1. Entities and nowikis inside templated attributes should be handled correctly",
		"wikitext": "<div {{1x|style{{=}}\"background:&#35;f9f9f9;\"}}>foo</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "style",
				"name": "template-ground template"
			},
			{
				"text": "{{",
				"name": "template-ext-ground parserfunction-bracket"
			},
			{
				"text": "=",
				"name": "template-ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "template-ext-ground parserfunction-bracket"
			},
			{
				"text": "\"background:",
				"name": "template-ground template"
			},
			{
				"text": "&#35;",
				"name": "template-ground entity"
			},
			{
				"text": "f9f9f9;\"",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "2. Entities and nowikis inside templated attributes should be handled correctly",
		"wikitext": "{|\n|{{table_attribs_3}}\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "table_attribs_3",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "3. Entities and nowikis inside templated attributes should be handled correctly inside templated tables",
		"wikitext": "{{tbl-start}}\n|{{table_attribs_3}}\n{{tbl-end}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "tbl-start",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "|",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "table_attribs_3",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "tbl-end",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "4. Entities and nowikis inside templated attributes should be handled correctly inside templated tables",
		"wikitext": "{|\n|{{table_attribs_6}} hi\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "table_attribs_6",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": " hi",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Extension tag in templated tag attribute",
		"wikitext": "{{1x|1=\n{{{!}} class=\"123\" <nowiki />\n{{!}} hi\n{{!}}}\n}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "1=",
				"name": "template-ground template-argument-name"
			},
			{
				"text": "{{{!}} ",
				"name": "template-ground table-bracket"
			},
			{
				"text": "class=\"123\" ",
				"name": "template-ground table-definition html-table"
			},
			{
				"text": "<",
				"name": "template-ground exttag-bracket"
			},
			{
				"text": "nowiki ",
				"name": "template-ground exttag-name"
			},
			{
				"text": "/>",
				"name": "template-ground exttag-bracket"
			},
			{
				"text": "{{!}} ",
				"name": "template-ground table-delimiter"
			},
			{
				"text": "hi",
				"name": "template-ground"
			},
			{
				"text": "{{!}}}",
				"name": "template-ground table-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates: HTML Tables: 1. Generating start of a HTML table",
		"wikitext": "{{1x|<table><tr><td>foo</td>}}</tr></table>",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "<",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "table",
				"name": "template-ground htmltag-name"
			},
			{
				"text": "><",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "tr",
				"name": "template-ground htmltag-name"
			},
			{
				"text": "><",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "td",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "foo",
				"name": "template-ground template"
			},
			{
				"text": "</",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "td",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "tr",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Templates: HTML Tables: 2a. Generating middle of a HTML table",
		"wikitext": "<table><tr>{{1x|<td>foo</td>}}</tr></table>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "tr",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "<",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "td",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "foo",
				"name": "template-ground template"
			},
			{
				"text": "</",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "td",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "tr",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Templates: HTML Tables: 2b. Generating middle of a HTML table",
		"wikitext": "<table>{{1x|<tr><td>foo</td></tr>}}</table>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "<",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "tr",
				"name": "template-ground htmltag-name"
			},
			{
				"text": "><",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "td",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "foo",
				"name": "template-ground template"
			},
			{
				"text": "</",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "td",
				"name": "template-ground htmltag-name"
			},
			{
				"text": "></",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "tr",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Templates: HTML Tables: 3. Generating end of a HTML table",
		"wikitext": "<table><tr>{{1x|<td>foo</td></tr></table>}}",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "tr",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "<",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "td",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "foo",
				"name": "template-ground template"
			},
			{
				"text": "</",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "td",
				"name": "template-ground htmltag-name"
			},
			{
				"text": "></",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "tr",
				"name": "template-ground htmltag-name"
			},
			{
				"text": "></",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "table",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates: HTML Tables: 4a. Generating a single tag of a HTML table",
		"wikitext": "{{1x|<table>}}<tr><td>foo</td></tr></table>",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "<",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "table",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "tr",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "tr",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Templates: HTML Tables: 4b. Generating a single tag of a HTML table",
		"wikitext": "<table>{{1x|<tr>}}<td>foo</td></tr></table>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "<",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "tr",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "tr",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Templates: HTML Tables: 4c. Generating a single tag of a HTML table",
		"wikitext": "<table><tr>{{1x|<td>}}foo</td></tr></table>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "tr",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "<",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "td",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "tr",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Templates: HTML Tables: 4d. Generating a single tag of a HTML table",
		"wikitext": "<table><tr><td>foo{{1x|</td>}}</tr></table>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "tr",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "</",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "td",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "tr",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Templates: HTML Tables: 4e. Generating a single tag of a HTML table",
		"wikitext": "<table><tr><td>foo</td>{{1x|</tr>}}</table>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "tr",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "</",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "tr",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Templates: HTML Tables: 4f. Generating a single tag of a HTML table",
		"wikitext": "<table><tr><td>foo</td></tr>{{1x|</table>}}",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "tr",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "tr",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "</",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "table",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates: HTML Tables: 5. Proper fostering of categories from inside",
		"wikitext": "<table>[[Category:foo1]]<tr><td>foo</td></tr></table>\n<!--Two categories (T52330)-->\n<table>[[Category:bar1]][[Category:bar2]]<tr><td>foo</td></tr></table>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Category:foo1",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "tr",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "tr",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "<!--Two categories (T52330)-->",
				"name": "comment"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Category:bar1",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Category:bar2",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "tr",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "tr",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Templates: Wiki Tables: 1a. Fostering of entire template content",
		"wikitext": "{|\n{{1x|a}}\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "a",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Templates: Wiki Tables: 1b. Fostering of entire template content",
		"wikitext": "{|\n{{1x|<div>}}\nfoo\n{{1x|</div>}}\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "<",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "div",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "foo",
				"name": "error"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "</",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "div",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Templates: Wiki Tables: 2. Fostering of partial template content",
		"wikitext": "{|\n{{1x|a\n<div>b</div>}}\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "a",
				"name": "template-ground template"
			},
			{
				"text": "<",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "div",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "b",
				"name": "template-ground template"
			},
			{
				"text": "</",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "div",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Templates: Wiki Tables: 3. td-content via multiple templates",
		"wikitext": "{|\n{{1x|{{pipe}}a}}{{1x|b}}\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "{{",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "pipe",
				"name": "template2-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "a",
				"name": "template-ground template"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "b",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Templates: Wiki Tables: 4. Templated tags, no content",
		"wikitext": "{{tbl-start}}\n{{tbl-end}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "tbl-start",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "tbl-end",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates: Wiki Tables: 5. Templated tags, regular td-tags",
		"wikitext": "{{tbl-start}}\n|foo\n{{tbl-end}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "tbl-start",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "|foo",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "tbl-end",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates: Wiki Tables: 6. Templated tags, templated td-tags",
		"wikitext": "{{tbl-start}}\n{{!}}foo\n{{tbl-end}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "tbl-start",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "!",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "tbl-end",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates: Lists: Multi-line list-items via templates",
		"wikitext": "*{{1x|a {{nonexistent|\nunused}}}}\n*{{1x|b {{nonexistent|\nunused}}}}",
		"tokens": [
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "a ",
				"name": "template-ground template"
			},
			{
				"text": "{{",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "nonexistent",
				"name": "template2-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template2-ground template-delimiter"
			},
			{
				"text": "unused",
				"name": "template2-ground template"
			},
			{
				"text": "}}",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "b ",
				"name": "template-ground template"
			},
			{
				"text": "{{",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "nonexistent",
				"name": "template2-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template2-ground template-delimiter"
			},
			{
				"text": "unused",
				"name": "template2-ground template"
			},
			{
				"text": "}}",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates: Ugly nesting: 1. Quotes opened/closed across templates (1x)",
		"wikitext": "{{1x|''a}}{{1x|b''c''d}}{{1x|''e}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "''",
				"name": "template-ground apostrophes"
			},
			{
				"text": "a",
				"name": "template-ground template"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "b",
				"name": "template-ground template"
			},
			{
				"text": "''",
				"name": "template-ground apostrophes"
			},
			{
				"text": "c",
				"name": "template-ground template"
			},
			{
				"text": "''",
				"name": "template-ground apostrophes"
			},
			{
				"text": "d",
				"name": "template-ground template"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "''",
				"name": "template-ground apostrophes"
			},
			{
				"text": "e",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates: Ugly nesting: 3. Quotes opened/closed across templates (1x_with_div)",
		"wikitext": "{{1x_with_div|''a}}{{1x_with_div|b''c''d}}{{1x_with_div|''e}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x_with_div",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "''",
				"name": "template-ground apostrophes"
			},
			{
				"text": "a",
				"name": "template-ground template"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x_with_div",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "b",
				"name": "template-ground template"
			},
			{
				"text": "''",
				"name": "template-ground apostrophes"
			},
			{
				"text": "c",
				"name": "template-ground template"
			},
			{
				"text": "''",
				"name": "template-ground apostrophes"
			},
			{
				"text": "d",
				"name": "template-ground template"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x_with_div",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "''",
				"name": "template-ground apostrophes"
			},
			{
				"text": "e",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates: Ugly nesting: 4. Divs opened/closed across templates",
		"wikitext": "a<div>b{{1x|c</div>d}}e",
		"tokens": [
			{
				"text": "a",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "b",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "c",
				"name": "template-ground template"
			},
			{
				"text": "</",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "div",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "d",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "e",
				"name": ""
			}
		]
	},
	{
		"desc": "Templates: Ugly templates: 3. newline-only template parameter",
		"wikitext": "foo {{1x|\n}}",
		"tokens": [
			{
				"text": "foo ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates: Ugly templates: 4. newline-only template parameter inconsistency",
		"wikitext": "{{1x|\n}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates: Parameters substituted at the top-level",
		"wikitext": "{{{foo|''who'' {{1x|me}}? '''never!'''}}}\n\n{{{foo|bar|baz}}}",
		"tokens": [
			{
				"text": "{{{",
				"name": "templatevariable-bracket"
			},
			{
				"text": "foo",
				"name": "templatevariable-name"
			},
			{
				"text": "|",
				"name": "templatevariable-delimiter"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "who",
				"name": "templatevariable em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": " ",
				"name": "templatevariable"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "me",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "? ",
				"name": "templatevariable"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "never!",
				"name": "templatevariable strong"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "}}}{{{",
				"name": "templatevariable-bracket"
			},
			{
				"text": "foo",
				"name": "templatevariable-name"
			},
			{
				"text": "|",
				"name": "templatevariable-delimiter"
			},
			{
				"text": "bar",
				"name": "templatevariable"
			},
			{
				"text": "|",
				"name": "templatevariable-delimiter"
			},
			{
				"text": "baz",
				"name": "comment"
			},
			{
				"text": "}}}",
				"name": "templatevariable-bracket"
			}
		]
	},
	{
		"desc": "Compound transclusion with template and top level templatearg",
		"wikitext": "{{1x|<table>}}\n{{{top|<td>123</td>}}}\n</table>",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "<",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "table",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "{{{",
				"name": "templatevariable-bracket"
			},
			{
				"text": "top",
				"name": "templatevariable-name"
			},
			{
				"text": "|",
				"name": "templatevariable-delimiter"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "123",
				"name": "templatevariable"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "}}}",
				"name": "templatevariable-bracket"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Parser Functions: 1. Simple example",
		"wikitext": "{{uc:foo}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "uc",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "foo",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Parser Functions: 2. Nested use (only outermost should be marked up)",
		"wikitext": "{{uc:{{lc:FOO}}}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "uc",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "{{",
				"name": "ext2-ground parserfunction-bracket"
			},
			{
				"text": "lc",
				"name": "ext2-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext2-ground parserfunction-delimiter"
			},
			{
				"text": "FOO",
				"name": "ext2-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext2-ground parserfunction-bracket"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Parsoid: Recognize nowiki with odd capitalization",
		"wikitext": "<noWikI ><div>[[foo]]</Nowiki >",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "noWikI ",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "<div>[[foo]]",
				"name": "tag-nowiki"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "Nowiki ",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Subpage link",
		"wikitext": "[[/subpage]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "/subpage",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Subpage noslash link",
		"wikitext": "[[/subpage/]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "/subpage/",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Parsoid: dot-slash prefixed wikilinks",
		"wikitext": "[[./foo]]\n\n[[././bar]]\n\n[[././baz/]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "./foo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "././bar",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "././baz/",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Render invalid page names as plain text (T53090)",
		"wikitext": "[[./../foo|bar]]\n[[fooÔøΩ|bar]]\n[[foo/.|bar]]\n[[foo/..|bar]]\n[[foo~~~bar]]\n[[foo>bar]]\n[[foo[bar]]\n[[.]]\n[[..]]\n[[foo././bar]]\n[[foo[http://example.com]xyz]]\n\n[[{{1x|./../foo}}|bar]]\n[[{{1x|foo/.}}|bar]]\n[[{{1x|foo/..}}|bar]]\n[[{{1x|foo~~~~bar}}]]\n[[{{1x|foo>bar}}]]\n[[{{1x|foo././bar}}]]\n[[{{1x|foo{bar}}]]\n[[{{1x|foo}bar}}]]\n[[{{1x|foo[bar}}]]\n[[{{1x|foo]bar}}]]\n[[{{1x|foo<bar}}]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "./../foo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "bar",
				"name": "link-ground link-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "fooÔøΩ",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "bar",
				"name": "link-ground link-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "foo/.",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "bar",
				"name": "link-ground link-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "foo/..",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "bar",
				"name": "link-ground link-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "foo~~~bar",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "foo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": ">",
				"name": "link-ground error"
			},
			{
				"text": "bar",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "foo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "[",
				"name": "link-ground error"
			},
			{
				"text": "bar",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": ".",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "..",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "foo././bar",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "foo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "[",
				"name": "link-ground error"
			},
			{
				"text": "http://example.com",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]",
				"name": "link-ground error"
			},
			{
				"text": "xyz",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground template-delimiter"
			},
			{
				"text": "./../foo",
				"name": "template-link-ground template"
			},
			{
				"text": "}}",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "bar",
				"name": "link-ground link-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground template-delimiter"
			},
			{
				"text": "foo/.",
				"name": "template-link-ground template"
			},
			{
				"text": "}}",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "bar",
				"name": "link-ground link-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground template-delimiter"
			},
			{
				"text": "foo/..",
				"name": "template-link-ground template"
			},
			{
				"text": "}}",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "bar",
				"name": "link-ground link-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground template-delimiter"
			},
			{
				"text": "foo",
				"name": "template-link-ground template"
			},
			{
				"text": "~~~~",
				"name": "signature"
			},
			{
				"text": "bar",
				"name": "template-link-ground template"
			},
			{
				"text": "}}",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground template-delimiter"
			},
			{
				"text": "foo>bar",
				"name": "template-link-ground template"
			},
			{
				"text": "}}",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground template-delimiter"
			},
			{
				"text": "foo././bar",
				"name": "template-link-ground template"
			},
			{
				"text": "}}",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground template-delimiter"
			},
			{
				"text": "foo{bar",
				"name": "template-link-ground template"
			},
			{
				"text": "}}",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground template-delimiter"
			},
			{
				"text": "foo}bar",
				"name": "template-link-ground template"
			},
			{
				"text": "}}",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground template-delimiter"
			},
			{
				"text": "foo[bar",
				"name": "template-link-ground template"
			},
			{
				"text": "}}",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground template-delimiter"
			},
			{
				"text": "foo]bar",
				"name": "template-link-ground template"
			},
			{
				"text": "}}",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground template-delimiter"
			},
			{
				"text": "foo<bar",
				"name": "template-link-ground template"
			},
			{
				"text": "}}",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Disabled subpages",
		"wikitext": "[[/subpage]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "/subpage",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "T2561: {{/Subpage}}",
		"wikitext": "{{/Subpage}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "/Subpage",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Subpage with namespaces",
		"wikitext": "[[User:../subpage]]\n[[meatball:../subpage]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "User:../subpage",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "meatball:../subpage",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "T335847: Resolve forward slash title",
		"wikitext": "===123===",
		"tokens": [
			{
				"text": "===",
				"name": "section-header section--3"
			},
			{
				"text": "123",
				"name": "section"
			},
			{
				"text": "===",
				"name": "section-header"
			}
		]
	},
	{
		"desc": "T335847: Resolve subpage of control title",
		"wikitext": "[[../Hi]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "../Hi",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "T335847: Resolve subpage of forward slash title",
		"wikitext": "[[../Hi]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "../Hi",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Link to category",
		"wikitext": "[[:Category:MediaWiki User's Guide]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": ":Category:MediaWiki User's Guide",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Simple category",
		"wikitext": "[[Category:MediaWiki User's Guide]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Category:MediaWiki User's Guide",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "PAGESINCATEGORY invalid title fatal (r33546 fix)",
		"wikitext": "{{PAGESINCATEGORY:<bogus>}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "PAGESINCATEGORY",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "<bogus>",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Category with different sort key",
		"wikitext": "[[Category:MediaWiki User's Guide|Foo]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Category:MediaWiki User's Guide",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Foo",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Category with identical sort key",
		"wikitext": "[[Category:MediaWiki User's Guide|MediaWiki User's Guide]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Category:MediaWiki User's Guide",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "MediaWiki User's Guide",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Category with newline in sort key",
		"wikitext": "[[Category:Wikidata:Tools|\n*]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Category:Wikidata:Tools",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "*",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Category with template-generated sort key",
		"wikitext": "[[Category:MediaWiki User's Guide|MediaWiki {{1x|Foo}} Guide]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Category:MediaWiki User's Guide",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "MediaWiki ",
				"name": "link-ground link-text"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground template-delimiter"
			},
			{
				"text": "Foo",
				"name": "template-link-ground template"
			},
			{
				"text": "}}",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": " Guide",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Category / paragraph interactions",
		"wikitext": "Foo [[Category:Baz]] Bar\n\nFoo [[Category:Baz]]\nBar\n\nFoo\n[[Category:Baz]]\nBar\n\nFoo\n[[Category:Baz]] Bar\n\nFoo\n[[Category:Baz]]\n [[Category:Baz]]\n[[Category:Baz]]\nBar\n\n[[Category:Baz]]\n [[Category:Baz]]\n[[Category:Baz]]\n\n[[Category:Baz]]\n {{1x|[[Category:Baz]]}}\n[[Category:Baz]]",
		"tokens": [
			{
				"text": "Foo ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Category:Baz",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " BarFoo ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Category:Baz",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "BarFoo",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Category:Baz",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "BarFoo",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Category:Baz",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " BarFoo",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Category:Baz",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Category:Baz",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Category:Baz",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Bar",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Category:Baz",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Category:Baz",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Category:Baz",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Category:Baz",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "[[",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "Category:Baz",
				"name": "template-link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Category:Baz",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "1. Categories and newlines: All preceding newlines should be suppressed (courtesy T2087)",
		"wikitext": "This\n   \n[[Category:Foo]] and this should be part of same paragraph (not an indent-pre)\n   \n{{1x|[[Category:Foo]] and so should this!}}",
		"tokens": [
			{
				"text": "This",
				"name": ""
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "  ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Category:Foo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " and this should be part of same paragraph (not an indent-pre)",
				"name": ""
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "  ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "[[",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "Category:Foo",
				"name": "template-link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": " and so should this!",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "2. Categories and newlines: All preceding newlines should be suppressed (courtesy T2087)",
		"wikitext": "* This\n   \n[[Category:Foo]] and this should be part of the same list item\n* So should this\n\n{{1x|[[Category:Foo]] and this should be part of the same list item}}",
		"tokens": [
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": " This",
				"name": ""
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "  ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Category:Foo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " and this should be part of the same list item",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": " So should this",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "[[",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "Category:Foo",
				"name": "template-link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": " and this should be part of the same list item",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "No regressions on internal links following category (T174639)",
		"wikitext": "[[Category:Foo]]<div>a\n\n[[Foo]]</div>",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Category:Foo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Foo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "11. Special case where only newlines separate links (T175416)",
		"wikitext": "[[Category:Foo]]\n\n[[Foo]][[es:Alimento]]\n\n[[Foo]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Category:Foo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Foo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "es:Alimento",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Foo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Parsoid: Serialize link to category page with colon escape",
		"wikitext": "[[:Category:Foo]]\n[[:Category:Foo|Bar]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": ":Category:Foo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": ":Category:Foo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Bar",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Parsoid: Serialize link to file page with colon escape",
		"wikitext": "[[:File:Foo.png]]\n[[:File:Foo.png|Bar]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": ":File:Foo.png",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": ":File:Foo.png",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Bar",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Parsoid: Serialize a genuine category link without colon escape",
		"wikitext": "[[Category:Foo]]\n[[Category:Foo|Bar]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Category:Foo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Category:Foo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Bar",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Empty templates should be handled properly without being redlinked",
		"wikitext": "{{emptytemplate}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "emptytemplate",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Parsoid: Defaultsort variations (T236846)",
		"wikitext": "{{DEFAULTSORT}}\n\n{{DEFAULTSORT:}}\n{{DEFAULTSORT:DOGGIE}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "DEFAULTSORT",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "DEFAULTSORT",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "}}{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "DEFAULTSORT",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "DOGGIE",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Single-line or multiline-comments can follow headings",
		"wikitext": "==foo==<!---->\n==bar==<!--c1-->\n==baz==<!--\nc2\nc3-->",
		"tokens": [
			{
				"text": "==",
				"name": "section-header section--2"
			},
			{
				"text": "foo",
				"name": "section"
			},
			{
				"text": "==",
				"name": "section-header"
			},
			{
				"text": "<!---->",
				"name": "comment"
			},
			{
				"text": "==",
				"name": "section-header section--2"
			},
			{
				"text": "bar",
				"name": "section"
			},
			{
				"text": "==",
				"name": "section-header"
			},
			{
				"text": "<!--c1-->",
				"name": "comment"
			},
			{
				"text": "==",
				"name": "section-header section--2"
			},
			{
				"text": "baz",
				"name": "section"
			},
			{
				"text": "==",
				"name": "section-header"
			},
			{
				"text": "<!--c2c3-->",
				"name": "comment"
			}
		]
	},
	{
		"desc": "T3186 news: in the middle of text",
		"wikitext": "http://en.wikinews.org/wiki/Wikinews:Workplace",
		"tokens": [
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "en.wikinews.org/wiki/Wikinews:Workplace",
				"name": "free-extlink"
			}
		]
	},
	{
		"desc": "Namespaced link must have a title",
		"wikitext": "[[Project:]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Project:",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Namespaced link must have a title (bad fragment version)",
		"wikitext": "[[Project:#fragment]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Project:",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "#fragment",
				"name": "link-ground link-tosection"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "div with no attributes",
		"wikitext": "<div>HTML rocks</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "HTML rocks",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "div with double-quoted attribute",
		"wikitext": "<div id=\"rock\">HTML rocks</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "id=\"rock\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "HTML rocks",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "div with single-quoted attribute",
		"wikitext": "<div id='rock'>HTML rocks</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "id='rock'",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "HTML rocks",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "div with unquoted attribute",
		"wikitext": "<div id=rock>HTML rocks</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "id=rock",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "HTML rocks",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "div with illegal double attributes",
		"wikitext": "<div id=\"a\" id=\"b\">HTML rocks</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "id=\"a\" id=\"b\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "HTML rocks",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "div with empty attribute value, space before equals",
		"wikitext": "<div class =>HTML rocks</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "class =",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "HTML rocks",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "div with multiple empty attribute values",
		"wikitext": "<div id= title=>HTML rocks</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "id= title=",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "HTML rocks",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "table with multiple empty attribute values",
		"wikitext": "{| title= id=\n|hi\n|}",
		"tokens": [
			{
				"text": "{| ",
				"name": "table-bracket"
			},
			{
				"text": "title= id=",
				"name": "table-definition html-table"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "hi",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "div with braces in attribute value",
		"wikitext": "<div title=\"{}\">Foo</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "title=\"{}\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Foo",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "div with empty attribute value, no space before equals",
		"wikitext": "<div class=>HTML rocks</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "class=",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "HTML rocks",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "HTML multiple attributes correction",
		"wikitext": "<p class=\"error\" class=\"awesome\">Awesome!</p>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "p ",
				"name": "htmltag-name"
			},
			{
				"text": "class=\"error\" class=\"awesome\"",
				"name": "htmltag-attribute html-p"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Awesome!",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "p",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Table multiple attributes correction",
		"wikitext": "{|\n!+ class=\"error\" class=\"awesome\"|status\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "!",
				"name": "table-delimiter"
			},
			{
				"text": "+ class=\"error\" class=\"awesome\"",
				"name": "table-definition html-th"
			},
			{
				"text": "|",
				"name": "table-delimiter2"
			},
			{
				"text": "status",
				"name": "strong"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "DIV IN UPPERCASE",
		"wikitext": "<DIV ID=\"x\">HTML ROCKS</DIV>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "DIV ",
				"name": "htmltag-name"
			},
			{
				"text": "ID=\"x\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "HTML ROCKS",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "DIV",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Non-ASCII pseudo-tags are rendered as text",
		"wikitext": "<khy√¥>",
		"tokens": [
			{
				"text": "<khy√¥>",
				"name": ""
			}
		]
	},
	{
		"desc": "Pseudo-tag with URL 'name' renders as url link",
		"wikitext": "<http://example.com/>",
		"tokens": [
			{
				"text": "<",
				"name": ""
			},
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com/",
				"name": "free-extlink"
			},
			{
				"text": ">",
				"name": ""
			}
		]
	},
	{
		"desc": "text with amp in the middle of nowhere",
		"wikitext": "Remember AT&T?",
		"tokens": [
			{
				"text": "Remember AT&T?",
				"name": ""
			}
		]
	},
	{
		"desc": "text with character entity: eacute",
		"wikitext": "I always thought &eacute; was a cute letter.",
		"tokens": [
			{
				"text": "I always thought ",
				"name": ""
			},
			{
				"text": "&eacute;",
				"name": "entity"
			},
			{
				"text": " was a cute letter.",
				"name": ""
			}
		]
	},
	{
		"desc": "text with entity-escaped character entity-like string: eacute",
		"wikitext": "I always thought &amp;eacute; was a cute letter.",
		"tokens": [
			{
				"text": "I always thought ",
				"name": ""
			},
			{
				"text": "&amp;",
				"name": "entity"
			},
			{
				"text": "eacute; was a cute letter.",
				"name": ""
			}
		]
	},
	{
		"desc": "text with undefined character entity: xacute",
		"wikitext": "I always thought &xacute; was a cute letter.",
		"tokens": [
			{
				"text": "I always thought ",
				"name": ""
			},
			{
				"text": "&xacute;",
				"name": "entity"
			},
			{
				"text": " was a cute letter.",
				"name": ""
			}
		]
	},
	{
		"desc": "Text with HTML5 semicolon-less entity (should not decode)",
		"wikitext": "&ampamp;",
		"tokens": [
			{
				"text": "&ampamp;",
				"name": "entity"
			}
		]
	},
	{
		"desc": "HTML5 tags",
		"wikitext": "<data value=\"5\">five</data>\n<time datetime=\"2000-01-01T00:00Z\">The new millenium started</time>\n<mark>This highlighted text</mark>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "data ",
				"name": "htmltag-name"
			},
			{
				"text": "value=\"5\"",
				"name": "htmltag-attribute html-data"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "five",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "data",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "time ",
				"name": "htmltag-name"
			},
			{
				"text": "datetime=\"2000-01-01T00:00Z\"",
				"name": "htmltag-attribute html-time"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "The new millenium started",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "time",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "mark",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "This highlighted text",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "mark",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "HTML tag with leading space is parsed as text",
		"wikitext": "< div>foo< /div>",
		"tokens": [
			{
				"text": "< div>foo< /div>",
				"name": ""
			}
		]
	},
	{
		"desc": "Element with broken attribute syntax",
		"wikitext": "<div style=\" style=\"123\">hi</div>\n<div =>ho</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "style=\" style=\"123\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "hi",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "=",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "ho",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Ensure that HTML adoption agency algorithm is properly implemented.",
		"wikitext": "<small>X<small>Y</small>Z</small>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "small",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "X",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "small",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Y",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "small",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Z",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "small",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Nesting of <kbd>",
		"wikitext": "<kbd>X<kbd>Y</kbd>Z</kbd>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "kbd",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "X",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "kbd",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Y",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "kbd",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Z",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "kbd",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Nesting of <em>",
		"wikitext": "<em>X<em>Y</em>Z</em>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "em",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "X",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "em",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Y",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "em",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Z",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "em",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Nesting of <strong>",
		"wikitext": "<strong>X<strong>Y</strong>Z</strong>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "strong",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "X",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "strong",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Y",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "strong",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Z",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "strong",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Nesting of <q>",
		"wikitext": "<q>X<q>Y</q>Z</q>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "q",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "X",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "q",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Y",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "q",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Z",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "q",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Nesting of <ruby>",
		"wikitext": "<ruby>X<ruby>Y</ruby>Z</ruby>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "ruby",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "X",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "ruby",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Y",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "ruby",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Z",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "ruby",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Nesting of <bdo>",
		"wikitext": "<bdo>X<bdo>Y</bdo>Z</bdo>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "bdo",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "X",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "bdo",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Y",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "bdo",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Z",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "bdo",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Media link",
		"wikitext": "[[Media:Foobar.jpg]]\n[[Media:Video.ogv]]\n[[:Media:Video.ogv]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Media:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Media:Video.ogv",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": ":Media:Video.ogv",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Media link with text",
		"wikitext": "[[Media:Foobar.jpg|A neat file to look at]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Media:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "A neat file to look at",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Media link redirect",
		"wikitext": "[[Media:Redirect to foobar.jpg]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Media:Redirect to foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Media link with nasty text",
		"wikitext": "[[Media:Foobar.jpg|Safe Link<div style=display:none>\" onmouseover=\"alert(document.cookie)\" onfoo=\"</div>]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Media:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Safe Link",
				"name": "link-ground link-text"
			},
			{
				"text": "<",
				"name": "link-ground htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "link-ground htmltag-name"
			},
			{
				"text": "style=display:none",
				"name": "link-ground htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "link-ground htmltag-bracket"
			},
			{
				"text": "\" onmouseover=\"alert(document.cookie)\" onfoo=\"",
				"name": "link-ground link-text"
			},
			{
				"text": "</",
				"name": "link-ground htmltag-bracket"
			},
			{
				"text": "div",
				"name": "link-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "link-ground htmltag-bracket"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Media link to nonexistent file (T3702)",
		"wikitext": "[[Media:No such.jpg]]\n[[Media:No_such file.jpg]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Media:No such.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Media:No_such file.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Media link with nested wikilinks",
		"wikitext": "[[Media:Foobar.jpg|[[Test]]]]\n[[Media:Foobar.jpg|[[File:Foobar.jpg]]]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Media:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Test",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "]]",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Media:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "]]",
				"name": ""
			}
		]
	},
	{
		"desc": "Character reference normalization in link text (T3938)",
		"wikitext": "[[Main Page|this&that]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "this&that",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "(T21451) Links should refer to the normalized form.",
		"wikitext": "[[&#xFB2E;]]\n[[&#x5d0;&#x5b7;]]\n[[&#x5d0;÷∑]]\n[[◊ê&#x5b7;]]\n[[◊ê÷∑]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "&",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "#xFB2E;",
				"name": "link-ground link-tosection"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "&",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "#x5d0;&#x5b7;",
				"name": "link-ground link-tosection"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "&",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "#x5d0;÷∑",
				"name": "link-ground link-tosection"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "◊ê&",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "#x5b7;",
				"name": "link-ground link-tosection"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "◊ê÷∑",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Empty attribute crash test (T4067)",
		"wikitext": "<font color=\"\">foo</font>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "font ",
				"name": "htmltag-name"
			},
			{
				"text": "color=\"\"",
				"name": "htmltag-attribute html-font"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "font",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Empty attribute crash test single-quotes (T4067)",
		"wikitext": "<font color=''>foo</font>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "font ",
				"name": "htmltag-name"
			},
			{
				"text": "color=",
				"name": "htmltag-attribute html-font"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "foo",
				"name": "em"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "font",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Attribute test: equals, then nothing",
		"wikitext": "<font color=>foo</font>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "font ",
				"name": "htmltag-name"
			},
			{
				"text": "color=",
				"name": "htmltag-attribute html-font"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "font",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Attribute test: unquoted value",
		"wikitext": "<font color=x>foo</font>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "font ",
				"name": "htmltag-name"
			},
			{
				"text": "color=x",
				"name": "htmltag-attribute html-font"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "font",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Attribute test: unquoted but illegal value (hash)",
		"wikitext": "<font color=#x>foo</font>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "font ",
				"name": "htmltag-name"
			},
			{
				"text": "color=#x",
				"name": "htmltag-attribute html-font"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "font",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Attribute test: no value (T54330)",
		"wikitext": "<font color>foo</font>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "font ",
				"name": "htmltag-name"
			},
			{
				"text": "color",
				"name": "htmltag-attribute html-font"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "font",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "T4095: link with three closing brackets",
		"wikitext": "[[Main Page]]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "]",
				"name": ""
			}
		]
	},
	{
		"desc": "T4095: link with pipe and three closing brackets",
		"wikitext": "[[Main Page|link]]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "]",
				"name": ""
			}
		]
	},
	{
		"desc": "T4095: link with pipe and three closing brackets, version 2",
		"wikitext": "[[Main Page|[http://example.com/]]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "[http://example.com/]",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "T4304: HTML attribute safety (safe template; regression T4309)",
		"wikitext": "<div title=\"{{test}}\"></div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "title=\"{{test}}\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "T4304: HTML attribute safety (dangerous template; 2309)",
		"wikitext": "<div title=\"{{dangerous attribute}}\"></div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "title=\"{{dangerous attribute}}\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "T4304: HTML attribute safety (dangerous style template; 2309)",
		"wikitext": "<div style=\"{{dangerous style attribute}}\"></div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "style=\"{{dangerous style attribute}}\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "T4304: HTML attribute safety (safe parameter; 2309)",
		"wikitext": "{{div style|width: 200px}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "div style",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "width: 200px",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "T4304: HTML attribute safety (unsafe parameter; 2309)",
		"wikitext": "{{div style|width: expression(alert(document.cookie))}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "div style",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "width: expression(alert(document.cookie))",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "T4304: HTML attribute safety (unsafe breakout parameter; 2309)",
		"wikitext": "{{div style|\"><script>alert(document.cookie)</script>}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "div style",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "\"><script>alert(document.cookie)</script>",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "T4304: HTML attribute safety (unsafe breakout parameter 2; 2309)",
		"wikitext": "{{div style|\" ><script>alert(document.cookie)</script>}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "div style",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "\" ><script>alert(document.cookie)</script>",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "T4304: HTML attribute safety (link)",
		"wikitext": "<div title=\"[[Main Page]]\"></div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "title=\"[[Main Page]]\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "T4304: HTML attribute safety (italics)",
		"wikitext": "<div title=\"''foobar''\"></div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "title=\"''foobar''\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "T4304: HTML attribute safety (bold)",
		"wikitext": "<div title=\"'''foobar'''\"></div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "title=\"'''foobar'''\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "T4304: HTML attribute safety (ISBN)",
		"wikitext": "<div title=\"ISBN 1234567890\"></div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "title=\"ISBN 1234567890\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "T4304: HTML attribute safety (RFC)",
		"wikitext": "<div title=\"RFC 1234\"></div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "title=\"RFC 1234\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "T4304: HTML attribute safety (PMID)",
		"wikitext": "<div title=\"PMID 1234567890\"></div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "title=\"PMID 1234567890\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "T4304: HTML attribute safety (web link)",
		"wikitext": "<div title=\"http://example.com/\"></div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "title=\"http://example.com/\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "T4304: HTML attribute safety (named web link)",
		"wikitext": "<div title=\"[http://example.com/ link]\"></div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "title=\"[http://example.com/ link]\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "T5244: HTML attribute safety (extension; safe)",
		"wikitext": "<div style=\"<nowiki>background:blue</nowiki>\"></div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "style=\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "background:blue",
				"name": "tag-nowiki"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "\">",
				"name": ""
			},
			{
				"text": "</div>",
				"name": "error"
			}
		]
	},
	{
		"desc": "T5244: HTML attribute safety (extension; unsafe)",
		"wikitext": "<div style=\"<nowiki>border-left:expression(alert(document.cookie))</nowiki>\"></div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "style=\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "border-left:expression(alert(document.cookie))",
				"name": "tag-nowiki"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "\">",
				"name": ""
			},
			{
				"text": "</div>",
				"name": "error"
			}
		]
	},
	{
		"desc": "MSIE CSS safety test: spurious slash",
		"wikitext": "<div style=\"background-image:u\\rl(javascript:alert('boo'))\">evil</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "style=\"background-image:u\\rl(javascript:alert('boo'))\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "evil",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "MSIE CSS safety test: hex code",
		"wikitext": "<div style=\"background-image:u\\72l(javascript:alert('boo'))\">evil</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "style=\"background-image:u\\72l(javascript:alert('boo'))\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "evil",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "MSIE CSS safety test: comment in url",
		"wikitext": "<div style=\"background-image:u/**/rl(javascript:alert('boo'))\">evil</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "style=\"background-image:u/**/rl(javascript:alert('boo'))\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "evil",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "MSIE CSS safety test: comment in expression",
		"wikitext": "<div style=\"background-image:expres/**/sion(alert('boo4'))\">evil4</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "style=\"background-image:expres/**/sion(alert('boo4'))\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "evil4",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "CSS safety test (all browsers): vertical tab (T57332 / CVE-2013-4567)",
		"wikitext": "<p style=\"font-size: 100px; background-image:url\\b(https://www.google.com/images/srpr/logo6w.png)\">A</p>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "p ",
				"name": "htmltag-name"
			},
			{
				"text": "style=\"font-size: 100px; background-image:url\\b(https://www.google.com/images/srpr/logo6w.png)\"",
				"name": "htmltag-attribute html-p"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "A",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "p",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Opera -o-link CSS",
		"wikitext": "<div\ntitle=\"&#100;&#97;&#116;&#97;&#58;&#116;&#101;&#120;&#116;&#47;&#104;&#116;&#109;&#108;&#44;&#60;&#105;&#109;&#103;&#32;&#115;&#114;&#99;&#61;&#49;&#32;&#111;&#110;&#101;&#114;&#114;&#111;&#114;&#61;&#97;&#108;&#101;&#114;&#116;&#40;&#49;&#41;&#62;\"\nstyle=\"-o-link:attr(title);-o-link-source:current\">X</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": "title=\"&#100;&#97;&#116;&#97;&#58;&#116;&#101;&#120;&#116;&#47;&#104;&#116;&#109;&#108;&#44;&#60;&#105;&#109;&#103;&#32;&#115;&#114;&#99;&#61;&#49;&#32;&#111;&#110;&#101;&#114;&#114;&#111;&#114;&#61;&#97;&#108;&#101;&#114;&#116;&#40;&#49;&#41;&#62;\"style=\"-o-link:attr(title);-o-link-source:current\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "X",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Table attribute legitimate extension",
		"wikitext": "{|\n!+ style=\"<nowiki>color:blue</nowiki>\"|status\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "!",
				"name": "table-delimiter"
			},
			{
				"text": "+ style=\"",
				"name": "table-definition html-th"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "color:blue",
				"name": "tag-nowiki"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "\"",
				"name": "table-definition html-th"
			},
			{
				"text": "|",
				"name": "table-delimiter2"
			},
			{
				"text": "status",
				"name": "strong"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Table attribute safety",
		"wikitext": "{|\n!+ style=\"<nowiki>border-width:expression(0+alert(document.cookie))</nowiki>\"|status\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "!",
				"name": "table-delimiter"
			},
			{
				"text": "+ style=\"",
				"name": "table-definition html-th"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "border-width:expression(0+alert(document.cookie))",
				"name": "tag-nowiki"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "\"",
				"name": "table-definition html-th"
			},
			{
				"text": "|",
				"name": "table-delimiter2"
			},
			{
				"text": "status",
				"name": "strong"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "CSS line continuation 1",
		"wikitext": "<div style=\"background-image: u\\&#10;rl(test.jpg);\"></div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "style=\"background-image: u\\&#10;rl(test.jpg);\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "CSS line continuation 2",
		"wikitext": "<div style=\"background-image: u\\&#13;rl(test.jpg); \"></div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "style=\"background-image: u\\&#13;rl(test.jpg); \"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Allow aria attributes",
		"wikitext": "<span aria-describedby=\"id1\" aria-flowto=\"id2\" aria-hidden=\"true\" aria-label=\"id3\" aria-labelledby=\"id4\" aria-level=\"3\" aria-owns=\"id5\">foo</span>\n<span aria-bogus=\"stripped\">bar</span>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "span ",
				"name": "htmltag-name"
			},
			{
				"text": "aria-describedby=\"id1\" aria-flowto=\"id2\" aria-hidden=\"true\" aria-label=\"id3\" aria-labelledby=\"id4\" aria-level=\"3\" aria-owns=\"id5\"",
				"name": "htmltag-attribute html-span"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "span",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "span ",
				"name": "htmltag-name"
			},
			{
				"text": "aria-bogus=\"stripped\"",
				"name": "htmltag-attribute html-span"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "bar",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "span",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Expansion of multi-line templates in attribute values (T8255)",
		"wikitext": "<div style=\"background: {{1x|#00FF00}}\">-</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "style=\"background: {{1x|#00FF00}}\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "-",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Expansion of multi-line templates in attribute values (T8255 check)",
		"wikitext": "<div style=\"background:\n#00FF00\">-</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "style=\"background:",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": "#",
				"name": "list"
			},
			{
				"text": "00FF00\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "-",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Expansion of multi-line templates in attribute values (T8255 check 2)",
		"wikitext": "<div style=\"background: &#10;#00FF00\">-</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "style=\"background: &#10;#00FF00\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "-",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Tags which are hidden from tidiers cannot pass through the Sanitizer",
		"wikitext": "<mw:editsection><script>alert();</script></mw:editsection>\n\n<meta property=\"mw:PageProp/toc\" />",
		"tokens": [
			{
				"text": "<mw:editsection><script>alert();</script></mw:editsection>",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "meta ",
				"name": "htmltag-name"
			},
			{
				"text": "property=\"mw:PageProp/toc\" ",
				"name": "htmltag-attribute html-meta"
			},
			{
				"text": "/>",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Nested template calls",
		"wikitext": "{{Map-one-parameter|One-parameter|param}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "Map-one-parameter",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "One-parameter",
				"name": "template-ground template"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "param",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Sanitizer: Closing of open tags",
		"wikitext": "<s></s><table></table>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "s",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "s",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Sanitizer: Closing of open but not closed tags",
		"wikitext": "<s>foo",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "s",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "foo",
				"name": ""
			}
		]
	},
	{
		"desc": "Sanitizer: Closing of closed but not open tags",
		"wikitext": "</s>",
		"tokens": [
			{
				"text": "</s>",
				"name": "error"
			}
		]
	},
	{
		"desc": "Sanitizer: Closing of closed but not open table tags",
		"wikitext": "Table not started</td></tr></table>",
		"tokens": [
			{
				"text": "Table not started",
				"name": ""
			},
			{
				"text": "</td></tr></table>",
				"name": "error"
			}
		]
	},
	{
		"desc": "Sanitizer: Escaping of spaces, multibyte characters, colons & other stuff in id=\"\"",
		"wikitext": "<span id=\"√¶: v\">byte</span>[[#√¶: v|backlink]]",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "span ",
				"name": "htmltag-name"
			},
			{
				"text": "id=\"√¶: v\"",
				"name": "htmltag-attribute html-span"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "byte",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "span",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "#√¶: v",
				"name": "link-ground link-tosection"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "backlink",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Sanitizer: Escaping of spaces, multibyte characters, colons & other stuff in id=\"\" (legacy)",
		"wikitext": "<span id=\"√¶: v\">byte</span>[[#√¶: v|backlink]]",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "span ",
				"name": "htmltag-name"
			},
			{
				"text": "id=\"√¶: v\"",
				"name": "htmltag-attribute html-span"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "byte",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "span",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "#√¶: v",
				"name": "link-ground link-tosection"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "backlink",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Sanitizer: Validating that <meta> and <link> work, but only for Microdata",
		"wikitext": "<div itemscope>\n\t<meta itemprop=\"hello\" content=\"world\">\n\t<meta http-equiv=\"refresh\" content=\"5\">\n\t<meta itemprop=\"hello\" http-equiv=\"refresh\" content=\"5\">\n\t<link itemprop=\"hello\" href=\"{{SERVER}}\">\n\t<link rel=\"stylesheet\" href=\"{{SERVER}}\">\n\t<link rel=\"stylesheet\" itemprop=\"hello\" href=\"{{SERVER}}\">\n</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "itemscope",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "\t",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "meta ",
				"name": "htmltag-name"
			},
			{
				"text": "itemprop=\"hello\" content=\"world\"",
				"name": "htmltag-attribute html-meta"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "\t",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "meta ",
				"name": "htmltag-name"
			},
			{
				"text": "http-equiv=\"refresh\" content=\"5\"",
				"name": "htmltag-attribute html-meta"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "\t",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "meta ",
				"name": "htmltag-name"
			},
			{
				"text": "itemprop=\"hello\" http-equiv=\"refresh\" content=\"5\"",
				"name": "htmltag-attribute html-meta"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "\t",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "link ",
				"name": "htmltag-name"
			},
			{
				"text": "itemprop=\"hello\" href=\"{{SERVER}}\"",
				"name": "htmltag-attribute html-link"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "\t",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "link ",
				"name": "htmltag-name"
			},
			{
				"text": "rel=\"stylesheet\" href=\"{{SERVER}}\"",
				"name": "htmltag-attribute html-link"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "\t",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "link ",
				"name": "htmltag-name"
			},
			{
				"text": "rel=\"stylesheet\" itemprop=\"hello\" href=\"{{SERVER}}\"",
				"name": "htmltag-attribute html-link"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Sanitizer: Strip comments from CSS attributes",
		"wikitext": "<span style=\"margin:/*negate mbox-text padding */-0.125em -0.45em; /*rainbow*/rgba(255, 0, 0, 0.3)\">2013</span>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "span ",
				"name": "htmltag-name"
			},
			{
				"text": "style=\"margin:/*negate mbox-text padding */-0.125em -0.45em; /*rainbow*/rgba(255, 0, 0, 0.3)\"",
				"name": "htmltag-attribute html-span"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "2013",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "span",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Sanitizer: Avoid unnecessary percent encoded characters in interwiki links",
		"wikitext": "[[meatball:Soft\"Security]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "meatball:Soft\"Security",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Sanitizer: angle brackets are invalid, even in interwiki links (T182338)",
		"wikitext": "[[meatball:Foo<Bar]]\n[[meatball:Foo>Bar]]\n[[meatball:Foo&lt;bar]]\n[[meatball:Foo&gt;bar]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "meatball:Foo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "<",
				"name": "link-ground error"
			},
			{
				"text": "Bar",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "meatball:Foo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": ">",
				"name": "link-ground error"
			},
			{
				"text": "Bar",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "meatball:Foo&lt;bar",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "meatball:Foo&gt;bar",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Self closed html pairs (T7487)",
		"wikitext": "<center><font id=\"bug\" />Centered text</center>\n<div><font id=\"bug2\" />In div text</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "center",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "font ",
				"name": "htmltag-name"
			},
			{
				"text": "id=\"bug\" ",
				"name": "htmltag-attribute html-font"
			},
			{
				"text": "/>",
				"name": "htmltag-bracket"
			},
			{
				"text": "Centered text",
				"name": ""
			},
			{
				"text": "</center>",
				"name": "error"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "font ",
				"name": "htmltag-name"
			},
			{
				"text": "id=\"bug2\" ",
				"name": "htmltag-attribute html-font"
			},
			{
				"text": "/>",
				"name": "htmltag-bracket"
			},
			{
				"text": "In div text",
				"name": ""
			},
			{
				"text": "</div>",
				"name": "error"
			}
		]
	},
	{
		"desc": "Punctuation: nbsp before exclamation",
		"wikitext": "C'est grave !",
		"tokens": [
			{
				"text": "C'est grave !",
				"name": ""
			}
		]
	},
	{
		"desc": "Punctuation: CSS !important (T13874)",
		"wikitext": "<div style=\"width:50% !important\">important</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "style=\"width:50% !important\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "important",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Punctuation: CSS ! important (T13874; with space after)",
		"wikitext": "<div style=\"width:50% ! important\">important</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "style=\"width:50% ! important\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "important",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "HTML bullet list, closed tags (T7497)",
		"wikitext": "<ul>\n<li>One</li>\n<li>Two</li>\n</ul>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "ul",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "One",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Two",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "ul",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "HTML bullet list, unclosed tags (T7497)",
		"wikitext": "<ul>\n<li>One\n<li>Two\n</ul>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "ul",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "One",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Two",
				"name": ""
			},
			{
				"text": "</ul>",
				"name": "error"
			}
		]
	},
	{
		"desc": "HTML ordered list, closed tags (T7497)",
		"wikitext": "<ol>\n<li>One</li>\n<li>Two</li>\n</ol>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "ol",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "One",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Two",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "ol",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "HTML ordered list, unclosed tags (T7497)",
		"wikitext": "<ol>\n<li>One\n<li>Two\n</ol>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "ol",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "One",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Two",
				"name": ""
			},
			{
				"text": "</ol>",
				"name": "error"
			}
		]
	},
	{
		"desc": "HTML nested bullet list, closed tags (T7497)",
		"wikitext": "<ul>\n<li>One</li>\n<li>Two:\n<ul>\n<li>Sub-one</li>\n<li>Sub-two</li>\n</ul>\n</li>\n</ul>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "ul",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "One",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Two:",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "ul",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Sub-one",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Sub-two",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "ul",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "ul",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "HTML nested bullet list, open tags (T7497)",
		"wikitext": "<ul>\n<li>One\n<li>Two:\n<ul>\n<li>Sub-one\n<li>Sub-two\n</ul>\n</ul>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "ul",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "One",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Two:",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "ul",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Sub-one",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Sub-two",
				"name": ""
			},
			{
				"text": "</ul></ul>",
				"name": "error"
			}
		]
	},
	{
		"desc": "HTML nested ordered list, closed tags (T7497)",
		"wikitext": "<ol>\n<li>One</li>\n<li>Two:\n<ol>\n<li>Sub-one</li>\n<li>Sub-two</li>\n</ol>\n</li>\n</ol>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "ol",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "One",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Two:",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "ol",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Sub-one",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Sub-two",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "ol",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "ol",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "HTML nested ordered list, open tags (T7497)",
		"wikitext": "<ol>\n<li>One\n<li>Two:\n<ol>\n<li>Sub-one\n<li>Sub-two\n</ol>\n</ol>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "ol",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "One",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Two:",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "ol",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Sub-one",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Sub-two",
				"name": ""
			},
			{
				"text": "</ol></ol>",
				"name": "error"
			}
		]
	},
	{
		"desc": "HTML ordered list item with parameters oddity",
		"wikitext": "<ol><li id=\"fragment\">One</li>\n</ol>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "ol",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "li ",
				"name": "htmltag-name"
			},
			{
				"text": "id=\"fragment\"",
				"name": "htmltag-attribute html-li"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "One",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "ol",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "T7918: autonumbering",
		"wikitext": "[http://first/] [http://second] [ftp://ftp]\n\nftp://inlineftp\n\n[mailto:enclosed@mail.tld With target]\n\n[mailto:enclosed@mail.tld]\n\nmailto:inline@mail.tld",
		"tokens": [
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "first/",
				"name": "link-ground extlink"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "second",
				"name": "link-ground extlink"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "ftp://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "ftp",
				"name": "link-ground extlink"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "ftp://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "inlineftp",
				"name": "free-extlink"
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "mailto:",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "enclosed@mail.tld",
				"name": "link-ground extlink"
			},
			{
				"text": " With target",
				"name": "link-ground extlink-text"
			},
			{
				"text": "][",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "mailto:",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "enclosed@mail.tld",
				"name": "link-ground extlink"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "mailto:",
				"name": "free-extlink-protocol"
			},
			{
				"text": "inline@mail.tld",
				"name": "free-extlink"
			}
		]
	},
	{
		"desc": "Fuzz testing: Parser13",
		"wikitext": "{| \n| http://a|",
		"tokens": [
			{
				"text": "{| ",
				"name": "table-bracket"
			},
			{
				"text": "| ",
				"name": "table-delimiter"
			},
			{
				"text": "http://a",
				"name": "table-definition html-td"
			},
			{
				"text": "|",
				"name": "table-delimiter2"
			}
		]
	},
	{
		"desc": "Fuzz testing: Parser14",
		"wikitext": "==onmouseover===\nhttp://__TOC__",
		"tokens": [
			{
				"text": "==",
				"name": "section-header section--2"
			},
			{
				"text": "onmouseover=",
				"name": "section"
			},
			{
				"text": "==",
				"name": "section-header"
			},
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "__TOC__",
				"name": "free-extlink"
			}
		]
	},
	{
		"desc": "Fuzz testing: Parser14-table",
		"wikitext": "==a==\n{| STYLE=__TOC__",
		"tokens": [
			{
				"text": "==",
				"name": "section-header section--2"
			},
			{
				"text": "a",
				"name": "section"
			},
			{
				"text": "==",
				"name": "section-header"
			},
			{
				"text": "{| ",
				"name": "table-bracket"
			},
			{
				"text": "STYLE=__TOC__",
				"name": "table-definition html-table"
			}
		]
	},
	{
		"desc": "Fuzz testing: Parser16",
		"wikitext": "{|\n!https://||||||",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "!",
				"name": "table-delimiter"
			},
			{
				"text": "https://",
				"name": "strong"
			},
			{
				"text": "||||||",
				"name": "table-delimiter"
			}
		]
	},
	{
		"desc": "Fuzz testing: Parser21",
		"wikitext": "{|\n!irc://{{ftp://a\" onmouseover=\"alert('hello world');\"\n|",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "!",
				"name": "table-delimiter"
			},
			{
				"text": "irc://",
				"name": "strong"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "ftp://a\" onmouseover=\"alert('hello world');\"",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			}
		]
	},
	{
		"desc": "Fuzz testing: Parser22",
		"wikitext": "http://===r:::https://b\n\n{|",
		"tokens": [
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "===r:::https://b",
				"name": "free-extlink"
			},
			{
				"text": "{|",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Fuzz testing: Parser24 (minimized)",
		"wikitext": "{{<u {{{{[[Sx-->}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "<",
				"name": "template-ground error"
			},
			{
				"text": "u ",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "{{",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "{{",
				"name": "template3-ground template-bracket"
			},
			{
				"text": "[[",
				"name": "template3-ground error"
			},
			{
				"text": "Sx--",
				"name": "template3-ground template-name pagename"
			},
			{
				"text": ">",
				"name": "template3-ground error"
			},
			{
				"text": "}}",
				"name": "template3-ground template-bracket"
			}
		]
	},
	{
		"desc": "Fuzz testing: Parser24",
		"wikitext": "{|\n{{{|\n<u CLASS=\n| {{{{SSSll!!!!!!!VVVV)]]][[Special:*xxxxxxx--><noinclude>}}}} >\n<br style=\"onmouseover='alert(document.cookie);' \" />\n\nMOVE YOUR MOUSE CURSOR OVER THIS TEXT\n|",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "{{{",
				"name": "templatevariable-bracket"
			},
			{
				"text": "|",
				"name": "templatevariable-delimiter"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "u ",
				"name": "htmltag-name"
			},
			{
				"text": "CLASS=| ",
				"name": "htmltag-attribute html-u"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "{{",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "SSSll!!!!!!!VVVV)",
				"name": "template2-ground template-name pagename"
			},
			{
				"text": "]]][[",
				"name": "template2-ground error"
			},
			{
				"text": "Special:*xxxxxxx--",
				"name": "template2-ground template-name pagename"
			},
			{
				"text": "><",
				"name": "template2-ground error"
			},
			{
				"text": "noinclude",
				"name": "template2-ground template-name pagename"
			},
			{
				"text": ">",
				"name": "template2-ground error"
			},
			{
				"text": "}}",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": " ",
				"name": "htmltag-attribute html-u"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "br ",
				"name": "htmltag-name"
			},
			{
				"text": "style=\"onmouseover='alert(document.cookie);' \" ",
				"name": "htmltag-attribute html-br"
			},
			{
				"text": "/>",
				"name": "htmltag-bracket"
			},
			{
				"text": "MOVE YOUR MOUSE CURSOR OVER THIS TEXT",
				"name": "templatevariable"
			},
			{
				"text": "|",
				"name": "templatevariable-delimiter"
			}
		]
	},
	{
		"desc": "Fuzz testing: Parser25 (T8055)",
		"wikitext": "{{{\n| \n<LI CLASS=||\n >\n}}}blah\" onmouseover=\"alert('hello world');\" align=\"left\"'''MOVE MOUSE CURSOR OVER HERE",
		"tokens": [
			{
				"text": "{{{",
				"name": "templatevariable-bracket"
			},
			{
				"text": "|",
				"name": "templatevariable-delimiter"
			},
			{
				"text": " ",
				"name": "templatevariable"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "LI ",
				"name": "htmltag-name"
			},
			{
				"text": "CLASS=||",
				"name": "htmltag-attribute html-li"
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "}}}",
				"name": "templatevariable-bracket"
			},
			{
				"text": "blah\" onmouseover=\"alert('hello world');\" align=\"left\"",
				"name": ""
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "MOVE MOUSE CURSOR OVER HERE",
				"name": "strong"
			}
		]
	},
	{
		"desc": "Fuzz testing: URL adjacent extension (with space, clean)",
		"wikitext": "http://example.com <nowiki>junk</nowiki>",
		"tokens": [
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com",
				"name": "free-extlink"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "junk",
				"name": "tag-nowiki"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Fuzz testing: URL adjacent extension (no space, dirty; nowiki)",
		"wikitext": "http://example.com<nowiki>junk</nowiki>",
		"tokens": [
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com",
				"name": "free-extlink"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "junk",
				"name": "tag-nowiki"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Fuzz testing: URL adjacent extension (no space, dirty; pre)",
		"wikitext": "http://example.com<pre>junk</pre>",
		"tokens": [
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com",
				"name": "free-extlink"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "junk",
				"name": "tag-pre"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Fuzz testing: encoded newline in generated HTML replacements (T8577)",
		"wikitext": "<pre dir=\"&#10;\"></pre>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "pre ",
				"name": "exttag-name"
			},
			{
				"text": "dir=\"&#10;\"",
				"name": "exttag-attribute ext-pre"
			},
			{
				"text": "></",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Templates in extension attributes are not expanded",
		"wikitext": "<pre dir=\"{{1x|ltr}}\"></pre>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "pre ",
				"name": "exttag-name"
			},
			{
				"text": "dir=\"{{1x|ltr}}\"",
				"name": "exttag-attribute ext-pre"
			},
			{
				"text": "></",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Parsing optional HTML elements (T8171)",
		"wikitext": "<table>\n  <tr>\n    <td> Some tabular data</td>\n    <td> More tabular data ...\n    <td> And yet som tabular data</td>\n  </tr>\n</table>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "tr",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "   ",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " Some tabular data",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "   ",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " More tabular data ...",
				"name": ""
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "   ",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " And yet som tabular data",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "</tr></table>",
				"name": "error"
			}
		]
	},
	{
		"desc": "Correct handling of <td>, <tr> (T8171)",
		"wikitext": "<table>\n  <tr>\n    <td> Some tabular data</td>\n    <td> More tabular data ...</td>\n    <td> And yet som tabular data</td>\n  </tr>\n</table>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "tr",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "   ",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " Some tabular data",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "   ",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " More tabular data ...",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "   ",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " And yet som tabular data",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "tr",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Parsing crashing regression (fr:JavaScript)",
		"wikitext": "</body></x>",
		"tokens": [
			{
				"text": "</body></x>",
				"name": ""
			}
		]
	},
	{
		"desc": "Inline wiki vs wiki block nesting",
		"wikitext": "'''Bold paragraph\n\nNew wiki paragraph",
		"tokens": [
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "Bold paragraph",
				"name": "strong"
			},
			{
				"text": "New wiki paragraph",
				"name": ""
			}
		]
	},
	{
		"desc": "Inline HTML vs wiki block nesting",
		"wikitext": "<b>Bold paragraph\n\nNew wiki paragraph",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "b",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Bold paragraphNew wiki paragraph",
				"name": ""
			}
		]
	},
	{
		"desc": "Mixing markup for italics and bold",
		"wikitext": "'''bold''''''bold''bolditalics'''''",
		"tokens": [
			{
				"text": "'",
				"name": ""
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "bold'",
				"name": "em"
			},
			{
				"text": "'''''",
				"name": "apostrophes"
			},
			{
				"text": "bold",
				"name": "strong"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "bolditalics",
				"name": "strong em"
			},
			{
				"text": "'''''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Special page transclusion",
		"wikitext": "{{Special:Prefixindex/Xyzzyx}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "Special:Prefixindex/Xyzzyx",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Special page transclusion twice (T7021)",
		"wikitext": "{{Special:Prefixindex/Xyzzyx}}\n{{Special:Prefixindex/Xyzzyx}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "Special:Prefixindex/Xyzzyx",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "Special:Prefixindex/Xyzzyx",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Transclusion of default MediaWiki message",
		"wikitext": "{{MediaWiki:Mainpage}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "MediaWiki:Mainpage",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Transclusion of nonexistent MediaWiki message",
		"wikitext": "{{MediaWiki:Mainpagexxx}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "MediaWiki:Mainpagexxx",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Transclusion of MediaWiki message with underscore",
		"wikitext": "{{MediaWiki:history_short}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "MediaWiki:history_short",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Transclusion of MediaWiki message with space",
		"wikitext": "{{MediaWiki:history short}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "MediaWiki:history short",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Invalid header with following text",
		"wikitext": "= x = y",
		"tokens": [
			{
				"text": "= x = y",
				"name": ""
			}
		]
	},
	{
		"desc": "Handling of &#x0A; in URLs",
		"wikitext": "*irc://&#x0A;a",
		"tokens": [
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "irc://",
				"name": ""
			},
			{
				"text": "&#x0A;",
				"name": "entity"
			},
			{
				"text": "a",
				"name": ""
			}
		]
	},
	{
		"desc": "Handling of %0A in URLs",
		"wikitext": "*irc://%0Aa",
		"tokens": [
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "irc://%0Aa",
				"name": ""
			}
		]
	},
	{
		"desc": "5 quotes, code coverage +1 line",
		"wikitext": "'''''",
		"tokens": [
			{
				"text": "'''''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Special:Search page linking.",
		"wikitext": "{{Special:search}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "Special:search",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "{{!}} is a magic word",
		"wikitext": "{{!}} is a magic word there and {{!}} is still a magic word here\n| is not a magic word here but {{!}} is still a magic word here",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "!",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": " is a magic word there and ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "!",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": " is still a magic word here| is not a magic word here but ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "!",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": " is still a magic word here",
				"name": ""
			}
		]
	},
	{
		"desc": "Single {{!}} in table cell",
		"wikitext": "{|\n| colspan=\"1\" |foo {{!}} bar\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "| ",
				"name": "table-delimiter"
			},
			{
				"text": "colspan=\"1\" ",
				"name": "table-definition html-td"
			},
			{
				"text": "|",
				"name": "table-delimiter2"
			},
			{
				"text": "foo ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "!",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": " bar",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Using {{!}} in wikilinks (T290526)",
		"wikitext": "[[Main Page{{!}}Something else]]\n\n[[{{T290526}}]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "{{",
				"name": "ext-link-ground parserfunction-bracket"
			},
			{
				"text": "!",
				"name": "ext-link-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-link-ground parserfunction-bracket"
			},
			{
				"text": "Something else",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "T290526",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Using {{!}} in template arguments (T290526)",
		"wikitext": "{{1x|Main Page{{!}}Something else}}\n\n{{1x|{{T290526}}}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "Main Page",
				"name": "template-ground template"
			},
			{
				"text": "{{",
				"name": "template-ext-ground parserfunction-bracket"
			},
			{
				"text": "!",
				"name": "template-ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "template-ext-ground parserfunction-bracket"
			},
			{
				"text": "Something else",
				"name": "template-ground template"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "{{",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "T290526",
				"name": "template2-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Using {{!}} in template arguments, part 2 (T290526)",
		"wikitext": "{{ Main Page|Something else }}\n\n{{ {{T290526}} }}",
		"tokens": [
			{
				"text": "{{ ",
				"name": "template-ground template-bracket"
			},
			{
				"text": "Main Page",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "Something else ",
				"name": "template-ground template"
			},
			{
				"text": "}}{{ ",
				"name": "template-ground template-bracket"
			},
			{
				"text": "{{",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "T290526",
				"name": "template2-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template2-ground template-bracket"
			},
			{
				"text": " }}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Say the magic word",
		"wikitext": "*{{PAGENAME}}\n*{{PAGENAMEE}}\n*{{FULLPAGENAME}}\n*{{FULLPAGENAMEE}}\n*{{BASEPAGENAME}}\n*{{BASEPAGENAMEE}}\n*{{SUBPAGENAME}}\n*{{SUBPAGENAMEE}}\n*{{ROOTPAGENAME}}\n*{{ROOTPAGENAMEE}}\n*{{TALKPAGENAME}}\n*{{TALKPAGENAMEE}}\n*{{SUBJECTPAGENAME}}\n*{{SUBJECTPAGENAMEE}}\n*{{NAMESPACEE}}\n*{{NAMESPACE}}\n*{{NAMESPACENUMBER}}\n*{{TALKSPACE}}\n*{{TALKSPACEE}}\n*{{SUBJECTSPACE}}\n*{{SUBJECTSPACEE}}\n*{{Dynamic|{{NUMBEROFUSERS}}|{{NUMBEROFPAGES}}|{{CURRENTVERSION}}|{{CONTENTLANGUAGE}}|{{DIRECTIONMARK}}|{{CURRENTTIMESTAMP}}|{{NUMBEROFARTICLES}}}}",
		"tokens": [
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "PAGENAME",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "PAGENAMEE",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "FULLPAGENAME",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "FULLPAGENAMEE",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "BASEPAGENAME",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "BASEPAGENAMEE",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "SUBPAGENAME",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "SUBPAGENAMEE",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "ROOTPAGENAME",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "ROOTPAGENAMEE",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "TALKPAGENAME",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "TALKPAGENAMEE",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "SUBJECTPAGENAME",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "SUBJECTPAGENAMEE",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "NAMESPACEE",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "NAMESPACE",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "NAMESPACENUMBER",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "TALKSPACE",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "TALKSPACEE",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "SUBJECTSPACE",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "SUBJECTSPACEE",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "Dynamic",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "{{",
				"name": "template-ext-ground parserfunction-bracket"
			},
			{
				"text": "NUMBEROFUSERS",
				"name": "template-ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "template-ext-ground parserfunction-bracket"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "{{",
				"name": "template-ext-ground parserfunction-bracket"
			},
			{
				"text": "NUMBEROFPAGES",
				"name": "template-ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "template-ext-ground parserfunction-bracket"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "{{",
				"name": "template-ext-ground parserfunction-bracket"
			},
			{
				"text": "CURRENTVERSION",
				"name": "template-ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "template-ext-ground parserfunction-bracket"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "{{",
				"name": "template-ext-ground parserfunction-bracket"
			},
			{
				"text": "CONTENTLANGUAGE",
				"name": "template-ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "template-ext-ground parserfunction-bracket"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "{{",
				"name": "template-ext-ground parserfunction-bracket"
			},
			{
				"text": "DIRECTIONMARK",
				"name": "template-ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "template-ext-ground parserfunction-bracket"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "{{",
				"name": "template-ext-ground parserfunction-bracket"
			},
			{
				"text": "CURRENTTIMESTAMP",
				"name": "template-ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "template-ext-ground parserfunction-bracket"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "{{",
				"name": "template-ext-ground parserfunction-bracket"
			},
			{
				"text": "NUMBEROFARTICLES",
				"name": "template-ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "template-ext-ground parserfunction-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "HTML Hex character encoding (spells the word \"JavaScript\")",
		"wikitext": "&#x4A;&#x061;&#x0076;&#x00061;&#x000053;&#x0000063;&#114;&#x0000069;&#00000112;&#x0000000074;",
		"tokens": [
			{
				"text": "&#x4A;&#x061;&#x0076;&#x00061;&#x000053;&#x0000063;&#114;&#x0000069;&#00000112;&#x0000000074;",
				"name": "entity"
			}
		]
	},
	{
		"desc": "HTML Hex character encoding bogus encoding (T28437 regression check)",
		"wikitext": "&#xsee;&#XSEE;",
		"tokens": [
			{
				"text": "&#xsee;&#XSEE;",
				"name": ""
			}
		]
	},
	{
		"desc": "HTML Hex character encoding mixed case",
		"wikitext": "&#xEE;&#Xee;",
		"tokens": [
			{
				"text": "&#xEE;&#Xee;",
				"name": "entity"
			}
		]
	},
	{
		"desc": "ISBN code coverage",
		"wikitext": "ISBN  978-0-1234-56&#x20;789",
		"tokens": [
			{
				"text": "ISBN  978-0-1234-56",
				"name": ""
			},
			{
				"text": "&#x20;",
				"name": "entity"
			},
			{
				"text": "789",
				"name": ""
			}
		]
	},
	{
		"desc": "ISBN followed by 5 spaces",
		"wikitext": "ISBN",
		"tokens": [
			{
				"text": "ISBN",
				"name": ""
			}
		]
	},
	{
		"desc": "Double ISBN",
		"wikitext": "ISBN ISBN 1234567890",
		"tokens": [
			{
				"text": "ISBN ISBN 1234567890",
				"name": ""
			}
		]
	},
	{
		"desc": "ISBN with an X",
		"wikitext": "ISBN 3-462-04561-X\nISBN 3-462-04561-x\nISBN 080442957X\nISBN 080442957x\nISBN 978080442957X\nISBN 978080442957x",
		"tokens": [
			{
				"text": "ISBN 3-462-04561-XISBN 3-462-04561-xISBN 080442957XISBN 080442957xISBN 978080442957XISBN 978080442957x",
				"name": ""
			}
		]
	},
	{
		"desc": "ISBN with empty prefix (parsoid test)",
		"wikitext": "ISBN 1234567890",
		"tokens": [
			{
				"text": "ISBN 1234567890",
				"name": ""
			}
		]
	},
	{
		"desc": "T24905: <abbr> followed by ISBN followed by </a>",
		"wikitext": "<abbr>(fr)</abbr> ISBN 2753300917 [http://www.example.com example.com]",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "abbr",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "(fr)",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "abbr",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " ISBN 2753300917 ",
				"name": ""
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "www.example.com",
				"name": "link-ground extlink"
			},
			{
				"text": " example.com",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "Double RFC",
		"wikitext": "RFC RFC 1234",
		"tokens": [
			{
				"text": "RFC RFC 1234",
				"name": ""
			}
		]
	},
	{
		"desc": "Double RFC with a wiki link",
		"wikitext": "RFC [[RFC 1234]]",
		"tokens": [
			{
				"text": "RFC ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "RFC 1234",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "RFC code coverage",
		"wikitext": "RFC   983&#x20;987",
		"tokens": [
			{
				"text": "RFC   983",
				"name": ""
			},
			{
				"text": "&#x20;",
				"name": "entity"
			},
			{
				"text": "987",
				"name": ""
			}
		]
	},
	{
		"desc": "Another italics / bold test",
		"wikitext": " ''' ''x'",
		"tokens": [
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "'",
				"name": ""
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": " ",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "x'",
				"name": ""
			}
		]
	},
	{
		"desc": "dt/dd/dl test",
		"wikitext": ":;;;::",
		"tokens": [
			{
				"text": ":;;;::",
				"name": "list"
			}
		]
	},
	{
		"desc": "[Before] HTML without raw HTML enabled ($wgRawHtml==false)",
		"wikitext": "<html><script>alert(1);</script></html>",
		"tokens": [
			{
				"text": "<html><script>alert(1);</script></html>",
				"name": ""
			}
		]
	},
	{
		"desc": "Parents of subpages, one level up",
		"wikitext": "[[../|L2]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "../",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "L2",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Parents of subpages, one level up, not named",
		"wikitext": "[[../]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "../",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Parents of subpages, two levels up",
		"wikitext": "[[../../|L1]]2\n\n[[../../|L1]]l",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "../../",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "L1",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "2",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "../../",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "L1",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "l",
				"name": ""
			}
		]
	},
	{
		"desc": "Parents of subpages, two levels up, without trailing slash or name.",
		"wikitext": "[[../..]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "../..",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Parents of subpages, two levels up, with lots of extra trailing slashes.",
		"wikitext": "[[../../////]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "../../////",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Transclusion of a sibling page (one level up)",
		"wikitext": "{{../L3Sibling}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "../L3Sibling",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Transclusion of a child page",
		"wikitext": "{{/L3Sibling}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "/L3Sibling",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Non-transclusion because of too many up levels",
		"wikitext": "{{../../../../More than parent}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "../../../../More than parent",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Definition list code coverage",
		"wikitext": ";title   :def\n;title :def\n;title:def",
		"tokens": [
			{
				"text": ";",
				"name": "list"
			},
			{
				"text": "title   ",
				"name": "strong"
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "def",
				"name": ""
			},
			{
				"text": ";",
				"name": "list"
			},
			{
				"text": "title ",
				"name": "strong"
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "def",
				"name": ""
			},
			{
				"text": ";",
				"name": "list"
			},
			{
				"text": "title",
				"name": "strong"
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "def",
				"name": ""
			}
		]
	},
	{
		"desc": "Don't fall for the self-closing div",
		"wikitext": "<div>hello world</div/>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "hello world",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": "/",
				"name": "error"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "MSGNW magic word",
		"wikitext": "{{MSGNW:msg}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "MSGNW",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "msg",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "RAW magic word",
		"wikitext": "{{RAW:QUERTY}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "RAW",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "QUERTY",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Always escape literal '>' in output, not just after '<'",
		"wikitext": "><>",
		"tokens": [
			{
				"text": "><>",
				"name": ""
			}
		]
	},
	{
		"desc": "Template caching",
		"wikitext": "{{Test}}\n{{Test}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "Test",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "Test",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Inclusion of !userCanEdit() content",
		"wikitext": "{{MediaWiki:Fake}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "MediaWiki:Fake",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "ISBN with a dummy number",
		"wikitext": "ISBN ---",
		"tokens": [
			{
				"text": "ISBN ---",
				"name": ""
			}
		]
	},
	{
		"desc": "ISBN with space-delimited number",
		"wikitext": "ISBN 92 9017 032 8",
		"tokens": [
			{
				"text": "ISBN 92 9017 032 8",
				"name": ""
			}
		]
	},
	{
		"desc": "ISBN with multiple spaces, no number",
		"wikitext": "ISBN  foo",
		"tokens": [
			{
				"text": "ISBN  foo",
				"name": ""
			}
		]
	},
	{
		"desc": "ISBN length",
		"wikitext": "ISBN 123456789\n\nISBN 1234567890\n\nISBN 12345678901",
		"tokens": [
			{
				"text": "ISBN 123456789ISBN 1234567890ISBN 12345678901",
				"name": ""
			}
		]
	},
	{
		"desc": "ISBN with trailing year (T9110)",
		"wikitext": "ISBN 1-234-56789-0 - 2006\n\nISBN 1 234 56789 0 - 2006",
		"tokens": [
			{
				"text": "ISBN 1-234-56789-0 - 2006ISBN 1 234 56789 0 - 2006",
				"name": ""
			}
		]
	},
	{
		"desc": "anchorencode",
		"wikitext": "{{anchorencode:foo bar¬©#%n}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "anchorencode",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "foo bar¬©#%n",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "anchorencode (legacy)",
		"wikitext": "{{anchorencode:foo bar¬©#%n}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "anchorencode",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "foo bar¬©#%n",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "anchorencode trims spaces",
		"wikitext": "{{anchorencode: __pretty__please__}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "anchorencode",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": " __pretty__please__",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "anchorencode deals with links",
		"wikitext": "{{anchorencode: [[hello|world]] [[hi]]}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "anchorencode",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": " ",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "[[",
				"name": "ext-link-ground link-bracket"
			},
			{
				"text": "hello",
				"name": "ext-link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "ext-link-ground link-delimiter"
			},
			{
				"text": "world",
				"name": "ext-link-ground link-text"
			},
			{
				"text": "]]",
				"name": "ext-link-ground link-bracket"
			},
			{
				"text": " ",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "[[",
				"name": "ext-link-ground link-bracket"
			},
			{
				"text": "hi",
				"name": "ext-link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "ext-link-ground link-bracket"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "anchorencode deals with templates",
		"wikitext": "{{anchorencode: {{Foo}} x}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "anchorencode",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": " ",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "{{",
				"name": "template-ext-ground template-bracket"
			},
			{
				"text": "Foo",
				"name": "template-ext-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ext-ground template-bracket"
			},
			{
				"text": " x",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "anchorencode encodes like the TOC generator: (T20431)",
		"wikitext": "===_ +:.3A%3A _ &&amp;]] x===\n{{anchorencode: _ +:.3A%3A _ &&amp;]] x}}\n\n__NOEDITSECTION__",
		"tokens": [
			{
				"text": "===",
				"name": "section-header section--3"
			},
			{
				"text": "_ +:.3A%3A _ &",
				"name": "section"
			},
			{
				"text": "&amp;",
				"name": "entity"
			},
			{
				"text": "]] x",
				"name": "section"
			},
			{
				"text": "===",
				"name": "section-header"
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "anchorencode",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": " _ +:.3A%3A _ &",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "&amp;",
				"name": "ext-ground entity"
			},
			{
				"text": "]] x",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "__NOEDITSECTION__",
				"name": "double-underscore"
			}
		]
	},
	{
		"desc": "anchorencode encodes like the TOC generator: (T20431) (legacy)",
		"wikitext": "===_ +:.3A%3A&&amp;]]===\n{{anchorencode: _ +:.3A%3A&&amp;]] }}\n__NOEDITSECTION__",
		"tokens": [
			{
				"text": "===",
				"name": "section-header section--3"
			},
			{
				"text": "_ +:.3A%3A&",
				"name": "section"
			},
			{
				"text": "&amp;",
				"name": "entity"
			},
			{
				"text": "]]",
				"name": "section"
			},
			{
				"text": "===",
				"name": "section-header"
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "anchorencode",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": " _ +:.3A%3A&",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "&amp;",
				"name": "ext-ground entity"
			},
			{
				"text": "]] ",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "__NOEDITSECTION__",
				"name": "double-underscore"
			}
		]
	},
	{
		"desc": "T8200: blockquotes and paragraph formatting",
		"wikitext": "<blockquote>\nfoo\n</blockquote>\n\nbar\n\n baz",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "blockquote",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "blockquote",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "bar",
				"name": ""
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "baz",
				"name": ""
			}
		]
	},
	{
		"desc": "T10293: Use of center tag ruins paragraph formatting",
		"wikitext": "<center>\nfoo\n</center>\n\nbar\n\n baz",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "center",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "center",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "bar",
				"name": ""
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "baz",
				"name": ""
			}
		]
	},
	{
		"desc": "Parsing of overlapping (improperly nested) inline html tags",
		"wikitext": "<span><s>x</span></s>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "span",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "s",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "x",
				"name": ""
			},
			{
				"text": "</span>",
				"name": "error"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "s",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "T2529: Uncovered bullet",
		"wikitext": "*Foo {{bullet}}",
		"tokens": [
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "Foo ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "bullet",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "T2529: Uncovered bullet in a deeply nested list",
		"wikitext": "*******Foo {{bullet}}",
		"tokens": [
			{
				"text": "*******",
				"name": "list"
			},
			{
				"text": "Foo ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "bullet",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "T2529: Uncovered table already at line-start",
		"wikitext": "x\n\n{{table}}\ny",
		"tokens": [
			{
				"text": "x",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "table",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "y",
				"name": ""
			}
		]
	},
	{
		"desc": "T2529: Uncovered bullet in parser function result",
		"wikitext": "*Foo{{lc:{{bullet}} }}",
		"tokens": [
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "Foo",
				"name": ""
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "lc",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "{{",
				"name": "template-ext-ground template-bracket"
			},
			{
				"text": "bullet",
				"name": "template-ext-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ext-ground template-bracket"
			},
			{
				"text": " ",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "T7678: Double-parsed template argument",
		"wikitext": "{{lc:{{{1}}}|hello}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "lc",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "{{{",
				"name": "ext-ground templatevariable-bracket"
			},
			{
				"text": "1",
				"name": "ext-ground templatevariable-name"
			},
			{
				"text": "}}}",
				"name": "ext-ground templatevariable-bracket"
			},
			{
				"text": "|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "hello",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "T7678: Double-parsed template invocation",
		"wikitext": "{{lc:{{paramtest {{!}} param = hello }} }}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "lc",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "{{",
				"name": "template-ext-ground template-bracket"
			},
			{
				"text": "paramtest ",
				"name": "template-ext-ground template-name pagename"
			},
			{
				"text": "{{",
				"name": "template-ext2-ground parserfunction-bracket"
			},
			{
				"text": "!",
				"name": "template-ext2-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "template-ext2-ground parserfunction-bracket"
			},
			{
				"text": " param = hello ",
				"name": "template-ext-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ext-ground template-bracket"
			},
			{
				"text": " ",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Morwen/13: Unclosed link followed by heading",
		"wikitext": "[[link\n==heading==",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "link",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "==",
				"name": "section-header section--2"
			},
			{
				"text": "heading",
				"name": "section"
			},
			{
				"text": "==",
				"name": "section-header"
			}
		]
	},
	{
		"desc": "HHP2.1: Heuristics for headings in preprocessor parenthetical structures",
		"wikitext": "{{foo|\n=heading=",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "foo",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "=",
				"name": "template-ground template-argument-name"
			},
			{
				"text": "heading=",
				"name": "template-ground template"
			}
		]
	},
	{
		"desc": "HHP2.2: Heuristics for headings in preprocessor parenthetical structures",
		"wikitext": "{{foo|\n==heading==",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "foo",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "=",
				"name": "template-ground template-argument-name"
			},
			{
				"text": "=heading==",
				"name": "template-ground template"
			}
		]
	},
	{
		"desc": "Paragraphs inside divs (no extra line breaks)",
		"wikitext": "<div>Line one\n\nLine two</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Line oneLine two",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Paragraphs inside divs (extra line break on open)",
		"wikitext": "<div>\nLine one\n\nLine two</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Line oneLine two",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Paragraphs inside divs (extra line break on close)",
		"wikitext": "<div>Line one\n\nLine two\n</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Line oneLine two",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Paragraphs inside divs (extra line break on open and close)",
		"wikitext": "<div>\nLine one\n\nLine two\n</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Line oneLine two",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Nesting tags, paragraphs on lines which begin with <div>",
		"wikitext": "<div></div><strong>A\nB</strong>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "strong",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "AB",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "strong",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "T8200: paragraphs inside blockquotes (no extra line breaks)",
		"wikitext": "<blockquote>Line one\n\nLine two</blockquote>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "blockquote",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Line oneLine two",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "blockquote",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "T8200: paragraphs inside blockquotes (extra line break on open)",
		"wikitext": "<blockquote>\nLine one\n\nLine two</blockquote>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "blockquote",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Line oneLine two",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "blockquote",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "T8200: paragraphs inside blockquotes (extra line break on close)",
		"wikitext": "<blockquote>Line one\n\nLine two\n</blockquote>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "blockquote",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Line oneLine two",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "blockquote",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "T8200: paragraphs inside blockquotes (extra line break on open and close)",
		"wikitext": "<blockquote>\nLine one\n\nLine two\n</blockquote>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "blockquote",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Line oneLine two",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "blockquote",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Paragraphs inside blockquotes/divs (no extra line breaks)",
		"wikitext": "<blockquote><div>Line one\n\nLine two</div></blockquote>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "blockquote",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Line oneLine two",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "blockquote",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Paragraphs inside blockquotes/divs (extra line break on open)",
		"wikitext": "<blockquote><div>\nLine one\n\nLine two</div></blockquote>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "blockquote",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Line oneLine two",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "blockquote",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Paragraphs inside blockquotes/divs (extra line break on close)",
		"wikitext": "<blockquote><div>Line one\n\nLine two\n</div></blockquote>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "blockquote",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Line oneLine two",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "blockquote",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Paragraphs inside blockquotes/divs (extra line break on open and close)",
		"wikitext": "<blockquote><div>\nLine one\n\nLine two\n</div></blockquote>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "blockquote",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Line oneLine two",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "blockquote",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Multibyte character in padleft",
		"wikitext": "{{padleft:-Hello|7|√Ü}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "padleft",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "-Hello",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "7",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "√Ü",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Multibyte character in padright",
		"wikitext": "{{padright:Hello-|7|√Ü}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "padright",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "Hello-",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "7",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "√Ü",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "formatdate parser function",
		"wikitext": "{{#formatdate:2009-03-24}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "#formatdate",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "2009-03-24",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "formatdate parser function, with default format",
		"wikitext": "{{#formatdate:2009-03-24|mdy}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "#formatdate",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "2009-03-24",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "mdy",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Spacing of numbers in formatted dates",
		"wikitext": "{{#formatdate:January 15}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "#formatdate",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "January 15",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "formatdate with invalid month",
		"wikitext": "{{#formatdate:2019-22-22|dmy}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "#formatdate",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "2019-22-22",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "dmy",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "formatdate uses correct capitalisation in English",
		"wikitext": "{{#formatdate:june 3|dmy}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "#formatdate",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "june 3",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "dmy",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "formatdate formats ISO year 0 as 1 BC",
		"wikitext": "{{#formatdate:-0001-12-31|mdy}}\n{{#formatdate:0000-12-31|mdy}}\n{{#formatdate:0001-12-31|mdy}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "#formatdate",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "-0001-12-31",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "mdy",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "#formatdate",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "0000-12-31",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "mdy",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "#formatdate",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "0001-12-31",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "mdy",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Anchor starting with underscore",
		"wikitext": "[[#_ref|One]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "#_ref",
				"name": "link-ground link-tosection"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "One",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Id starting with underscore",
		"wikitext": "<div id=\"_ref\"></div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "id=\"_ref\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Play a bit with r67090 and T5158",
		"wikitext": "<div style=\"width:50% !important\">&nbsp;</div>\n<div style=\"width:50%&nbsp;!important\">&nbsp;</div>\n<div style=\"width:50%&#160;!important\">&nbsp;</div>\n<div style=\"border : solid;\">&nbsp;</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "style=\"width:50% !important\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "&nbsp;",
				"name": "entity"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "style=\"width:50%&nbsp;!important\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "&nbsp;",
				"name": "entity"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "style=\"width:50%&#160;!important\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "&nbsp;",
				"name": "entity"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "style=\"border : solid;\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "&nbsp;",
				"name": "entity"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "French spaces in wikitext",
		"wikitext": "foo ! bar ? bat 50 % is less than 75 %.\n\nHello : this ; is ¬´ something ‚Äπ else ‚Ä∫ again ¬ª",
		"tokens": [
			{
				"text": "foo ! bar ? bat 50 % is less than 75 %.Hello : this ; is ¬´ something ‚Äπ else ‚Ä∫ again ¬ª",
				"name": ""
			}
		]
	},
	{
		"desc": "Corner case: french spaces in definition list",
		"wikitext": ";foo : bar",
		"tokens": [
			{
				"text": ";",
				"name": "list"
			},
			{
				"text": "foo ",
				"name": "strong"
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": " bar",
				"name": ""
			}
		]
	},
	{
		"desc": "T5158: Test for French spaces in attributes",
		"wikitext": "<br style=\" clear : both ; \" />",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "br ",
				"name": "htmltag-name"
			},
			{
				"text": "style=\" clear : both ; \" ",
				"name": "htmltag-attribute html-br"
			},
			{
				"text": "/>",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "HTML5 data attributes",
		"wikitext": "<span data-foo=\"bar\">Baz</span>\n<p data-abc-def_hij=\"\">Quuz</p>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "span ",
				"name": "htmltag-name"
			},
			{
				"text": "data-foo=\"bar\"",
				"name": "htmltag-attribute html-span"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Baz",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "span",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "p ",
				"name": "htmltag-name"
			},
			{
				"text": "data-abc-def_hij=\"\"",
				"name": "htmltag-attribute html-p"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Quuz",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "p",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Strip reserved data attributes",
		"wikitext": "<div data-mw=\"foo\" data-parsoid=\"bar\" data-mw-someext=\"baz\" data-ok=\"fred\" data-object-id=\"123\" data-ooui=\"xyzzy\" data-bad:ns=\"ns\">d</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "data-mw=\"foo\" data-parsoid=\"bar\" data-mw-someext=\"baz\" data-ok=\"fred\" data-object-id=\"123\" data-ooui=\"xyzzy\" data-bad:ns=\"ns\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "d",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "percent-encoding and + signs in internal links (T28410)",
		"wikitext": "[[User:+%]] [[Page+title%]]\n[[%+]] [[%+|%20]] [[%+ ]] [[%+r]]\n[[%]] [[+]] [[File:%+abc%39|foo|[[bar]]]]\n[[%33%45]] [[%33%45+]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "User:+%",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Page+title%",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "%+",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "%+",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "%20",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "%+ ",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "%+r",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "%",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "+",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:%+abc%39",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "foo",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "bar",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "%33%45",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "%33%45+",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Confirm that 'apos' named character reference doesn't make it to output (not legal in HTML 4)",
		"wikitext": "Text&apos;s been normalized?",
		"tokens": [
			{
				"text": "Text",
				"name": ""
			},
			{
				"text": "&apos;",
				"name": "entity"
			},
			{
				"text": "s been normalized?",
				"name": ""
			}
		]
	},
	{
		"desc": "T21052 U+3000 IDEOGRAPHIC SPACE should terminate free external links",
		"wikitext": "http://www.example.org/„ÄÄ<-- U+3000 (vim: ^Vu3000)",
		"tokens": [
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "www.example.org/",
				"name": "free-extlink"
			},
			{
				"text": "„ÄÄ<-- U+3000 (vim: ^Vu3000)",
				"name": ""
			}
		]
	},
	{
		"desc": "T21052 U+3000 IDEOGRAPHIC SPACE should terminate bracketed external links",
		"wikitext": "[http://www.example.org/„ÄÄideograms]",
		"tokens": [
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "www.example.org/",
				"name": "link-ground extlink"
			},
			{
				"text": "„ÄÄideograms",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "T21052 U+3000 IDEOGRAPHIC SPACE should terminate external images links",
		"wikitext": "http://www.example.org/pic.png„ÄÄ<-- U+3000 (vim: ^Vu3000)",
		"tokens": [
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "www.example.org/pic.png",
				"name": "free-extlink"
			},
			{
				"text": "„ÄÄ<-- U+3000 (vim: ^Vu3000)",
				"name": ""
			}
		]
	},
	{
		"desc": "T33098 Template which includes system messages which includes the template",
		"wikitext": "{{Identical}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "Identical",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "T34057: Title needed when expanding <h> nodes.",
		"wikitext": "{{int:T34057}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "int",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "T34057",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Title needed when expanding templates.",
		"wikitext": "{{Template with pagename}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "Template with pagename",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Strip marker in urlencode",
		"wikitext": "{{urlencode:x<nowiki/>y}}\n{{urlencode:x<nowiki/>y|wiki}}\n{{urlencode:x<nowiki/>y|path}}\n{{urlencode:x<pre id=\"one\">two</pre>y}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "urlencode",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "x",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "<",
				"name": "ext-ground exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "ext-ground exttag-name"
			},
			{
				"text": "/>",
				"name": "ext-ground exttag-bracket"
			},
			{
				"text": "y",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "urlencode",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "x",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "<",
				"name": "ext-ground exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "ext-ground exttag-name"
			},
			{
				"text": "/>",
				"name": "ext-ground exttag-bracket"
			},
			{
				"text": "y",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "wiki",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "urlencode",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "x",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "<",
				"name": "ext-ground exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "ext-ground exttag-name"
			},
			{
				"text": "/>",
				"name": "ext-ground exttag-bracket"
			},
			{
				"text": "y",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "path",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "urlencode",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "x",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "<",
				"name": "ext-ground exttag-bracket"
			},
			{
				"text": "pre ",
				"name": "ext-ground exttag-name"
			},
			{
				"text": "id=\"one\"",
				"name": "ext-ground exttag-attribute ext-pre"
			},
			{
				"text": ">",
				"name": "ext-ground exttag-bracket"
			},
			{
				"text": "two",
				"name": "tag-pre"
			},
			{
				"text": "</",
				"name": "ext-ground exttag-bracket"
			},
			{
				"text": "pre",
				"name": "ext-ground exttag-name"
			},
			{
				"text": ">",
				"name": "ext-ground exttag-bracket"
			},
			{
				"text": "y",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Strip marker in lc",
		"wikitext": "{{lc:x<nowiki/>y}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "lc",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "x",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "<",
				"name": "ext-ground exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "ext-ground exttag-name"
			},
			{
				"text": "/>",
				"name": "ext-ground exttag-bracket"
			},
			{
				"text": "y",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Strip marker in uc",
		"wikitext": "{{uc:x<nowiki/>y}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "uc",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "x",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "<",
				"name": "ext-ground exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "ext-ground exttag-name"
			},
			{
				"text": "/>",
				"name": "ext-ground exttag-bracket"
			},
			{
				"text": "y",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Strip marker in formatNum",
		"wikitext": "{{formatnum:1<nowiki/>2}}\n{{formatnum:1<nowiki/>2|R}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "formatnum",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "1",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "<",
				"name": "ext-ground exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "ext-ground exttag-name"
			},
			{
				"text": "/>",
				"name": "ext-ground exttag-bracket"
			},
			{
				"text": "2",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "formatnum",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "1",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "<",
				"name": "ext-ground exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "ext-ground exttag-name"
			},
			{
				"text": "/>",
				"name": "ext-ground exttag-bracket"
			},
			{
				"text": "2",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "R",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Wrong option for formatNum (T58199)",
		"wikitext": "{{formatnum:1,234.56|Random}}\n{{formatnum:1,234.56|EVERYTHING}}\n{{formatnum:1234.56|any argument that has the string 'NOSEP'}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "formatnum",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "1,234.56",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "Random",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "formatnum",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "1,234.56",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "EVERYTHING",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "formatnum",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "1234.56",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "any argument that has the string 'NOSEP'",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Strip marker in padleft",
		"wikitext": "{{padleft:|2|x<nowiki/>y}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "padleft",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "2",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "x",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "<",
				"name": "ext-ground exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "ext-ground exttag-name"
			},
			{
				"text": "/>",
				"name": "ext-ground exttag-bracket"
			},
			{
				"text": "y",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Strip marker in padright",
		"wikitext": "{{padright:|2|x<nowiki/>y}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "padright",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "2",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "x",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "<",
				"name": "ext-ground exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "ext-ground exttag-name"
			},
			{
				"text": "/>",
				"name": "ext-ground exttag-bracket"
			},
			{
				"text": "y",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Strip marker in anchorencode",
		"wikitext": "{{anchorencode:x<nowiki/>y}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "anchorencode",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "x",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "<",
				"name": "ext-ground exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "ext-ground exttag-name"
			},
			{
				"text": "/>",
				"name": "ext-ground exttag-bracket"
			},
			{
				"text": "y",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "nowiki inside link inside heading (T20295)",
		"wikitext": "==[[foo|x<nowiki>y</nowiki>z]]==",
		"tokens": [
			{
				"text": "==",
				"name": "section-header section--2"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "foo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "x",
				"name": "link-ground link-text"
			},
			{
				"text": "<",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "link-ground exttag-name"
			},
			{
				"text": ">",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": "y",
				"name": "tag-nowiki"
			},
			{
				"text": "</",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "link-ground exttag-name"
			},
			{
				"text": ">",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": "z",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "==",
				"name": "section-header"
			}
		]
	},
	{
		"desc": "new support for bdi element (T33817)",
		"wikitext": "<p dir=\"rtl\" lang=\"he\">◊ï◊ú◊ì◊ô◊û◊ô◊® ◊ú◊†◊ô◊ü (◊ë◊®◊ï◊°◊ô◊™: <bdi lang=\"ru\">–í–ª–∞–¥–∏–º–∏—Ä –õ–µ–Ω–∏–Ω</bdi>, 24 ◊ë◊ê◊§◊®◊ô◊ú 1870‚Äì22 ◊ë◊ô◊†◊ï◊ê◊® 1924) ◊î◊ï◊ê ◊û◊†◊î◊ô◊í ◊§◊ï◊ú◊ô◊ò◊ô ◊ß◊ï◊û◊ï◊†◊ô◊°◊ò◊ô ◊®◊ï◊°◊ô.</p>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "p ",
				"name": "htmltag-name"
			},
			{
				"text": "dir=\"rtl\" lang=\"he\"",
				"name": "htmltag-attribute html-p"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "◊ï◊ú◊ì◊ô◊û◊ô◊® ◊ú◊†◊ô◊ü (◊ë◊®◊ï◊°◊ô◊™: ",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "bdi ",
				"name": "htmltag-name"
			},
			{
				"text": "lang=\"ru\"",
				"name": "htmltag-attribute html-bdi"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "–í–ª–∞–¥–∏–º–∏—Ä –õ–µ–Ω–∏–Ω",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "bdi",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": ", 24 ◊ë◊ê◊§◊®◊ô◊ú 1870‚Äì22 ◊ë◊ô◊†◊ï◊ê◊® 1924) ◊î◊ï◊ê ◊û◊†◊î◊ô◊í ◊§◊ï◊ú◊ô◊ò◊ô ◊ß◊ï◊û◊ï◊†◊ô◊°◊ò◊ô ◊®◊ï◊°◊ô.",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "p",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Ignore pipe between table row attributes",
		"wikitext": "{|\n|quux\n|- id=foo | style='color: red'\n|bar\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "quux",
				"name": ""
			},
			{
				"text": "|- ",
				"name": "table-delimiter"
			},
			{
				"text": "id=foo | style='color: red'",
				"name": "table-definition html-tr"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "bar",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Language parser function",
		"wikitext": "{{#language:ar}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "#language",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "ar",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Padleft and padright (default 0-padding)",
		"wikitext": "{{padleft:xyz|5}}\n{{padright:xyz|5}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "padleft",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "xyz",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "5",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "padright",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "xyz",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "5",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Padleft and padright (partial fill)",
		"wikitext": "{{padleft:xyz|6|ab}}\n{{padright:xyz|6|ab}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "padleft",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "xyz",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "6",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "ab",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "padright",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "xyz",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "6",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "ab",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Padleft and padright as substr",
		"wikitext": "{{padleft:|3|abcde}}\n{{padright:|3|abcde}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "padleft",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "3",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "abcde",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "padright",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "3",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "abcde",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Padleft and padright with non-numerical length (T180403)",
		"wikitext": "{{padleft:abcdef|junk}}\n{{padright:abcdef|junk}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "padleft",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "abcdef",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "junk",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "padright",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "abcdef",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "junk",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Special parser function",
		"wikitext": "{{#special:RandomPage}}\n{{#special:BaDtItLe}}\n{{#special:Foobar}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "#special",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "RandomPage",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "#special",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "BaDtItLe",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "#special",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "Foobar",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Using {{=}} when it expands to \"=\" should not create a tracking category",
		"wikitext": "This uses {{=}} and {{Template:=}}.",
		"tokens": [
			{
				"text": "This uses ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "=",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": " and ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "Template:=",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": ".",
				"name": ""
			}
		]
	},
	{
		"desc": "Using {{=}} when it expands to \"=\" should not create a tracking category (cat)",
		"wikitext": "This uses {{=}} and {{Template:=}}.",
		"tokens": [
			{
				"text": "This uses ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "=",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": " and ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "Template:=",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": ".",
				"name": ""
			}
		]
	},
	{
		"desc": "T36939 - Case insensitive link parsing ([HttP://])",
		"wikitext": "[HttP://MediaWiki.Org/]",
		"tokens": [
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "HttP://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "MediaWiki.Org/",
				"name": "link-ground extlink"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "T36939 - Case insensitive link parsing ([HttP:// title])",
		"wikitext": "[HttP://MediaWiki.Org/ MediaWiki]",
		"tokens": [
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "HttP://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "MediaWiki.Org/",
				"name": "link-ground extlink"
			},
			{
				"text": " MediaWiki",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "T36939 - Case insensitive link parsing (HttP://)",
		"wikitext": "HttP://MediaWiki.Org/",
		"tokens": [
			{
				"text": "HttP://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "MediaWiki.Org/",
				"name": "free-extlink"
			}
		]
	},
	{
		"desc": "1. SOL-sensitive wikitext tokens as template-args",
		"wikitext": "{{1x|*a}}\n{{1x|#a}}\n{{1x|:a}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "*a",
				"name": "template-ground template"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "#a",
				"name": "template-ground template"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": ":a",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "\nTag-like HTML structures are passed through as text",
		"wikitext": "<x y>\n\n<x.y>\n\n<x-y>\n\n1>2\n\nx<y\n\na>b\n\n1<d e>f",
		"tokens": [
			{
				"text": "<x y><x.y><x-y>1>2x<ya>b1<d e>f",
				"name": ""
			}
		]
	},
	{
		"desc": "HTML tag with necessary entities in attributes",
		"wikitext": "<span title=\"&amp;amp;\">foo</span>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "span ",
				"name": "htmltag-name"
			},
			{
				"text": "title=\"&amp;amp;\"",
				"name": "htmltag-attribute html-span"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "span",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "HTML tag with 'unnecessary' entity encoding in attributes",
		"wikitext": "<span title=\"&amp;\">foo</span>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "span ",
				"name": "htmltag-name"
			},
			{
				"text": "title=\"&amp;\"",
				"name": "htmltag-attribute html-span"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "span",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "HTML tag with broken attribute value quoting",
		"wikitext": "<span title=\"Hello world>Foo</span>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "span ",
				"name": "htmltag-name"
			},
			{
				"text": "title=\"Hello world",
				"name": "htmltag-attribute html-span"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "Foo",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "span",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Self-closed tag with broken attribute value quoting",
		"wikitext": "<div title=\"Hello world />Foo",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "title=\"Hello world ",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": "/>",
				"name": "htmltag-bracket"
			},
			{
				"text": "Foo",
				"name": ""
			}
		]
	},
	{
		"desc": "Table with broken attribute value quoting",
		"wikitext": "{|\n| title=\"Hello world|Foo\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "| ",
				"name": "table-delimiter"
			},
			{
				"text": "title=\"Hello world",
				"name": "table-definition html-td"
			},
			{
				"text": "|",
				"name": "table-delimiter2"
			},
			{
				"text": "Foo",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Table with broken attribute value quoting on consecutive lines",
		"wikitext": "{|\n| title=\"Hello world|Foo\n| style=\"color:red|Bar\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "| ",
				"name": "table-delimiter"
			},
			{
				"text": "title=\"Hello world",
				"name": "table-definition html-td"
			},
			{
				"text": "|",
				"name": "table-delimiter2"
			},
			{
				"text": "Foo",
				"name": ""
			},
			{
				"text": "| ",
				"name": "table-delimiter"
			},
			{
				"text": "style=\"color:red",
				"name": "table-definition html-td"
			},
			{
				"text": "|",
				"name": "table-delimiter2"
			},
			{
				"text": "Bar",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Accept empty td cell attribute",
		"wikitext": "{|\n| align=\"center\" |foo||  |\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "| ",
				"name": "table-delimiter"
			},
			{
				"text": "align=\"center\" ",
				"name": "table-definition html-td"
			},
			{
				"text": "|",
				"name": "table-delimiter2"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "||  ",
				"name": "table-delimiter"
			},
			{
				"text": "|",
				"name": "table-delimiter2"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Non-empty attributes in th-cells",
		"wikitext": "{|\n!Foo!! style=\"color: red\" |Bar\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "!",
				"name": "table-delimiter"
			},
			{
				"text": "Foo",
				"name": "strong"
			},
			{
				"text": "!! ",
				"name": "table-delimiter"
			},
			{
				"text": "style=\"color: red\" ",
				"name": "table-definition html-th"
			},
			{
				"text": "|",
				"name": "table-delimiter2"
			},
			{
				"text": "Bar",
				"name": "strong"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Accept empty attributes in th-cells",
		"wikitext": "{|\n!|foo!!|bar\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "!",
				"name": "table-delimiter"
			},
			{
				"text": "|",
				"name": "table-delimiter2"
			},
			{
				"text": "foo",
				"name": "strong"
			},
			{
				"text": "!!",
				"name": "table-delimiter"
			},
			{
				"text": "|",
				"name": "table-delimiter2"
			},
			{
				"text": "bar",
				"name": "strong"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Empty table rows go away",
		"wikitext": "{|\n|Hello\n|there\n|- class=\"foo\"\n|-\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "Hello",
				"name": ""
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "there",
				"name": ""
			},
			{
				"text": "|- ",
				"name": "table-delimiter"
			},
			{
				"text": "class=\"foo\"",
				"name": "table-definition html-tr"
			},
			{
				"text": "|-",
				"name": "table-delimiter"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "RT-ed inter-element separators should be valid separators",
		"wikitext": "{|\n|- [[foo]]\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|- ",
				"name": "table-delimiter"
			},
			{
				"text": "[[foo]]",
				"name": "table-definition html-tr"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Empty TD followed by TD with tpl-generated attribute",
		"wikitext": "{|\n|-\n|\n|{{1x|style='color:red'}}|foo\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|-||",
				"name": "table-delimiter"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "style=",
				"name": "template-ground template-argument-name"
			},
			{
				"text": "'color:red'",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter2"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Indented table with an empty td",
		"wikitext": " {|\n |-\n |\n |foo\n |}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": " |- | |",
				"name": "table-delimiter"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": " |}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Indented table with blank lines in between (T85627)",
		"wikitext": " {|\n |foo\n \n \n |}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": " |",
				"name": "table-delimiter"
			},
			{
				"text": "foo  ",
				"name": ""
			},
			{
				"text": " |}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Indented block & table",
		"wikitext": " <div>foo</div>\n {|\n |foo\n |}",
		"tokens": [
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": " |",
				"name": "table-delimiter"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": " |}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Indent and comment before table row",
		"wikitext": "{|\n <!--hi-->|-\n |there\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "<!--hi-->",
				"name": "comment"
			},
			{
				"text": "|-",
				"name": "error"
			},
			{
				"text": " |",
				"name": "table-delimiter"
			},
			{
				"text": "there",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Empty TR followed by a template-generated TR",
		"wikitext": "{|\n|-\n{{1x|<tr><td>foo</td></tr>}}\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|-",
				"name": "table-delimiter"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "<",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "tr",
				"name": "template-ground htmltag-name"
			},
			{
				"text": "><",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "td",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "foo",
				"name": "template-ground template"
			},
			{
				"text": "</",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "td",
				"name": "template-ground htmltag-name"
			},
			{
				"text": "></",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "tr",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Empty TR followed by mixed-ws-comment line should RT correctly",
		"wikitext": "{|\n|-\n <!--c-->\n|-\n<!--c--> <!--d-->\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|-",
				"name": "table-delimiter"
			},
			{
				"text": "<!--c-->",
				"name": "comment"
			},
			{
				"text": "|-",
				"name": "table-delimiter"
			},
			{
				"text": "<!--c-->",
				"name": "comment"
			},
			{
				"text": " ",
				"name": "error"
			},
			{
				"text": "<!--d-->",
				"name": "comment"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "1. Ensure fostered text content is wrapped in element nodes",
		"wikitext": "<table>hi</table><table>ho</table>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "hi",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "ho",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "2. Ensure fostered text content is wrapped in element nodes (traps regressions around fostered marker on the element getting lost)",
		"wikitext": "<table>\n<tr> || ||\n<td> a\n</table>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "tr",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " || ||",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " a",
				"name": ""
			},
			{
				"text": "</table>",
				"name": "error"
			}
		]
	},
	{
		"desc": "T72867: Don't block XML namespace declaration",
		"wikitext": "<span xmlns:dct=\"http://purl.org/dc/terms/\" property=\"dct:title\">MediaWiki</span>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "span ",
				"name": "htmltag-name"
			},
			{
				"text": "xmlns:dct=\"http://purl.org/dc/terms/\" property=\"dct:title\"",
				"name": "htmltag-attribute html-span"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "MediaWiki",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "span",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Magic links inside links (not autolinked)",
		"wikitext": "[[Foo|http://example.com]]\n[[Foo|RFC 1234]]\n[[Foo|PMID 1234]]\n[[Foo|ISBN 123456789x]]\n\n[http://foo.com http://example.com]\n[http://foo.com RFC 1234]\n[http://foo.com PMID 1234]\n[http://foo.com ISBN 123456789x]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Foo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "http://example.com",
				"name": "link-ground link-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Foo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "RFC 1234",
				"name": "link-ground link-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Foo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "PMID 1234",
				"name": "link-ground link-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Foo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "ISBN 123456789x",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "foo.com",
				"name": "link-ground extlink"
			},
			{
				"text": " http://example.com",
				"name": "link-ground extlink-text"
			},
			{
				"text": "][",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "foo.com",
				"name": "link-ground extlink"
			},
			{
				"text": " RFC 1234",
				"name": "link-ground extlink-text"
			},
			{
				"text": "][",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "foo.com",
				"name": "link-ground extlink"
			},
			{
				"text": " PMID 1234",
				"name": "link-ground extlink-text"
			},
			{
				"text": "][",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "foo.com",
				"name": "link-ground extlink"
			},
			{
				"text": " ISBN 123456789x",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "Don't escape pre elements that fail to parse as extension tags",
		"wikitext": "<pre>closed is extension tag, so everything is <span>text</span></pre>\n<pre>unclosed is not, so these are <span>tags</span>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "closed is extension tag, so everything is <span>text</span>",
				"name": "tag-pre"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": "><",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "unclosed is not, so these are <span>tags</span>",
				"name": "tag-pre"
			}
		]
	},
	{
		"desc": "Empty LI (T49673)",
		"wikitext": "*a\n* \n*\n*b",
		"tokens": [
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "**",
				"name": "list"
			},
			{
				"text": "b",
				"name": ""
			}
		]
	},
	{
		"desc": "unclosed internal link XSS (T137264)",
		"wikitext": "[[#%3Cscript%3Ealert(1)%3C/script%3E|",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "#%3Cscript%3Ealert(1)%3C/script%3E",
				"name": "link-ground link-tosection"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			}
		]
	},
	{
		"desc": "Decoding of HTML entities in headings and links for IDs and link fragments (T103714)",
		"wikitext": "==A&B&amp;C&amp;amp;D&amp;amp;amp;E==\n[[#A&B&amp;C&amp;amp;D&amp;amp;amp;E]]",
		"tokens": [
			{
				"text": "==",
				"name": "section-header section--2"
			},
			{
				"text": "A&B",
				"name": "section"
			},
			{
				"text": "&amp;",
				"name": "entity"
			},
			{
				"text": "C",
				"name": "section"
			},
			{
				"text": "&amp;",
				"name": "entity"
			},
			{
				"text": "amp;D",
				"name": "section"
			},
			{
				"text": "&amp;",
				"name": "entity"
			},
			{
				"text": "amp;amp;E",
				"name": "section"
			},
			{
				"text": "==",
				"name": "section-header"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "#A&B&amp;C&amp;amp;D&amp;amp;amp;E",
				"name": "link-ground link-tosection"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Decoding of HTML entities in headings and links for IDs and link fragments (T103714) (legacy)",
		"wikitext": "==A&B&amp;C&amp;amp;D&amp;amp;amp;E==\n[[#A&B&amp;C&amp;amp;D&amp;amp;amp;E]]",
		"tokens": [
			{
				"text": "==",
				"name": "section-header section--2"
			},
			{
				"text": "A&B",
				"name": "section"
			},
			{
				"text": "&amp;",
				"name": "entity"
			},
			{
				"text": "C",
				"name": "section"
			},
			{
				"text": "&amp;",
				"name": "entity"
			},
			{
				"text": "amp;D",
				"name": "section"
			},
			{
				"text": "&amp;",
				"name": "entity"
			},
			{
				"text": "amp;amp;E",
				"name": "section"
			},
			{
				"text": "==",
				"name": "section-header"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "#A&B&amp;C&amp;amp;D&amp;amp;amp;E",
				"name": "link-ground link-tosection"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Decoding of HTML entities in embedded HTML tags",
		"wikitext": "<table class=\"1&2&amp;3&amp;amp;4&amp;amp;amp;5\"><tr><td>x</td></tr></table>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "table ",
				"name": "htmltag-name"
			},
			{
				"text": "class=\"1&2&amp;3&amp;amp;4&amp;amp;amp;5\"",
				"name": "htmltag-attribute html-table"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "tr",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "x",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "tr",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "HTML5 ids: fallback to legacy",
		"wikitext": "==Foo bar==\n\n==foo Bar==\n\n==–¢–µ—Å—Ç==\n\n==–¢–µ—Å—Ç==\n\n==—Ç–µ—Å—Ç==\n\n==Hey < # \" > % : '==\n[[#Foo bar]] [[#foo Bar]] [[#–¢–µ—Å—Ç]] [[#—Ç–µ—Å—Ç]] [[#Hey < # \" > % : ']]\n\n{{anchorencode:üí©}} <span id=\"{{anchorencode:üí©}}\"></span>\n\n<!-- These two links should produce identical HTML -->\n[[#Âï§ÈÖí]] [[#%E5%95%A4%E9%85%92]]",
		"tokens": [
			{
				"text": "==",
				"name": "section-header section--2"
			},
			{
				"text": "Foo bar",
				"name": "section"
			},
			{
				"text": "==",
				"name": "section-header"
			},
			{
				"text": "==",
				"name": "section-header section--2"
			},
			{
				"text": "foo Bar",
				"name": "section"
			},
			{
				"text": "==",
				"name": "section-header"
			},
			{
				"text": "==",
				"name": "section-header section--2"
			},
			{
				"text": "–¢–µ—Å—Ç",
				"name": "section"
			},
			{
				"text": "==",
				"name": "section-header"
			},
			{
				"text": "==",
				"name": "section-header section--2"
			},
			{
				"text": "–¢–µ—Å—Ç",
				"name": "section"
			},
			{
				"text": "==",
				"name": "section-header"
			},
			{
				"text": "==",
				"name": "section-header section--2"
			},
			{
				"text": "—Ç–µ—Å—Ç",
				"name": "section"
			},
			{
				"text": "==",
				"name": "section-header"
			},
			{
				"text": "==",
				"name": "section-header section--2"
			},
			{
				"text": "Hey < # \" > % : '",
				"name": "section"
			},
			{
				"text": "==",
				"name": "section-header"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "#Foo bar",
				"name": "link-ground link-tosection"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "#foo Bar",
				"name": "link-ground link-tosection"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "#–¢–µ—Å—Ç",
				"name": "link-ground link-tosection"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "#—Ç–µ—Å—Ç",
				"name": "link-ground link-tosection"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "#Hey < # \" > % : '",
				"name": "link-ground link-tosection"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "anchorencode",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "üí©",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "span ",
				"name": "htmltag-name"
			},
			{
				"text": "id=\"{{anchorencode:üí©}}\"",
				"name": "htmltag-attribute html-span"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "span",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "<!-- These two links should produce identical HTML -->",
				"name": "comment"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "#Âï§ÈÖí",
				"name": "link-ground link-tosection"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "#%E5%95%A4%E9%85%92",
				"name": "link-ground link-tosection"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "HTML5 ids: legacy with a fallback to modern",
		"wikitext": "==Foo bar==\n\n==foo Bar==\n\n==–¢–µ—Å—Ç==\n\n==–¢–µ—Å—Ç==\n\n==—Ç–µ—Å—Ç==\n\n==Hey < # \" > % : '==\n[[#Foo bar]] [[#foo Bar]] [[#–¢–µ—Å—Ç]] [[#—Ç–µ—Å—Ç]] [[#Hey < # \" > % : ']]\n\n{{anchorencode:üí©}} <span id=\"{{anchorencode:üí©}}\"></span>\n\n<!-- These two links should produce identical HTML -->\n[[#Âï§ÈÖí]] [[#%E5%95%A4%E9%85%92]]",
		"tokens": [
			{
				"text": "==",
				"name": "section-header section--2"
			},
			{
				"text": "Foo bar",
				"name": "section"
			},
			{
				"text": "==",
				"name": "section-header"
			},
			{
				"text": "==",
				"name": "section-header section--2"
			},
			{
				"text": "foo Bar",
				"name": "section"
			},
			{
				"text": "==",
				"name": "section-header"
			},
			{
				"text": "==",
				"name": "section-header section--2"
			},
			{
				"text": "–¢–µ—Å—Ç",
				"name": "section"
			},
			{
				"text": "==",
				"name": "section-header"
			},
			{
				"text": "==",
				"name": "section-header section--2"
			},
			{
				"text": "–¢–µ—Å—Ç",
				"name": "section"
			},
			{
				"text": "==",
				"name": "section-header"
			},
			{
				"text": "==",
				"name": "section-header section--2"
			},
			{
				"text": "—Ç–µ—Å—Ç",
				"name": "section"
			},
			{
				"text": "==",
				"name": "section-header"
			},
			{
				"text": "==",
				"name": "section-header section--2"
			},
			{
				"text": "Hey < # \" > % : '",
				"name": "section"
			},
			{
				"text": "==",
				"name": "section-header"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "#Foo bar",
				"name": "link-ground link-tosection"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "#foo Bar",
				"name": "link-ground link-tosection"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "#–¢–µ—Å—Ç",
				"name": "link-ground link-tosection"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "#—Ç–µ—Å—Ç",
				"name": "link-ground link-tosection"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "#Hey < # \" > % : '",
				"name": "link-ground link-tosection"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "anchorencode",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "üí©",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "span ",
				"name": "htmltag-name"
			},
			{
				"text": "id=\"{{anchorencode:üí©}}\"",
				"name": "htmltag-attribute html-span"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "span",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "<!-- These two links should produce identical HTML -->",
				"name": "comment"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "#Âï§ÈÖí",
				"name": "link-ground link-tosection"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "#%E5%95%A4%E9%85%92",
				"name": "link-ground link-tosection"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "HTML5 ids: no legacy",
		"wikitext": "==Foo bar==\n\n==foo Bar==\n\n==–¢–µ—Å—Ç==\n\n==–¢–µ—Å—Ç==\n\n==—Ç–µ—Å—Ç==\n\n==Hey < # \" > % : '==\n[[#Foo bar]] [[#foo Bar]] [[#–¢–µ—Å—Ç]] [[#—Ç–µ—Å—Ç]] [[#Hey < # \" > % : ']]\n\n{{anchorencode:üí©}} <span id=\"{{anchorencode:üí©}}\"></span>\n\n<!-- These two links should produce identical HTML -->\n[[#Âï§ÈÖí]] [[#%E5%95%A4%E9%85%92]]",
		"tokens": [
			{
				"text": "==",
				"name": "section-header section--2"
			},
			{
				"text": "Foo bar",
				"name": "section"
			},
			{
				"text": "==",
				"name": "section-header"
			},
			{
				"text": "==",
				"name": "section-header section--2"
			},
			{
				"text": "foo Bar",
				"name": "section"
			},
			{
				"text": "==",
				"name": "section-header"
			},
			{
				"text": "==",
				"name": "section-header section--2"
			},
			{
				"text": "–¢–µ—Å—Ç",
				"name": "section"
			},
			{
				"text": "==",
				"name": "section-header"
			},
			{
				"text": "==",
				"name": "section-header section--2"
			},
			{
				"text": "–¢–µ—Å—Ç",
				"name": "section"
			},
			{
				"text": "==",
				"name": "section-header"
			},
			{
				"text": "==",
				"name": "section-header section--2"
			},
			{
				"text": "—Ç–µ—Å—Ç",
				"name": "section"
			},
			{
				"text": "==",
				"name": "section-header"
			},
			{
				"text": "==",
				"name": "section-header section--2"
			},
			{
				"text": "Hey < # \" > % : '",
				"name": "section"
			},
			{
				"text": "==",
				"name": "section-header"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "#Foo bar",
				"name": "link-ground link-tosection"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "#foo Bar",
				"name": "link-ground link-tosection"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "#–¢–µ—Å—Ç",
				"name": "link-ground link-tosection"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "#—Ç–µ—Å—Ç",
				"name": "link-ground link-tosection"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "#Hey < # \" > % : '",
				"name": "link-ground link-tosection"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "anchorencode",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "üí©",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "span ",
				"name": "htmltag-name"
			},
			{
				"text": "id=\"{{anchorencode:üí©}}\"",
				"name": "htmltag-attribute html-span"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "span",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "<!-- These two links should produce identical HTML -->",
				"name": "comment"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "#Âï§ÈÖí",
				"name": "link-ground link-tosection"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "#%E5%95%A4%E9%85%92",
				"name": "link-ground link-tosection"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "T90902: Normalize weird characters in section IDs",
		"wikitext": "==Foo&nbsp;bar==\n[[#Foo&nbsp;bar]]",
		"tokens": [
			{
				"text": "==",
				"name": "section-header section--2"
			},
			{
				"text": "Foo",
				"name": "section"
			},
			{
				"text": "&nbsp;",
				"name": "entity"
			},
			{
				"text": "bar",
				"name": "section"
			},
			{
				"text": "==",
				"name": "section-header"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "#Foo&nbsp;bar",
				"name": "link-ground link-tosection"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "T51672: Test for brackets in attributes of elements in external link texts",
		"wikitext": "[http://example.com/ link <span title=\"title with [brackets]\">span</span>]\n[http://example.com/ link <span title=\"title with &#91;brackets&#93;\">span</span>]",
		"tokens": [
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "example.com/",
				"name": "link-ground extlink"
			},
			{
				"text": " link ",
				"name": "link-ground extlink-text"
			},
			{
				"text": "<",
				"name": "link-ground htmltag-bracket"
			},
			{
				"text": "span ",
				"name": "link-ground htmltag-name"
			},
			{
				"text": "title=\"title with [brackets]\"",
				"name": "link-ground htmltag-attribute html-span"
			},
			{
				"text": ">",
				"name": "link-ground htmltag-bracket"
			},
			{
				"text": "span",
				"name": "link-ground extlink-text"
			},
			{
				"text": "</",
				"name": "link-ground htmltag-bracket"
			},
			{
				"text": "span",
				"name": "link-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "link-ground htmltag-bracket"
			},
			{
				"text": "][",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "example.com/",
				"name": "link-ground extlink"
			},
			{
				"text": " link ",
				"name": "link-ground extlink-text"
			},
			{
				"text": "<",
				"name": "link-ground htmltag-bracket"
			},
			{
				"text": "span ",
				"name": "link-ground htmltag-name"
			},
			{
				"text": "title=\"title with &#91;brackets&#93;\"",
				"name": "link-ground htmltag-attribute html-span"
			},
			{
				"text": ">",
				"name": "link-ground htmltag-bracket"
			},
			{
				"text": "span",
				"name": "link-ground extlink-text"
			},
			{
				"text": "</",
				"name": "link-ground htmltag-bracket"
			},
			{
				"text": "span",
				"name": "link-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "link-ground htmltag-bracket"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "T72875: Test for brackets in attributes of elements in internal link texts",
		"wikitext": "[[Foo|link <span title=\"title with [[double brackets]]\">span</span>]]\n[[Foo|link <span title=\"title with &#91;&#91;double brackets&#93;&#93;\">span</span>]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Foo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link ",
				"name": "link-ground link-text"
			},
			{
				"text": "<",
				"name": "link-ground htmltag-bracket"
			},
			{
				"text": "span ",
				"name": "link-ground htmltag-name"
			},
			{
				"text": "title=\"title with [[double brackets]]\"",
				"name": "link-ground htmltag-attribute html-span"
			},
			{
				"text": ">",
				"name": "link-ground htmltag-bracket"
			},
			{
				"text": "span",
				"name": "link-ground link-text"
			},
			{
				"text": "</",
				"name": "link-ground htmltag-bracket"
			},
			{
				"text": "span",
				"name": "link-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "link-ground htmltag-bracket"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Foo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link ",
				"name": "link-ground link-text"
			},
			{
				"text": "<",
				"name": "link-ground htmltag-bracket"
			},
			{
				"text": "span ",
				"name": "link-ground htmltag-name"
			},
			{
				"text": "title=\"title with &#91;&#91;double brackets&#93;&#93;\"",
				"name": "link-ground htmltag-attribute html-span"
			},
			{
				"text": ">",
				"name": "link-ground htmltag-bracket"
			},
			{
				"text": "span",
				"name": "link-ground link-text"
			},
			{
				"text": "</",
				"name": "link-ground htmltag-bracket"
			},
			{
				"text": "span",
				"name": "link-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "link-ground htmltag-bracket"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "T199926: Hash only interwiki link",
		"wikitext": "[[meatball:Test#1/2]]\n[[gerrit:#/q/project:mediawiki/services/parsoid|Gerrit]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "meatball:Test",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "#1/2",
				"name": "link-ground link-tosection"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "gerrit:",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "#/q/project:mediawiki/services/parsoid",
				"name": "link-ground link-tosection"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Gerrit",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "T179544: {{anchorencode:}} output should be always usable in links",
		"wikitext": "<span id=\"{{anchorencode:[foo]}}\"></span>[[#{{anchorencode:[foo]}}]]",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "span ",
				"name": "htmltag-name"
			},
			{
				"text": "id=\"{{anchorencode:[foo]}}\"",
				"name": "htmltag-attribute html-span"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "span",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "#",
				"name": "link-ground link-tosection"
			},
			{
				"text": "{{",
				"name": "ext-link-ground parserfunction-bracket"
			},
			{
				"text": "anchorencode",
				"name": "ext-link-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-link-ground parserfunction-delimiter"
			},
			{
				"text": "[foo]",
				"name": "ext-link-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-link-ground parserfunction-bracket"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Allow tabindex 0",
		"wikitext": "<div tabindex=\"0\">A</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "tabindex=\"0\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "A",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Don't allow tabindex -1",
		"wikitext": "<div tabindex=\"-1\">A</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "tabindex=\"-1\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "A",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Don't Allow tabindex > 0",
		"wikitext": "<div tabindex=\"3\">A</div>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "tabindex=\"3\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "A",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "aside tag is not allowed directly in wikitext (T278565)",
		"wikitext": "<aside>This aside tag in wikitext should be escaped</aside>",
		"tokens": [
			{
				"text": "<aside>This aside tag in wikitext should be escaped</aside>",
				"name": ""
			}
		]
	},
	{
		"desc": "badCharacters"
	},
	{
		"desc": "External links: invalid character NUL (stripped)",
		"wikitext": "[http://www.example.com\u0000 test]",
		"tokens": [
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "www.example.com\u0000",
				"name": "link-ground extlink"
			},
			{
				"text": " test",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "External links: invalid character backspace (preserved)",
		"wikitext": "[http://www.example.com\b test]",
		"tokens": [
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "www.example.com\b",
				"name": "link-ground extlink"
			},
			{
				"text": " test",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "Magic link: invalid character NUL (stripped)",
		"wikitext": "http://www.example.com\u0000 test",
		"tokens": [
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "www.example.com\u0000",
				"name": "free-extlink"
			},
			{
				"text": " test",
				"name": ""
			}
		]
	},
	{
		"desc": "Magic link: invalid character backspace (preserved)",
		"wikitext": "http://www.example.com\b test",
		"tokens": [
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "www.example.com\b",
				"name": "free-extlink"
			},
			{
				"text": " test",
				"name": ""
			}
		]
	},
	{
		"desc": "External links: tab character",
		"wikitext": "[http://www.example.com Alice in\tWonderland]",
		"tokens": [
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "www.example.com",
				"name": "link-ground extlink"
			},
			{
				"text": " Alice in\tWonderland",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "Stray carriage return in text",
		"wikitext": "hiho",
		"tokens": [
			{
				"text": "hiho",
				"name": ""
			}
		]
	},
	{
		"desc": "comments"
	},
	{
		"desc": "Comments and Indent-Pre",
		"wikitext": "<!-- comment 1 --> asdf\n\n<!-- comment 1 --> asdf\n<!-- comment 2 -->\n\n<!-- comment 1 --> asdf\n<!-- comment 2 -->xyz\n\n<!-- comment 1 --> asdf\n<!-- comment 2 --> xyz",
		"tokens": [
			{
				"text": "<!-- comment 1 -->",
				"name": "comment"
			},
			{
				"text": " asdf",
				"name": ""
			},
			{
				"text": "<!-- comment 1 -->",
				"name": "comment"
			},
			{
				"text": " asdf",
				"name": ""
			},
			{
				"text": "<!-- comment 2 --><!-- comment 1 -->",
				"name": "comment"
			},
			{
				"text": " asdf",
				"name": ""
			},
			{
				"text": "<!-- comment 2 -->",
				"name": "comment"
			},
			{
				"text": "xyz",
				"name": ""
			},
			{
				"text": "<!-- comment 1 -->",
				"name": "comment"
			},
			{
				"text": " asdf",
				"name": ""
			},
			{
				"text": "<!-- comment 2 -->",
				"name": "comment"
			},
			{
				"text": " xyz",
				"name": ""
			}
		]
	},
	{
		"desc": "Comment test 2a",
		"wikitext": "asdf\n<!-- comment 1 -->\njkl",
		"tokens": [
			{
				"text": "asdf",
				"name": ""
			},
			{
				"text": "<!-- comment 1 -->",
				"name": "comment"
			},
			{
				"text": "jkl",
				"name": ""
			}
		]
	},
	{
		"desc": "Comment test 2b",
		"wikitext": "asdf\n<!-- comment 1 -->\n\njkl",
		"tokens": [
			{
				"text": "asdf",
				"name": ""
			},
			{
				"text": "<!-- comment 1 -->",
				"name": "comment"
			},
			{
				"text": "jkl",
				"name": ""
			}
		]
	},
	{
		"desc": "Comment test 3",
		"wikitext": "asdf\n<!-- comment 1 -->\n<!-- comment 2 -->\njkl",
		"tokens": [
			{
				"text": "asdf",
				"name": ""
			},
			{
				"text": "<!-- comment 1 --><!-- comment 2 -->",
				"name": "comment"
			},
			{
				"text": "jkl",
				"name": ""
			}
		]
	},
	{
		"desc": "Comment test 4",
		"wikitext": "asdf<!-- comment 1 -->jkl",
		"tokens": [
			{
				"text": "asdf",
				"name": ""
			},
			{
				"text": "<!-- comment 1 -->",
				"name": "comment"
			},
			{
				"text": "jkl",
				"name": ""
			}
		]
	},
	{
		"desc": "Comment spacing",
		"wikitext": "a\n <!-- foo --> b <!-- bar -->\nc",
		"tokens": [
			{
				"text": "a",
				"name": ""
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "<!-- foo -->",
				"name": "comment"
			},
			{
				"text": " b ",
				"name": ""
			},
			{
				"text": "<!-- bar -->",
				"name": "comment"
			},
			{
				"text": "c",
				"name": ""
			}
		]
	},
	{
		"desc": "Comment whitespace",
		"wikitext": "<!-- returns a single newline, not nothing, since the newline after > is not stripped -->",
		"tokens": [
			{
				"text": "<!-- returns a single newline, not nothing, since the newline after > is not stripped -->",
				"name": "comment"
			}
		]
	},
	{
		"desc": "Comment semantics and delimiters",
		"wikitext": "<!-- --><!----><!-----><!------>",
		"tokens": [
			{
				"text": "<!-- --><!----><!-----><!------>",
				"name": "comment"
			}
		]
	},
	{
		"desc": "Comment semantics and delimiters, redux",
		"wikitext": "<!-- In SGML every \"foo\" here would actually show up in the text -- foo -- bar\n-- foo -- funky huh? ... -->",
		"tokens": [
			{
				"text": "<!-- In SGML every \"foo\" here would actually show up in the text -- foo -- bar-- foo -- funky huh? ... -->",
				"name": "comment"
			}
		]
	},
	{
		"desc": "Comment semantics and delimiters: directors cut",
		"wikitext": "<!-- ... However we like to keep things simple and somewhat XML-ish so we eat\neverything starting with < followed by !-- until the first -- and > we see,\nthat wouldn't be valid XML however, since in XML -- has to terminate a comment\n-->-->",
		"tokens": [
			{
				"text": "<!-- ... However we like to keep things simple and somewhat XML-ish so we eateverything starting with < followed by !-- until the first -- and > we see,that wouldn't be valid XML however, since in XML -- has to terminate a comment-->",
				"name": "comment"
			},
			{
				"text": "-->",
				"name": ""
			}
		]
	},
	{
		"desc": "Comment semantics: nesting",
		"wikitext": "<!--<!-- no, we're not going to do anything fancy here -->-->",
		"tokens": [
			{
				"text": "<!--<!-- no, we're not going to do anything fancy here -->",
				"name": "comment"
			},
			{
				"text": "-->",
				"name": ""
			}
		]
	},
	{
		"desc": "Comment semantics: unclosed comment at end",
		"wikitext": "<!--This comment will run out to the end of the document",
		"tokens": [
			{
				"text": "<!--This comment will run out to the end of the document",
				"name": "comment"
			}
		]
	},
	{
		"desc": "Comment semantics: normalize comments to play nice with XML and browsers",
		"wikitext": "<!-- Browsers --!> think this is closed -->\n<!--> This would normally be text -->\n<!---> As would this -->\n<!-- XML doesn't like trailing dashes -------->\n<!-- Nor doubled hyphens -- anywhere in the data -->\nBut this is not a comment.",
		"tokens": [
			{
				"text": "<!-- Browsers --!> think this is closed --><!-->",
				"name": "comment"
			},
			{
				"text": " This would normally be text -->",
				"name": ""
			},
			{
				"text": "<!--->",
				"name": "comment"
			},
			{
				"text": " As would this -->",
				"name": ""
			},
			{
				"text": "<!-- XML doesn't like trailing dashes --------><!-- Nor doubled hyphens -- anywhere in the data -->",
				"name": "comment"
			},
			{
				"text": "But this is not a comment.",
				"name": ""
			}
		]
	},
	{
		"desc": "Comment in template title",
		"wikitext": "{{f<!---->oo}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "f",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "<!---->",
				"name": "template-ground comment"
			},
			{
				"text": "oo",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Comment on its own line post-expand",
		"wikitext": "a\n{{blank}}<!---->\nb",
		"tokens": [
			{
				"text": "a",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "blank",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "<!---->",
				"name": "comment"
			},
			{
				"text": "b",
				"name": ""
			}
		]
	},
	{
		"desc": "Comment on its own line post-expand with non-significant whitespace",
		"wikitext": "a\n {{blank}} <!----> \nb",
		"tokens": [
			{
				"text": "a",
				"name": ""
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "blank",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "<!---->",
				"name": "comment"
			},
			{
				"text": " b",
				"name": ""
			}
		]
	},
	{
		"desc": "Multiple comments should still parse as SOL-transparent",
		"wikitext": "<!--c1-->*a\n<!--c2--><!--c3--><!--c4-->*b",
		"tokens": [
			{
				"text": "<!--c1-->",
				"name": "comment"
			},
			{
				"text": "*a",
				"name": ""
			},
			{
				"text": "<!--c2--><!--c3--><!--c4-->",
				"name": "comment"
			},
			{
				"text": "*b",
				"name": ""
			}
		]
	},
	{
		"desc": "Comment with valid json",
		"wikitext": "hi <!--{\"hi\":\"ho\"}--> ho",
		"tokens": [
			{
				"text": "hi ",
				"name": ""
			},
			{
				"text": "<!--{\"hi\":\"ho\"}-->",
				"name": "comment"
			},
			{
				"text": " ho",
				"name": ""
			}
		]
	},
	{
		"desc": "definitionLists"
	},
	{
		"desc": "Simple definition",
		"wikitext": ";name :Definition",
		"tokens": [
			{
				"text": ";",
				"name": "list"
			},
			{
				"text": "name ",
				"name": "strong"
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "Definition",
				"name": ""
			}
		]
	},
	{
		"desc": "Definition list for indentation only",
		"wikitext": ":Indented text",
		"tokens": [
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "Indented text",
				"name": ""
			}
		]
	},
	{
		"desc": "Definition list with no space",
		"wikitext": ";name:Definition",
		"tokens": [
			{
				"text": ";",
				"name": "list"
			},
			{
				"text": "name",
				"name": "strong"
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "Definition",
				"name": ""
			}
		]
	},
	{
		"desc": "Definition list with URL link",
		"wikitext": ";http://example.com/ :definition",
		"tokens": [
			{
				"text": ";",
				"name": "list"
			},
			{
				"text": "http",
				"name": "strong"
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "//example.com/ :definition",
				"name": ""
			}
		]
	},
	{
		"desc": "Definition list with bracketed URL link",
		"wikitext": ";[http://www.example.com/ Example]:Something about it",
		"tokens": [
			{
				"text": ";",
				"name": "list"
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "www.example.com/",
				"name": "link-ground extlink"
			},
			{
				"text": " Example",
				"name": "link-ground extlink-text strong"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "Something about it",
				"name": ""
			}
		]
	},
	{
		"desc": "Definition list with wikilink containing colon",
		"wikitext": ";[[Help:FAQ]]:The least-read page on Wikipedia",
		"tokens": [
			{
				"text": ";",
				"name": "list"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Help:FAQ",
				"name": "link-ground link-pagename pagename strong"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "The least-read page on Wikipedia",
				"name": ""
			}
		]
	},
	{
		"desc": "Definition list with news link containing colon",
		"wikitext": ";news:alt.wikipedia.rox :This isn't even a real newsgroup!",
		"tokens": [
			{
				"text": ";",
				"name": "list"
			},
			{
				"text": "news",
				"name": "strong"
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "alt.wikipedia.rox :This isn't even a real newsgroup!",
				"name": ""
			}
		]
	},
	{
		"desc": "Malformed definition list with colon",
		"wikitext": ";news:alt.wikipedia.rox -- don't crash or enter an infinite loop",
		"tokens": [
			{
				"text": ";",
				"name": "list"
			},
			{
				"text": "news",
				"name": "strong"
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "alt.wikipedia.rox -- don't crash or enter an infinite loop",
				"name": ""
			}
		]
	},
	{
		"desc": "Definition lists: colon in external link text",
		"wikitext": ";[http://www.wikipedia2.org/ Wikipedia :The Next Generation] :OK, I made that up",
		"tokens": [
			{
				"text": ";",
				"name": "list"
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "www.wikipedia2.org/",
				"name": "link-ground extlink"
			},
			{
				"text": " Wikipedia :The Next Generation",
				"name": "link-ground extlink-text strong"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": " ",
				"name": "strong"
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "OK, I made that up",
				"name": ""
			}
		]
	},
	{
		"desc": "Definition lists: colon in HTML attribute",
		"wikitext": ";<b style=\"display: inline\">bold</b>",
		"tokens": [
			{
				"text": ";",
				"name": "list"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "b ",
				"name": "htmltag-name"
			},
			{
				"text": "style=",
				"name": "htmltag-attribute html-b strong"
			},
			{
				"text": "\"display: inline\"",
				"name": "htmltag-attribute html-b"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "bold",
				"name": "strong"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "b",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Definition lists: self-closed tag",
		"wikitext": ";one<br/>two :two-line fun",
		"tokens": [
			{
				"text": ";",
				"name": "list"
			},
			{
				"text": "one",
				"name": "strong"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "br",
				"name": "htmltag-name"
			},
			{
				"text": "/>",
				"name": "htmltag-bracket"
			},
			{
				"text": "two ",
				"name": "strong"
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "two-line fun",
				"name": ""
			}
		]
	},
	{
		"desc": "Definition lists: ignore colons inside tags",
		"wikitext": ";one <b>two : tag <i>fun:</i>:</b>:def",
		"tokens": [
			{
				"text": ";",
				"name": "list"
			},
			{
				"text": "one ",
				"name": "strong"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "b",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "two ",
				"name": "strong"
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": " tag ",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "i",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "fun:",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "i",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": ":",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "b",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": ":def",
				"name": ""
			}
		]
	},
	{
		"desc": "Definition lists: excess closed tags",
		"wikitext": ";one</b>two :bad tag fun",
		"tokens": [
			{
				"text": ";",
				"name": "list"
			},
			{
				"text": "one",
				"name": "strong"
			},
			{
				"text": "</b>",
				"name": "error"
			},
			{
				"text": "two ",
				"name": "strong"
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "bad tag fun",
				"name": ""
			}
		]
	},
	{
		"desc": "T13748: Literal closing tags",
		"wikitext": "<dl>\n<dt>test 1</dt>\n<dd>test test test test test</dd>\n<dt>test 2</dt>\n<dd>test test test test test</dd>\n</dl>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "dl",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "dt",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "test 1",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "dt",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "dd",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "test test test test test",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "dd",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "dt",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "test 2",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "dt",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "dd",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "test test test test test",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "dd",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "dl",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Definition and unordered list using wiki syntax nested in unordered list using html tags.",
		"wikitext": "<ul><li>\n;term :description\n*unordered\n</li></ul>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "ul",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": ";",
				"name": "list"
			},
			{
				"text": "term ",
				"name": "strong"
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "description",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "unordered",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "ul",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Definition list with empty definition and following paragraph",
		"wikitext": ";term:\n\nParagraph text",
		"tokens": [
			{
				"text": ";",
				"name": "list"
			},
			{
				"text": "term",
				"name": "strong"
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "Paragraph text",
				"name": ""
			}
		]
	},
	{
		"desc": "Nested definition lists using html syntax",
		"wikitext": "<dl><dt>x</dt>\n<dd>a</dd>\n<dd>b</dd></dl>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "dl",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "dt",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "x",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "dt",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "dd",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "dd",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "dd",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "b",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "dd",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "dl",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Definition Lists: No nesting: Multiple dd's",
		"wikitext": ";x\n:a\n:b",
		"tokens": [
			{
				"text": ";",
				"name": "list"
			},
			{
				"text": "x",
				"name": "strong"
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "b",
				"name": ""
			}
		]
	},
	{
		"desc": "Definition Lists: Indentation: Regular",
		"wikitext": ":i1\n::i2\n:::i3",
		"tokens": [
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "i1",
				"name": ""
			},
			{
				"text": "::",
				"name": "list"
			},
			{
				"text": "i2",
				"name": ""
			},
			{
				"text": ":::",
				"name": "list"
			},
			{
				"text": "i3",
				"name": ""
			}
		]
	},
	{
		"desc": "Definition Lists: Indentation: Missing 1st level",
		"wikitext": "::i2\n:::i3",
		"tokens": [
			{
				"text": "::",
				"name": "list"
			},
			{
				"text": "i2",
				"name": ""
			},
			{
				"text": ":::",
				"name": "list"
			},
			{
				"text": "i3",
				"name": ""
			}
		]
	},
	{
		"desc": "Definition Lists: Indentation: Multi-level indent",
		"wikitext": ":::i3",
		"tokens": [
			{
				"text": ":::",
				"name": "list"
			},
			{
				"text": "i3",
				"name": ""
			}
		]
	},
	{
		"desc": "Definition Lists: Hacky use to indent tables",
		"wikitext": "::{|\n|foo\n|bar\n|}\nthis text\nshould be left alone",
		"tokens": [
			{
				"text": "::",
				"name": "list"
			},
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "bar",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			},
			{
				"text": "this textshould be left alone",
				"name": ""
			}
		]
	},
	{
		"desc": "Definition Lists: Hacky use to indent tables (with content following table)",
		"wikitext": ":{|\n|foo\n|bar\n|} <!--c1--> this text should be part of the dl",
		"tokens": [
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "bar",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "<!--c1-->",
				"name": "comment"
			},
			{
				"text": " this text should be part of the dl",
				"name": ""
			}
		]
	},
	{
		"desc": "Definition Lists: Hack use to indent tables, in a nested list context (T262943)",
		"wikitext": "This is a discussion thread.\n\n:Parent comment.\n::Child comment\n::{|\n|With a\n|Table!\n|}",
		"tokens": [
			{
				"text": "This is a discussion thread.",
				"name": ""
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "Parent comment.",
				"name": ""
			},
			{
				"text": "::",
				"name": "list"
			},
			{
				"text": "Child comment",
				"name": ""
			},
			{
				"text": "::",
				"name": "list"
			},
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "With a",
				"name": ""
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "Table!",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Definition Lists: Hacky use to indent tables (WS-insensitive)",
		"wikitext": ":{|\n|a\n|}",
		"tokens": [
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Definition Lists: Hacky use to indent tables (nl-insensitive)",
		"wikitext": ":{|\n\n\n|a\n|}",
		"tokens": [
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Table / list interaction: indented table with lists in table contents",
		"wikitext": ":{|\n|-\n|a\n\n*b\n|-\n|c\n\n*d\n|}",
		"tokens": [
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|-|",
				"name": "table-delimiter"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "b",
				"name": ""
			},
			{
				"text": "|-|",
				"name": "table-delimiter"
			},
			{
				"text": "c",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "d",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Table / list interaction: lists nested in tables nested in indented lists",
		"wikitext": ":{|\n|\n:a\n:b\n|\n*c\n*d\n|}\n\n*e\n*f",
		"tokens": [
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "b",
				"name": ""
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "c",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "d",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "e",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "f",
				"name": ""
			}
		]
	},
	{
		"desc": "Definition Lists: Nesting: Test 2",
		"wikitext": ";t1\n::d2",
		"tokens": [
			{
				"text": ";",
				"name": "list"
			},
			{
				"text": "t1",
				"name": "strong"
			},
			{
				"text": "::",
				"name": "list"
			},
			{
				"text": "d2",
				"name": ""
			}
		]
	},
	{
		"desc": "Definition Lists: Nesting: Test 3",
		"wikitext": ":;t1\n::::d2",
		"tokens": [
			{
				"text": ":;",
				"name": "list"
			},
			{
				"text": "t1",
				"name": "strong"
			},
			{
				"text": "::::",
				"name": "list"
			},
			{
				"text": "d2",
				"name": ""
			}
		]
	},
	{
		"desc": "Definition Lists: Nesting: Test 4",
		"wikitext": "::;t3\n:::d3",
		"tokens": [
			{
				"text": "::;",
				"name": "list"
			},
			{
				"text": "t3",
				"name": "strong"
			},
			{
				"text": ":::",
				"name": "list"
			},
			{
				"text": "d3",
				"name": ""
			}
		]
	},
	{
		"desc": "Definition Lists: Mixed Lists: Test 1",
		"wikitext": ":;*foo\n::*bar\n:;baz",
		"tokens": [
			{
				"text": ":;*",
				"name": "list"
			},
			{
				"text": "foo",
				"name": "strong"
			},
			{
				"text": "::*",
				"name": "list"
			},
			{
				"text": "bar",
				"name": ""
			},
			{
				"text": ":;",
				"name": "list"
			},
			{
				"text": "baz",
				"name": "strong"
			}
		]
	},
	{
		"desc": "Definition Lists: Mixed Lists: Test 2",
		"wikitext": "*:d1\n*:d2",
		"tokens": [
			{
				"text": "*:",
				"name": "list"
			},
			{
				"text": "d1",
				"name": ""
			},
			{
				"text": "*:",
				"name": "list"
			},
			{
				"text": "d2",
				"name": ""
			}
		]
	},
	{
		"desc": "Definition Lists: Mixed Lists: Test 3",
		"wikitext": "*:::d1\n*:::d2",
		"tokens": [
			{
				"text": "*:::",
				"name": "list"
			},
			{
				"text": "d1",
				"name": ""
			},
			{
				"text": "*:::",
				"name": "list"
			},
			{
				"text": "d2",
				"name": ""
			}
		]
	},
	{
		"desc": "Definition Lists: Mixed Lists: Test 4",
		"wikitext": "*;d1 :d2\n*;d3 :d4",
		"tokens": [
			{
				"text": "*;",
				"name": "list"
			},
			{
				"text": "d1 ",
				"name": "strong"
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "d2",
				"name": ""
			},
			{
				"text": "*;",
				"name": "list"
			},
			{
				"text": "d3 ",
				"name": "strong"
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "d4",
				"name": ""
			}
		]
	},
	{
		"desc": "Definition Lists: Mixed Lists: Test 5",
		"wikitext": "*:d1\n*::d2",
		"tokens": [
			{
				"text": "*:",
				"name": "list"
			},
			{
				"text": "d1",
				"name": ""
			},
			{
				"text": "*::",
				"name": "list"
			},
			{
				"text": "d2",
				"name": ""
			}
		]
	},
	{
		"desc": "Definition Lists: Mixed Lists: Test 6",
		"wikitext": "#*:d1\n#*:::d3",
		"tokens": [
			{
				"text": "#*:",
				"name": "list"
			},
			{
				"text": "d1",
				"name": ""
			},
			{
				"text": "#*:::",
				"name": "list"
			},
			{
				"text": "d3",
				"name": ""
			}
		]
	},
	{
		"desc": "Definition Lists: Mixed Lists: Test 7",
		"wikitext": ":*d1\n:*d2",
		"tokens": [
			{
				"text": ":*",
				"name": "list"
			},
			{
				"text": "d1",
				"name": ""
			},
			{
				"text": ":*",
				"name": "list"
			},
			{
				"text": "d2",
				"name": ""
			}
		]
	},
	{
		"desc": "Definition Lists: Mixed Lists: Test 8",
		"wikitext": ":*d1\n::*d2",
		"tokens": [
			{
				"text": ":*",
				"name": "list"
			},
			{
				"text": "d1",
				"name": ""
			},
			{
				"text": "::*",
				"name": "list"
			},
			{
				"text": "d2",
				"name": ""
			}
		]
	},
	{
		"desc": "Definition Lists: Mixed Lists: Test 9",
		"wikitext": "*;foo :bar",
		"tokens": [
			{
				"text": "*;",
				"name": "list"
			},
			{
				"text": "foo ",
				"name": "strong"
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "bar",
				"name": ""
			}
		]
	},
	{
		"desc": "Definition Lists: Mixed Lists: Test 10",
		"wikitext": "*#;foo :bar",
		"tokens": [
			{
				"text": "*#;",
				"name": "list"
			},
			{
				"text": "foo ",
				"name": "strong"
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "bar",
				"name": ""
			}
		]
	},
	{
		"desc": "Definition Lists: Mixed Lists: Test 11",
		"wikitext": ";a\n:*b",
		"tokens": [
			{
				"text": ";",
				"name": "list"
			},
			{
				"text": "a",
				"name": "strong"
			},
			{
				"text": ":*",
				"name": "list"
			},
			{
				"text": "b",
				"name": ""
			}
		]
	},
	{
		"desc": "Definition Lists: Mixed Lists: Test 12",
		"wikitext": "*#*#;*;;foo :bar\n*#*#;boo :baz",
		"tokens": [
			{
				"text": "*#*#;*;;",
				"name": "list"
			},
			{
				"text": "foo ",
				"name": "strong"
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "bar",
				"name": "strong"
			},
			{
				"text": "*#*#;",
				"name": "list"
			},
			{
				"text": "boo ",
				"name": "strong"
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "baz",
				"name": ""
			}
		]
	},
	{
		"desc": "Definition Lists: Mixed Lists: Test 13",
		"wikitext": "*#*#;*;;foo : bar\n*#*#;boo : baz",
		"tokens": [
			{
				"text": "*#*#;*;;",
				"name": "list"
			},
			{
				"text": "foo ",
				"name": "strong"
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": " bar",
				"name": "strong"
			},
			{
				"text": "*#*#;",
				"name": "list"
			},
			{
				"text": "boo ",
				"name": "strong"
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": " baz",
				"name": ""
			}
		]
	},
	{
		"desc": "Definition Lists: Weird Ones: Test 1",
		"wikitext": "*#;*::;;foo :bar (who uses this?)",
		"tokens": [
			{
				"text": "*#;*::;;",
				"name": "list"
			},
			{
				"text": "foo ",
				"name": "strong"
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "bar (who uses this?)",
				"name": "strong"
			}
		]
	},
	{
		"desc": "Definition Lists: colons occurring in tags",
		"wikitext": ";a:b\n;'''a:b'''\n;<i>a:b</i>\n;<span>a:b</span>\n;<div>a:b</div>\n;<div>a\n:b</div>\n;{{1x|a:b}}\n;{{1x|''a:b''}}\n;;;''a:b''",
		"tokens": [
			{
				"text": ";",
				"name": "list"
			},
			{
				"text": "a",
				"name": "strong"
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "b",
				"name": ""
			},
			{
				"text": ";",
				"name": "list"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "a",
				"name": "strong"
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "b",
				"name": "strong"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": ";",
				"name": "list"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "i",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "a",
				"name": "strong"
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "b",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "i",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": ";",
				"name": "list"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "span",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "a",
				"name": "strong"
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "b",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "span",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": ";",
				"name": "list"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "a",
				"name": "strong"
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "b",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": ";",
				"name": "list"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "a",
				"name": "strong"
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "b",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": ";",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "a",
				"name": "template-ground template"
			},
			{
				"text": ":",
				"name": "template-ground template strong"
			},
			{
				"text": "b",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": ";",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "''",
				"name": "template-ground apostrophes"
			},
			{
				"text": "a",
				"name": "template-ground template"
			},
			{
				"text": ":",
				"name": "template-ground template strong em"
			},
			{
				"text": "b",
				"name": "template-ground template"
			},
			{
				"text": "''",
				"name": "template-ground apostrophes"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": ";;;",
				"name": "list"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "a",
				"name": "strong em"
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "b",
				"name": "strong em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Definition Lists: colons and tables 1",
		"wikitext": ":{|\n|x\n|}\n:{|\n|y\n|}",
		"tokens": [
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "x",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			},
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "y",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "extLinks"
	},
	{
		"desc": "External links: non-bracketed",
		"wikitext": "Non-bracketed: http://example.com",
		"tokens": [
			{
				"text": "Non-bracketed: ",
				"name": ""
			},
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com",
				"name": "free-extlink"
			}
		]
	},
	{
		"desc": "External links: numbered",
		"wikitext": "Numbered: [http://example.com]\nNumbered: [http://example.net]\nNumbered: [http://example.com]",
		"tokens": [
			{
				"text": "Numbered: ",
				"name": ""
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "example.com",
				"name": "link-ground extlink"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "Numbered: ",
				"name": ""
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "example.net",
				"name": "link-ground extlink"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "Numbered: ",
				"name": ""
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "example.com",
				"name": "link-ground extlink"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "External links: specified text",
		"wikitext": "Specified text: [http://example.com link]",
		"tokens": [
			{
				"text": "Specified text: ",
				"name": ""
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "example.com",
				"name": "link-ground extlink"
			},
			{
				"text": " link",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "External links: trail",
		"wikitext": "Linktrails should not work for external links: [http://example.com link]s",
		"tokens": [
			{
				"text": "Linktrails should not work for external links: ",
				"name": ""
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "example.com",
				"name": "link-ground extlink"
			},
			{
				"text": " link",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "s",
				"name": ""
			}
		]
	},
	{
		"desc": "External links: dollar sign in URL",
		"wikitext": "http://example.com/1$2345",
		"tokens": [
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com/1$2345",
				"name": "free-extlink"
			}
		]
	},
	{
		"desc": "External links: dollar sign in URL (autonumber)",
		"wikitext": "[http://example.com/1$2345]",
		"tokens": [
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "example.com/1$2345",
				"name": "link-ground extlink"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "External links: open square bracket forbidden in URL (T6377)",
		"wikitext": "http://example.com/1[2345",
		"tokens": [
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com/1",
				"name": "free-extlink"
			},
			{
				"text": "[2345",
				"name": ""
			}
		]
	},
	{
		"desc": "External links: open square bracket forbidden in URL (named) (T6377)",
		"wikitext": "[http://example.com/1[2345]",
		"tokens": [
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "example.com/1",
				"name": "link-ground extlink"
			},
			{
				"text": "[2345",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "External links: open square bracket forbidden in URL (named) (T6377)\nParsoid variant.",
		"wikitext": "[http://example.com/1 [2345]",
		"tokens": [
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "example.com/1",
				"name": "link-ground extlink"
			},
			{
				"text": " [2345",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "External links: nowiki in URL link text (T8230)",
		"wikitext": "[http://example.com/ <nowiki>''example site''</nowiki>]",
		"tokens": [
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "example.com/",
				"name": "link-ground extlink"
			},
			{
				"text": " ",
				"name": "link-ground extlink-text"
			},
			{
				"text": "<",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "link-ground exttag-name"
			},
			{
				"text": ">",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": "''example site''",
				"name": "tag-nowiki"
			},
			{
				"text": "</",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "link-ground exttag-name"
			},
			{
				"text": ">",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "External links: newline forbidden in text (T8230 regression check)",
		"wikitext": "[http://example.com/ first\nsecond]",
		"tokens": [
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "example.com/",
				"name": "link-ground extlink"
			},
			{
				"text": " first",
				"name": "link-ground extlink-text"
			},
			{
				"text": "second]",
				"name": ""
			}
		]
	},
	{
		"desc": "External links: Pipe char between url and text",
		"wikitext": "[http://example.com | link]",
		"tokens": [
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "example.com",
				"name": "link-ground extlink"
			},
			{
				"text": " | link",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "External links: protocol-relative URL in brackets",
		"wikitext": "[//example.com/ Test]",
		"tokens": [
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "//",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "example.com/",
				"name": "link-ground extlink"
			},
			{
				"text": " Test",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "External links: protocol-relative URL in brackets without text",
		"wikitext": "[//example.com]",
		"tokens": [
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "//",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "example.com",
				"name": "link-ground extlink"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "External links: protocol-relative URL in free text is left alone",
		"wikitext": "//example.com/Foo",
		"tokens": [
			{
				"text": "//example.com/Foo",
				"name": ""
			}
		]
	},
	{
		"desc": "External links: protocol-relative URL in the middle of a word is left alone (T32269)",
		"wikitext": "foo//example.com/Foo",
		"tokens": [
			{
				"text": "foo//example.com/Foo",
				"name": ""
			}
		]
	},
	{
		"desc": "External links: with no contents",
		"wikitext": "[http://en.wikipedia.org/wiki/Foo]\n\n[[wikipedia:Foo|Bar]]\n\n[[wikipedia:Foo|<span>Bar</span>]]",
		"tokens": [
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "en.wikipedia.org/wiki/Foo",
				"name": "link-ground extlink"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "wikipedia:Foo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Bar",
				"name": "link-ground link-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "wikipedia:Foo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "<",
				"name": "link-ground htmltag-bracket"
			},
			{
				"text": "span",
				"name": "link-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "link-ground htmltag-bracket"
			},
			{
				"text": "Bar",
				"name": "link-ground link-text"
			},
			{
				"text": "</",
				"name": "link-ground htmltag-bracket"
			},
			{
				"text": "span",
				"name": "link-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "link-ground htmltag-bracket"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "External links: Free with trailing punctuation",
		"wikitext": "http://example.com,\nhttp://example.com;\nhttp://example.com\\\nhttp://example.com.\nhttp://example.com:\nhttp://example.com!\nhttp://example.com?\nhttp://example.com)\nhttp://example.com/url_with_(brackets)\n(http://example.com/url_without_brackets)\nhttp://example.com/url_with_entity&amp;\nhttp://example.com/url_with_entity&#x26;\nhttp://example.com/url_with_entity&#038;\nhttp://example.com/url_with_entity&nbsp;\nhttp://example.com/url_with_entity&#xA0;\nhttp://example.com/url_with_entity&#160;\nhttp://example.com/url_with_entity&lt;\nhttp://example.com/url_with_entity&#x3C;\nhttp://example.com/url_with_entity&#60;",
		"tokens": [
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com",
				"name": "free-extlink"
			},
			{
				"text": ",",
				"name": ""
			},
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com",
				"name": "free-extlink"
			},
			{
				"text": ";",
				"name": ""
			},
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com",
				"name": "free-extlink"
			},
			{
				"text": "\\",
				"name": ""
			},
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com",
				"name": "free-extlink"
			},
			{
				"text": ".",
				"name": ""
			},
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com",
				"name": "free-extlink"
			},
			{
				"text": ":",
				"name": ""
			},
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com",
				"name": "free-extlink"
			},
			{
				"text": "!",
				"name": ""
			},
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com",
				"name": "free-extlink"
			},
			{
				"text": "?",
				"name": ""
			},
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com",
				"name": "free-extlink"
			},
			{
				"text": ")",
				"name": ""
			},
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com/url_with_(brackets)",
				"name": "free-extlink"
			},
			{
				"text": "(",
				"name": ""
			},
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com/url_without_brackets",
				"name": "free-extlink"
			},
			{
				"text": ")",
				"name": ""
			},
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com/url_with_entity&amp",
				"name": "free-extlink"
			},
			{
				"text": ";",
				"name": ""
			},
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com/url_with_entity&#x26",
				"name": "free-extlink"
			},
			{
				"text": ";",
				"name": ""
			},
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com/url_with_entity&#038",
				"name": "free-extlink"
			},
			{
				"text": ";",
				"name": ""
			},
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com/url_with_entity&nbsp",
				"name": "free-extlink"
			},
			{
				"text": ";",
				"name": ""
			},
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com/url_with_entity&#xA0",
				"name": "free-extlink"
			},
			{
				"text": ";",
				"name": ""
			},
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com/url_with_entity&#160",
				"name": "free-extlink"
			},
			{
				"text": ";",
				"name": ""
			},
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com/url_with_entity",
				"name": "free-extlink"
			},
			{
				"text": "&lt;",
				"name": "entity"
			},
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com/url_with_entity&#x3C",
				"name": "free-extlink"
			},
			{
				"text": ";",
				"name": ""
			},
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com/url_with_entity&#60",
				"name": "free-extlink"
			},
			{
				"text": ";",
				"name": ""
			}
		]
	},
	{
		"desc": "External links: tricky Parsoid html2html case",
		"wikitext": "http://example.com/url_with_entity&amp;amp;",
		"tokens": [
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com/url_with_entity&amp;amp",
				"name": "free-extlink"
			},
			{
				"text": ";",
				"name": ""
			}
		]
	},
	{
		"desc": "External links: html2html with trailing dot (T263203)",
		"wikitext": "test [http://example.com/test. http://example.com/test.] test\n\ntest http://example.com/test. test",
		"tokens": [
			{
				"text": "test ",
				"name": ""
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "example.com/test.",
				"name": "link-ground extlink"
			},
			{
				"text": " http://example.com/test.",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": " testtest ",
				"name": ""
			},
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com/test",
				"name": "free-extlink"
			},
			{
				"text": ". test",
				"name": ""
			}
		]
	},
	{
		"desc": "External links: Free with trailing quotes (T113666)",
		"wikitext": "'''News:''' Stuff here\n\nnews:'a'b''c''d e",
		"tokens": [
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "News:",
				"name": "strong"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": " Stuff here",
				"name": ""
			},
			{
				"text": "news:",
				"name": "free-extlink-protocol"
			},
			{
				"text": "'a'b",
				"name": "free-extlink"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "c",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "d e",
				"name": ""
			}
		]
	},
	{
		"desc": "External links: with entity",
		"wikitext": "[http://&#x20;www.librarieswithoutborders.org Libraries without borders]",
		"tokens": [
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "&#x20;www.librarieswithoutborders.org",
				"name": "link-ground extlink"
			},
			{
				"text": " Libraries without borders",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "External links: Lone protocols are never linked (T105697)",
		"wikitext": "http://\nhttp://;\n(http://)\nbitcoin:\nbitcoin:;\n(bitcoin:)",
		"tokens": [
			{
				"text": "http://",
				"name": ""
			},
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": ";(",
				"name": ""
			},
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": ")bitcoin:",
				"name": ""
			},
			{
				"text": "bitcoin:",
				"name": "free-extlink-protocol"
			},
			{
				"text": ";(",
				"name": ""
			},
			{
				"text": "bitcoin:",
				"name": "free-extlink-protocol"
			},
			{
				"text": ")",
				"name": ""
			}
		]
	},
	{
		"desc": "External links: No preceding word characters allowed (T67278)",
		"wikitext": "NOPEhttp://example.com\nN0http://example.com\nok:http://example.com\nok-http://example.com",
		"tokens": [
			{
				"text": "NOPEhttp://example.comN0http://example.comok:",
				"name": ""
			},
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com",
				"name": "free-extlink"
			},
			{
				"text": "ok-",
				"name": ""
			},
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com",
				"name": "free-extlink"
			}
		]
	},
	{
		"desc": "External links: nofollow domain exception",
		"wikitext": "A [https://no-nofollow.org/foobar link], and another [https://example.org link].",
		"tokens": [
			{
				"text": "A ",
				"name": ""
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "https://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "no-nofollow.org/foobar",
				"name": "link-ground extlink"
			},
			{
				"text": " link",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": ", and another ",
				"name": ""
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "https://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "example.org",
				"name": "link-ground extlink"
			},
			{
				"text": " link",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": ".",
				"name": ""
			}
		]
	},
	{
		"desc": "External image",
		"wikitext": "External image: http://meta.wikimedia.org/upload/f/f1/Ncwikicol.png",
		"tokens": [
			{
				"text": "External image: ",
				"name": ""
			},
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "meta.wikimedia.org/upload/f/f1/Ncwikicol.png",
				"name": "free-extlink"
			}
		]
	},
	{
		"desc": "External image from https",
		"wikitext": "External image from https: https://meta.wikimedia.org/upload/f/f1/Ncwikicol.png",
		"tokens": [
			{
				"text": "External image from https: ",
				"name": ""
			},
			{
				"text": "https://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "meta.wikimedia.org/upload/f/f1/Ncwikicol.png",
				"name": "free-extlink"
			}
		]
	},
	{
		"desc": "Link to non-http image, no img tag",
		"wikitext": "Link to non-http image, no img tag: ftp://example.com/test.jpg",
		"tokens": [
			{
				"text": "Link to non-http image, no img tag: ",
				"name": ""
			},
			{
				"text": "ftp://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com/test.jpg",
				"name": "free-extlink"
			}
		]
	},
	{
		"desc": "External links: terminating separator",
		"wikitext": "Terminating separator: http://example.com/thing,",
		"tokens": [
			{
				"text": "Terminating separator: ",
				"name": ""
			},
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com/thing",
				"name": "free-extlink"
			},
			{
				"text": ",",
				"name": ""
			}
		]
	},
	{
		"desc": "External links: intervening separator",
		"wikitext": "Intervening separator: http://example.com/1,2,3",
		"tokens": [
			{
				"text": "Intervening separator: ",
				"name": ""
			},
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com/1,2,3",
				"name": "free-extlink"
			}
		]
	},
	{
		"desc": "External links: old bug with URL in query",
		"wikitext": "Old bug with URL in query: [http://example.com/thing?url=http://example.com link]",
		"tokens": [
			{
				"text": "Old bug with URL in query: ",
				"name": ""
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "example.com/thing?url=http://example.com",
				"name": "link-ground extlink"
			},
			{
				"text": " link",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "External links: old URL-in-URL bug, mixed protocols",
		"wikitext": "And again with mixed protocols: [ftp://example.com?url=http://example.com link]",
		"tokens": [
			{
				"text": "And again with mixed protocols: ",
				"name": ""
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "ftp://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "example.com?url=http://example.com",
				"name": "link-ground extlink"
			},
			{
				"text": " link",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "External links: URL in text",
		"wikitext": "URL in text: [http://example.com http://example.com]",
		"tokens": [
			{
				"text": "URL in text: ",
				"name": ""
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "example.com",
				"name": "link-ground extlink"
			},
			{
				"text": " http://example.com",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "External links: Clickable images",
		"wikitext": "ja-style clickable images: [http://example.com http://meta.wikimedia.org/upload/f/f1/Ncwikicol.png]",
		"tokens": [
			{
				"text": "ja-style clickable images: ",
				"name": ""
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "example.com",
				"name": "link-ground extlink"
			},
			{
				"text": " http://meta.wikimedia.org/upload/f/f1/Ncwikicol.png",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "External links: raw ampersand",
		"wikitext": "Old &amp; use: http://x&y",
		"tokens": [
			{
				"text": "Old ",
				"name": ""
			},
			{
				"text": "&amp;",
				"name": "entity"
			},
			{
				"text": " use: ",
				"name": ""
			},
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "x&y",
				"name": "free-extlink"
			}
		]
	},
	{
		"desc": "External links: encoded ampersand",
		"wikitext": "Old &amp; use: http://x&amp;y",
		"tokens": [
			{
				"text": "Old ",
				"name": ""
			},
			{
				"text": "&amp;",
				"name": "entity"
			},
			{
				"text": " use: ",
				"name": ""
			},
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "x&amp;y",
				"name": "free-extlink"
			}
		]
	},
	{
		"desc": "External links: encoded equals (T8102)",
		"wikitext": "http://example.com/?foo&#61;bar",
		"tokens": [
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com/?foo&#61;bar",
				"name": "free-extlink"
			}
		]
	},
	{
		"desc": "External links: [raw ampersand]",
		"wikitext": "Old &amp; use: [http://x&y]",
		"tokens": [
			{
				"text": "Old ",
				"name": ""
			},
			{
				"text": "&amp;",
				"name": "entity"
			},
			{
				"text": " use: ",
				"name": ""
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "x&y",
				"name": "link-ground extlink"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "External links: [encoded ampersand]",
		"wikitext": "Old &amp; use: [http://x&amp;y]",
		"tokens": [
			{
				"text": "Old ",
				"name": ""
			},
			{
				"text": "&amp;",
				"name": "entity"
			},
			{
				"text": " use: ",
				"name": ""
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "x&amp;y",
				"name": "link-ground extlink"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "External links: [raw equals]",
		"wikitext": "[http://example.com/?foo=bar]",
		"tokens": [
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "example.com/?foo=bar",
				"name": "link-ground extlink"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "External links: [encoded equals] (T8102)",
		"wikitext": "[http://example.com/?foo&#61;bar]",
		"tokens": [
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "example.com/?foo&#61;bar",
				"name": "link-ground extlink"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "External links: [IDN ignored character reference in hostname; strip it right off]",
		"wikitext": "[http://e&zwnj;xample.com/]",
		"tokens": [
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "e&zwnj;xample.com/",
				"name": "link-ground extlink"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "External links: IDN ignored character reference in hostname; strip it right off",
		"wikitext": "http://e&zwnj;xample.com/",
		"tokens": [
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "e&zwnj;xample.com/",
				"name": "free-extlink"
			}
		]
	},
	{
		"desc": "External links: www.jpeg.org (T2554)",
		"wikitext": "http://www.jpeg.org",
		"tokens": [
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "www.jpeg.org",
				"name": "free-extlink"
			}
		]
	},
	{
		"desc": "External links: URL within URL (T2002)",
		"wikitext": "[http://www.unausa.org/newindex.asp?place=http://www.unausa.org/programs/mun.asp]",
		"tokens": [
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "www.unausa.org/newindex.asp?place=http://www.unausa.org/programs/mun.asp",
				"name": "link-ground extlink"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "T2361: URL inside bracketed URL",
		"wikitext": "[http://www.example.com/foo http://www.example.com/bar]",
		"tokens": [
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "www.example.com/foo",
				"name": "link-ground extlink"
			},
			{
				"text": " http://www.example.com/bar",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "T2361: URL within URL, not bracketed",
		"wikitext": "http://www.example.com/foo?=http://www.example.com/bar",
		"tokens": [
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "www.example.com/foo?=http://www.example.com/bar",
				"name": "free-extlink"
			}
		]
	},
	{
		"desc": "T2289: \">\"-token in URL-tail",
		"wikitext": "http://www.example.com/<hello>",
		"tokens": [
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "www.example.com/",
				"name": "free-extlink"
			},
			{
				"text": "<hello>",
				"name": ""
			}
		]
	},
	{
		"desc": "T2289: literal \">\"-token in URL-tail",
		"wikitext": "http://www.example.com/<b>html</b>",
		"tokens": [
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "www.example.com/",
				"name": "free-extlink"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "b",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "html",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "b",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "T2289: \">\"-token in bracketed URL",
		"wikitext": "[http://www.example.com/<hello> stuff]",
		"tokens": [
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "www.example.com/",
				"name": "link-ground extlink"
			},
			{
				"text": "<hello> stuff",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "T2289: literal \">\"-token in bracketed URL",
		"wikitext": "[http://www.example.com/<b>html</b> stuff]",
		"tokens": [
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "www.example.com/",
				"name": "link-ground extlink"
			},
			{
				"text": "<",
				"name": "link-ground htmltag-bracket"
			},
			{
				"text": "b",
				"name": "link-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "link-ground htmltag-bracket"
			},
			{
				"text": "html",
				"name": "link-ground extlink-text"
			},
			{
				"text": "</",
				"name": "link-ground htmltag-bracket"
			},
			{
				"text": "b",
				"name": "link-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "link-ground htmltag-bracket"
			},
			{
				"text": " stuff",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "T2289: literal double quote at end of URL",
		"wikitext": "http://www.example.com/\"hello\"",
		"tokens": [
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "www.example.com/",
				"name": "free-extlink"
			},
			{
				"text": "\"hello\"",
				"name": ""
			}
		]
	},
	{
		"desc": "T2289: literal double quote in bracketed URL",
		"wikitext": "[http://www.example.com/\"hello\" stuff]",
		"tokens": [
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "www.example.com/",
				"name": "link-ground extlink"
			},
			{
				"text": "\"hello\" stuff",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "External links: multiple legal whitespace is fine, Magnus. Don't break it please. (T7081)",
		"wikitext": "[http://www.example.com  test]",
		"tokens": [
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "www.example.com",
				"name": "link-ground extlink"
			},
			{
				"text": "  test",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "External links: link text with spaces",
		"wikitext": "[http://www.example.com a b c]\n[http://www.example.com ''a'' ''b'']",
		"tokens": [
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "www.example.com",
				"name": "link-ground extlink"
			},
			{
				"text": " a b c",
				"name": "link-ground extlink-text"
			},
			{
				"text": "][",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "www.example.com",
				"name": "link-ground extlink"
			},
			{
				"text": " ",
				"name": "link-ground extlink-text"
			},
			{
				"text": "''",
				"name": "link-ground apostrophes"
			},
			{
				"text": "a",
				"name": "link-ground extlink-text em"
			},
			{
				"text": "''",
				"name": "link-ground apostrophes"
			},
			{
				"text": " ",
				"name": "link-ground extlink-text"
			},
			{
				"text": "''",
				"name": "link-ground apostrophes"
			},
			{
				"text": "b",
				"name": "link-ground extlink-text em"
			},
			{
				"text": "''",
				"name": "link-ground apostrophes"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "External links: wiki links within external link (T5695)",
		"wikitext": "[http://example.com [[wikilink]] embedded in ext link]\n\n[http://example.com test [[wikilink]] embedded in ext link]",
		"tokens": [
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "example.com",
				"name": "link-ground extlink"
			},
			{
				"text": " ",
				"name": "link-ground extlink-text"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "wikilink",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " embedded in ext link",
				"name": "link-ground extlink-text"
			},
			{
				"text": "][",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "example.com",
				"name": "link-ground extlink"
			},
			{
				"text": " test ",
				"name": "link-ground extlink-text"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "wikilink",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " embedded in ext link",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "T2787: Links with one slash after the url protocol are invalid",
		"wikitext": "http:/example.com\n\n[http:/example.com title]",
		"tokens": [
			{
				"text": "http:/example.com[http:/example.com title]",
				"name": ""
			}
		]
	},
	{
		"desc": "Bracketed external links with template-generated invalid target",
		"wikitext": "[{{1x|http:/example.com}} title]",
		"tokens": [
			{
				"text": "[",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "http:/example.com",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": " title]",
				"name": ""
			}
		]
	},
	{
		"desc": "T6781: %26 in URL",
		"wikitext": "http://www.example.com/?title=AT%26T",
		"tokens": [
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "www.example.com/?title=AT%26T",
				"name": "free-extlink"
			}
		]
	},
	{
		"desc": "T6781, T7267: %25 in URL",
		"wikitext": "http://www.example.com/?title=100%25_Bran",
		"tokens": [
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "www.example.com/?title=100%25_Bran",
				"name": "free-extlink"
			}
		]
	},
	{
		"desc": "T6781, T7267: %28, %29 in URL",
		"wikitext": "http://www.example.com/?title=Ben-Hur_%281959_film%29",
		"tokens": [
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "www.example.com/?title=Ben-Hur_%281959_film%29",
				"name": "free-extlink"
			}
		]
	},
	{
		"desc": "T6781: %26 in autonumber URL",
		"wikitext": "[http://www.example.com/?title=AT%26T]",
		"tokens": [
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "www.example.com/?title=AT%26T",
				"name": "link-ground extlink"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "T6781, T7267: %26 in autonumber URL",
		"wikitext": "[http://www.example.com/?title=100%25_Bran]",
		"tokens": [
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "www.example.com/?title=100%25_Bran",
				"name": "link-ground extlink"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "T6781, T7267: %28, %29 in autonumber URL",
		"wikitext": "[http://www.example.com/?title=Ben-Hur_%281959_film%29]",
		"tokens": [
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "www.example.com/?title=Ben-Hur_%281959_film%29",
				"name": "link-ground extlink"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "T6781: %26 in bracketed URL",
		"wikitext": "[http://www.example.com/?title=AT%26T link]",
		"tokens": [
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "www.example.com/?title=AT%26T",
				"name": "link-ground extlink"
			},
			{
				"text": " link",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "T6781, T7267: %25 in bracketed URL",
		"wikitext": "[http://www.example.com/?title=100%25_Bran link]",
		"tokens": [
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "www.example.com/?title=100%25_Bran",
				"name": "link-ground extlink"
			},
			{
				"text": " link",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "T6781, T7267: %28, %29 in bracketed URL",
		"wikitext": "[http://www.example.com/?title=Ben-Hur_%281959_film%29 link]",
		"tokens": [
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "www.example.com/?title=Ben-Hur_%281959_film%29",
				"name": "link-ground extlink"
			},
			{
				"text": " link",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "External link containing a period in the anchor. (T65947)",
		"wikitext": "[//foo.org/bar#baz. bang]\n\n[//foo.org/bar. bang]",
		"tokens": [
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "//",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "foo.org/bar#baz.",
				"name": "link-ground extlink"
			},
			{
				"text": " bang",
				"name": "link-ground extlink-text"
			},
			{
				"text": "][",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "//",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "foo.org/bar.",
				"name": "link-ground extlink"
			},
			{
				"text": " bang",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "External link containing a single quote. (T65947)",
		"wikitext": "[//foo.org/bar'baz]\n\n[//foo.org/bar'baz bang]",
		"tokens": [
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "//",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "foo.org/bar'baz",
				"name": "link-ground extlink"
			},
			{
				"text": "][",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "//",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "foo.org/bar'baz",
				"name": "link-ground extlink"
			},
			{
				"text": " bang",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "External link containing double-single-quotes in text '' (T6598 check)",
		"wikitext": "Some [http://example.com/ pretty ''italics'' and stuff]!",
		"tokens": [
			{
				"text": "Some ",
				"name": ""
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "example.com/",
				"name": "link-ground extlink"
			},
			{
				"text": " pretty ",
				"name": "link-ground extlink-text"
			},
			{
				"text": "''",
				"name": "link-ground apostrophes"
			},
			{
				"text": "italics",
				"name": "link-ground extlink-text em"
			},
			{
				"text": "''",
				"name": "link-ground apostrophes"
			},
			{
				"text": " and stuff",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "!",
				"name": ""
			}
		]
	},
	{
		"desc": "External link containing double-single-quotes in text embedded in italics (T6598 check)",
		"wikitext": "''Some [http://example.com/ pretty ''italics'' and stuff]!''",
		"tokens": [
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "Some ",
				"name": "em"
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "example.com/",
				"name": "link-ground extlink"
			},
			{
				"text": " pretty ",
				"name": "link-ground extlink-text em"
			},
			{
				"text": "''",
				"name": "link-ground apostrophes"
			},
			{
				"text": "italics",
				"name": "link-ground extlink-text"
			},
			{
				"text": "''",
				"name": "link-ground apostrophes"
			},
			{
				"text": " and stuff",
				"name": "link-ground extlink-text em"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "!",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "External link containing double-single-quotes with no space separating the url from text in italics",
		"wikitext": "[http://www.musee-picasso.fr/pages/page_id18528_u1l2.htm''La muerte de Casagemas'' (1901) en el sitio de [[Museo Picasso (Par√≠s)|Museo Picasso]].]",
		"tokens": [
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "www.musee-picasso.fr/pages/page_id18528_u1l2.htm",
				"name": "link-ground extlink"
			},
			{
				"text": "''",
				"name": "link-ground apostrophes"
			},
			{
				"text": "La muerte de Casagemas",
				"name": "link-ground extlink-text em"
			},
			{
				"text": "''",
				"name": "link-ground apostrophes"
			},
			{
				"text": " (1901) en el sitio de ",
				"name": "link-ground extlink-text"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Museo Picasso (Par√≠s)",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Museo Picasso",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": ".",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "External link with comments in link text",
		"wikitext": "[http://www.google.com Google <!-- comment -->]",
		"tokens": [
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "www.google.com",
				"name": "link-ground extlink"
			},
			{
				"text": " Google ",
				"name": "link-ground extlink-text"
			},
			{
				"text": "<!-- comment -->",
				"name": "link-ground comment"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "External link to bare IPv4 address",
		"wikitext": "[http://192.168.0.1 Link]",
		"tokens": [
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "192.168.0.1",
				"name": "link-ground extlink"
			},
			{
				"text": " Link",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "URL-encoding in URL functions (single parameter)",
		"wikitext": "{{localurl:Some page|amp=&}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "localurl",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "Some page",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "amp=&",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "URL-encoding in URL functions (multiple parameters)",
		"wikitext": "{{localurl:Some page|q=?&amp=&}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "localurl",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "Some page",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "q=?&amp=&",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Brackets in urls",
		"wikitext": "http://example.com/index.php?foozoid%5B%5D=bar\n\nhttp://example.com/index.php?foozoid&#x5B;&#x5D;=bar",
		"tokens": [
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com/index.php?foozoid%5B%5D=bar",
				"name": "free-extlink"
			},
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com/index.php?foozoid&#x5B;&#x5D;=bar",
				"name": "free-extlink"
			}
		]
	},
	{
		"desc": "IPv6 urls, autolink format (T23261)",
		"wikitext": "http://[2404:130:0:1000::187:2]/index.php\n\nExamples from RFC 2373, section 2.2:\n\n*http://[1080::8:800:200C:417A]/unicast\n*http://[FF01::101]/multicast\n*http://[::1]/loopback\n*http://[::]/unspecified\n*http://[::13.1.68.3]/ipv4compat\n*http://[::FFFF:129.144.52.38]/ipv4compat\n\nExamples from RFC 2732, section 2:\n\n*http://[FEDC:BA98:7654:3210:FEDC:BA98:7654:3210]:80/index.html\n*http://[1080:0:0:0:8:800:200C:417A]/index.html\n*http://[3ffe:2a00:100:7031::1]\n*http://[1080::8:800:200C:417A]/foo\n*http://[::192.9.5.5]/ipng\n*http://[::FFFF:129.144.52.38]:80/index.html\n*http://[2010:836B:4179::836B:4179]",
		"tokens": [
			{
				"text": "http://[2404:130:0:1000::187:2]/index.phpExamples from RFC 2373, section 2.2:",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "http://[1080::8:800:200C:417A]/unicast",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "http://[FF01::101]/multicast",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "http://[::1]/loopback",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "http://[::]/unspecified",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "http://[::13.1.68.3]/ipv4compat",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "http://[::FFFF:129.144.52.38]/ipv4compatExamples from RFC 2732, section 2:",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "http://[FEDC:BA98:7654:3210:FEDC:BA98:7654:3210]:80/index.html",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "http://[1080:0:0:0:8:800:200C:417A]/index.html",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "http://[3ffe:2a00:100:7031::1]",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "http://[1080::8:800:200C:417A]/foo",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "http://[::192.9.5.5]/ipng",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "http://[::FFFF:129.144.52.38]:80/index.html",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "http://[2010:836B:4179::836B:4179]",
				"name": ""
			}
		]
	},
	{
		"desc": "Unicode text around autolinks",
		"wikitext": "gr√∂√ühttps://foo.org\n\ngr√∂√ü https://foo.org\n\nÏïÑÎì§ Í≥†Í±¥ ÏÇ¨ÏßÑhttps://foo.org\n\nüí©https://foo.org",
		"tokens": [
			{
				"text": "gr√∂√ühttps://foo.orggr√∂√ü ",
				"name": ""
			},
			{
				"text": "https://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "foo.org",
				"name": "free-extlink"
			},
			{
				"text": "ÏïÑÎì§ Í≥†Í±¥ ÏÇ¨ÏßÑhttps://foo.orgüí©",
				"name": ""
			},
			{
				"text": "https://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "foo.org",
				"name": "free-extlink"
			}
		]
	},
	{
		"desc": "IPv6 urls, bracketed format (T23261)",
		"wikitext": "[http://[2404:130:0:1000::187:2]/index.php test]\n\nExamples from RFC 2373, section 2.2:\n\n*[http://[1080::8:800:200C:417A] unicast]\n*[http://[FF01::101] multicast]\n*[http://[::1]/ loopback]\n*[http://[::] unspecified]\n*[http://[::13.1.68.3] ipv4compat]\n*[http://[::FFFF:129.144.52.38] ipv4compat]\n\nExamples from RFC 2732, section 2:\n\n*[http://[FEDC:BA98:7654:3210:FEDC:BA98:7654:3210]:80/index.html 1]\n*[http://[1080:0:0:0:8:800:200C:417A]/index.html 2]\n*[http://[3ffe:2a00:100:7031::1] 3]\n*[http://[1080::8:800:200C:417A]/foo 4]\n*[http://[::192.9.5.5]/ipng 5]\n*[http://[::FFFF:129.144.52.38]:80/index.html 6]\n*[http://[2010:836B:4179::836B:4179] 7]",
		"tokens": [
			{
				"text": "[http://[2404:130:0:1000::187:2]/index.php test]Examples from RFC 2373, section 2.2:",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "[http://[1080::8:800:200C:417A] unicast]",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "[http://[FF01::101] multicast]",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "[http://[::1]/ loopback]",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "[http://[::] unspecified]",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "[http://[::13.1.68.3] ipv4compat]",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "[http://[::FFFF:129.144.52.38] ipv4compat]Examples from RFC 2732, section 2:",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "[http://[FEDC:BA98:7654:3210:FEDC:BA98:7654:3210]:80/index.html 1]",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "[http://[1080:0:0:0:8:800:200C:417A]/index.html 2]",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "[http://[3ffe:2a00:100:7031::1] 3]",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "[http://[1080::8:800:200C:417A]/foo 4]",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "[http://[::192.9.5.5]/ipng 5]",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "[http://[::FFFF:129.144.52.38]:80/index.html 6]",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "[http://[2010:836B:4179::836B:4179] 7]",
				"name": ""
			}
		]
	},
	{
		"desc": "Non-extlinks in brackets",
		"wikitext": "[foo]\n[foo bar]\n[foo ''bar'']\n[fool's] errand\n[fool's errand]\n[{{1x|foo}}]\n[{{1x|foo}} bar]\n[{{1x|foo}} ''bar'']\n[{{1x|foo}}l's] errand\n[{{1x|foo}}l's errand]\n[url={{1x|foo}}]\n[url=http://example.com]\n[http:// bare protocols don't count]",
		"tokens": [
			{
				"text": "[foo][foo bar][foo ",
				"name": ""
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "bar",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "][fool's] errand[fool's errand][",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "foo",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "][",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "foo",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": " bar][",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "foo",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "bar",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "][",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "foo",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "l's] errand[",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "foo",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "l's errand][url=",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "foo",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "][url=",
				"name": ""
			},
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com",
				"name": "free-extlink"
			},
			{
				"text": "][http:// bare protocols don't count]",
				"name": ""
			}
		]
	},
	{
		"desc": "Percent encoding in external links",
		"wikitext": "[https://github.com/search?l=&q=ResourceLoader+%40wikimedia Search]",
		"tokens": [
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "https://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "github.com/search?l=&q=ResourceLoader+%40wikimedia",
				"name": "link-ground extlink"
			},
			{
				"text": " Search",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "Use url link syntax for links where the content is equal the link target",
		"wikitext": "http://example.com",
		"tokens": [
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com",
				"name": "free-extlink"
			}
		]
	},
	{
		"desc": "Parenthesis in external links, especially URL links",
		"wikitext": "http://example.com)\n\nhttp://example.com/test)\n\nhttp://example.com/(test)\n\nhttp://example.com/((test)\n\n(http://example.com/(test))\n\n(http://example.com/(test)))))\n\nhttp://example.com/a)b\n\n[http://example.com) foo]",
		"tokens": [
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com",
				"name": "free-extlink"
			},
			{
				"text": ")",
				"name": ""
			},
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com/test",
				"name": "free-extlink"
			},
			{
				"text": ")",
				"name": ""
			},
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com/(test)",
				"name": "free-extlink"
			},
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com/((test)",
				"name": "free-extlink"
			},
			{
				"text": "(",
				"name": ""
			},
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com/(test))",
				"name": "free-extlink"
			},
			{
				"text": "(",
				"name": ""
			},
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com/(test)))))",
				"name": "free-extlink"
			},
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com/a)b",
				"name": "free-extlink"
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "example.com)",
				"name": "link-ground extlink"
			},
			{
				"text": " foo",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "Parenthesis in external links, w/ transclusion or comment",
		"wikitext": "(http://example.com/{{1x|hi}})\n\n(http://example.com<!-- hi -->)",
		"tokens": [
			{
				"text": "(",
				"name": ""
			},
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com/",
				"name": "free-extlink"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "hi",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": ")(",
				"name": ""
			},
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com",
				"name": "free-extlink"
			},
			{
				"text": "<!-- hi -->",
				"name": "comment"
			},
			{
				"text": ")",
				"name": ""
			}
		]
	},
	{
		"desc": "Extlink in square brackets with entity",
		"wikitext": "[&nbsp;[http://test.com 123]&nbsp;]\n\n[http://test.com [123]",
		"tokens": [
			{
				"text": "[",
				"name": ""
			},
			{
				"text": "&nbsp;",
				"name": "entity"
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "test.com",
				"name": "link-ground extlink"
			},
			{
				"text": " 123",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "&nbsp;",
				"name": "entity"
			},
			{
				"text": "]",
				"name": ""
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "test.com",
				"name": "link-ground extlink"
			},
			{
				"text": " [123",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			}
		]
	},
	{
		"desc": "indentPre"
	},
	{
		"desc": "Preformatted text",
		"wikitext": " This is some\n Preformatted text\n With ''italic''\n And '''bold'''\n And a [[Main Page|link]]",
		"tokens": [
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "This is some",
				"name": ""
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "Preformatted text",
				"name": ""
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "With ",
				"name": ""
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "italic",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "And ",
				"name": ""
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "bold",
				"name": "strong"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "And a ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Tabs don't trigger preformatted text",
		"wikitext": "\tThis is not\n\t preformatted text.\n This is preformatted text.\n \tSo is this.",
		"tokens": [
			{
				"text": "\tThis is not\t preformatted text.",
				"name": ""
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "This is preformatted text.",
				"name": ""
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "\tSo is this.",
				"name": ""
			}
		]
	},
	{
		"desc": "Indent preformatting with inline content",
		"wikitext": " a\n ''b''",
		"tokens": [
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "b",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "<pre> with <nowiki> inside (compatibility with 1.6 and earlier)",
		"wikitext": "<pre><nowiki>\n<b>\n<cite>\n<em>\n</nowiki></pre>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "<nowiki><b><cite><em></nowiki>",
				"name": "tag-pre"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Regression with preformatted in <center>",
		"wikitext": "<center>\n Blah\n</center>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "center",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "Blah",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "center",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "T54763: Preformatted in <blockquote>",
		"wikitext": "<blockquote>\n Blah\n{|\n|\n indented cell (no pre-wrapping!)\n|}\n</blockquote>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "blockquote",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "Blah",
				"name": ""
			},
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": " indented cell (no pre-wrapping!)",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "blockquote",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Templates: Indent-Pre: 1a. Templates that break a line should suppress <pre>",
		"wikitext": " {{1x|}}",
		"tokens": [
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates: Indent-Pre: 1b. Templates that break a line should suppress <pre>",
		"wikitext": " {{1x|\nfoo}}",
		"tokens": [
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "foo",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates: Indent-Pre: 1c: Wrapping should be based on expanded content",
		"wikitext": " {{1x|a\nb}}",
		"tokens": [
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "ab",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates: Indent-Pre: 1d: Wrapping should be based on expanded content",
		"wikitext": " {{1x|a\nb\nc\n d\ne\n}}",
		"tokens": [
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "abc de",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates: Indent-Pre: 1e. Wrapping should be based on expanded content",
		"wikitext": "{{1x| foo}}\n\n{{1x| foo}}{{1x| bar}}\n\n{{1x| foo}}\n{{1x| bar}}\n\n{{1x|<!--cmt--> foo}}\n\n<!--cmt-->{{1x| foo}}\n\n{{1x|{{1x| }}bar}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": " foo",
				"name": "template-ground template"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": " foo",
				"name": "template-ground template"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": " bar",
				"name": "template-ground template"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": " foo",
				"name": "template-ground template"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": " bar",
				"name": "template-ground template"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "<!--cmt-->",
				"name": "template-ground comment"
			},
			{
				"text": " foo",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "<!--cmt-->",
				"name": "comment"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": " foo",
				"name": "template-ground template"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "{{",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template2-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template2-ground template-delimiter"
			},
			{
				"text": " }}",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "bar",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates: Indent-Pre: 1f: Wrapping should be based on expanded content",
		"wikitext": "{{1x| }}a\n\n{{1x|\n }}a\n\n{{1x|\n b}}\n\n{{1x|a\n }}b\n\n{{1x|a\n}} b",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": " }}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": " }}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": " b",
				"name": "template-ground template"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "a",
				"name": "template-ground template"
			},
			{
				"text": " }}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "b",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "a",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": " b",
				"name": ""
			}
		]
	},
	{
		"desc": "Off-by-1 DSR values: Regression test for indent-pre usages",
		"wikitext": " {{1x|\n}} ''{{1x|\n}} X'' {{1x|<span></span>\n}} Y",
		"tokens": [
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": " X",
				"name": ""
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": " ",
				"name": "em"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "<",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "span",
				"name": "template-ground htmltag-name"
			},
			{
				"text": "></",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "span",
				"name": "template-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "template-ground htmltag-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": " Y",
				"name": ""
			}
		]
	},
	{
		"desc": "Ensure DSR values for mw:DisplaySpace spans are computed correctly",
		"wikitext": " x\n y :)",
		"tokens": [
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "x",
				"name": ""
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "y :)",
				"name": ""
			}
		]
	},
	{
		"desc": "1a. Indent-Pre and Comments",
		"wikitext": " a\n<!--a-->\nc",
		"tokens": [
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": "<!--a-->",
				"name": "comment"
			},
			{
				"text": "c",
				"name": ""
			}
		]
	},
	{
		"desc": "1b. Indent-Pre and Comments",
		"wikitext": " a\n <!--a-->\nc",
		"tokens": [
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "<!--a-->",
				"name": "comment"
			},
			{
				"text": "c",
				"name": ""
			}
		]
	},
	{
		"desc": "1c. Indent-Pre and Comments",
		"wikitext": "<!--a-->  a\n\n <!--a--> a",
		"tokens": [
			{
				"text": "<!--a-->",
				"name": "comment"
			},
			{
				"text": "  a",
				"name": ""
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "<!--a-->",
				"name": "comment"
			},
			{
				"text": " a",
				"name": ""
			}
		]
	},
	{
		"desc": "1d. Indent-Pre and Comments\n(Pre-handler currently cannot distinguish between comment/ws order and normalizes them to [comment,ws] order)",
		"wikitext": "<!--a--> a\n\n <!--b-->b",
		"tokens": [
			{
				"text": "<!--a-->",
				"name": "comment"
			},
			{
				"text": " a",
				"name": ""
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "<!--b-->",
				"name": "comment"
			},
			{
				"text": "b",
				"name": ""
			}
		]
	},
	{
		"desc": "2a. Indent-Pre and tables",
		"wikitext": " {|\n |-\n !h1!!h2\n |foo||bar\n |}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": " |- !",
				"name": "table-delimiter"
			},
			{
				"text": "h1",
				"name": "strong"
			},
			{
				"text": "!!",
				"name": "table-delimiter"
			},
			{
				"text": "h2",
				"name": "strong"
			},
			{
				"text": " |",
				"name": "table-delimiter"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "||",
				"name": "table-delimiter"
			},
			{
				"text": "bar",
				"name": ""
			},
			{
				"text": " |}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "2b. Indent-Pre and tables",
		"wikitext": "  {|\n |-\n|foo\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": " |-|",
				"name": "table-delimiter"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "2c. Indent-Pre and tables (T44252)",
		"wikitext": "{|\n |+foo\n !  |bar\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": " |+",
				"name": "table-delimiter"
			},
			{
				"text": "foo",
				"name": "table-caption"
			},
			{
				"text": " !  ",
				"name": "table-delimiter"
			},
			{
				"text": "|",
				"name": "table-delimiter2"
			},
			{
				"text": "bar",
				"name": "strong"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "2d. Indent-Pre and tables",
		"wikitext": " a\n {|\n |b\n |}",
		"tokens": [
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": " |",
				"name": "table-delimiter"
			},
			{
				"text": "b",
				"name": ""
			},
			{
				"text": " |}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "2e. Indent-Pre and table-line syntax",
		"wikitext": " a\n | b\n | c",
		"tokens": [
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "| b",
				"name": ""
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "| c",
				"name": ""
			}
		]
	},
	{
		"desc": "2f. Indent-pre started by table-line syntax",
		"wikitext": "a\n | b\n | c",
		"tokens": [
			{
				"text": "a",
				"name": ""
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "| b",
				"name": ""
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "| c",
				"name": ""
			}
		]
	},
	{
		"desc": "2g. Indented table markup mixed with indented pre content (proposed in T8200)",
		"wikitext": " <table>\n <tr>\n <td>\n Text that should be rendered preformatted\n </td>\n </tr>\n </table>",
		"tokens": [
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "tr",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "Text that should be rendered preformatted",
				"name": ""
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "tr",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "2h. Indent pre in tables",
		"wikitext": "{|\n !\n foo\n !\n bar\n |-\n |\n baz\n {{!}}\n bam\n |}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": " !",
				"name": "table-delimiter"
			},
			{
				"text": " foo",
				"name": "strong"
			},
			{
				"text": " !",
				"name": "table-delimiter"
			},
			{
				"text": " bar",
				"name": "strong"
			},
			{
				"text": " |- |",
				"name": "table-delimiter"
			},
			{
				"text": " baz",
				"name": ""
			},
			{
				"text": " {{!}}",
				"name": "table-delimiter"
			},
			{
				"text": " bam",
				"name": ""
			},
			{
				"text": " |}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "3a. Indent-Pre and block tags (single-line html)",
		"wikitext": " a <p> foo </p>\n b <div> foo </div>\n c <blockquote> foo </blockquote>\n <span> foo </span>",
		"tokens": [
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "a ",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "p",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " foo ",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "p",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "b ",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " foo ",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "c ",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "blockquote",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " foo ",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "blockquote",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "span",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " foo ",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "span",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "3b. Indent-Pre and block tags (multi-line html)",
		"wikitext": " a <span>foo</span>\n<!-- comment --> b <div> foo </div>",
		"tokens": [
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "a ",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "span",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "span",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "<!-- comment -->",
				"name": "comment"
			},
			{
				"text": " b ",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " foo ",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "3c. Indent-Pre and block tags (pre-content on separate line)",
		"wikitext": "<p>\n foo\n</p>\n\n<div>\n foo\n</div>\n\n<center>\n foo\n</center>\n\n<blockquote>\n foo\n</blockquote>\n\n<blockquote>\n<pre>\nfoo\n</pre>\n</blockquote>\n\n<table><tr><td>\n foo\n</td></tr></table>\n\n<ul><li>\n  foo\n</li></ul>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "p",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "p",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "center",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "center",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "blockquote",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "blockquote",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "blockquote",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "foo",
				"name": "tag-pre"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "blockquote",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "tr",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "tr",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "ul",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": " foo",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "ul",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "5. Indent-Pre and html pre",
		"wikitext": " <pre class=\"123\">hi</pre>",
		"tokens": [
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "pre ",
				"name": "exttag-name"
			},
			{
				"text": "class=\"123\"",
				"name": "exttag-attribute ext-pre"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "hi",
				"name": "tag-pre"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Serializing indent pre at sol",
		"wikitext": " hi",
		"tokens": [
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "hi",
				"name": ""
			}
		]
	},
	{
		"desc": "Render paragraphs when indent-pre is suppressed in blocklevels",
		"wikitext": "<blockquote>\n foo\n\n bar\n</blockquote>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "blockquote",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "bar",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "blockquote",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "4. Multiple spaces at start-of-line",
		"wikitext": "    <p> foo </p>\n    foo\n\t{|\n|foo\n|}",
		"tokens": [
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "   ",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "p",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " foo ",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "p",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "   foo\t{||foo|}",
				"name": ""
			}
		]
	},
	{
		"desc": "5a. White-space in indent-pre",
		"wikitext": " a<br />\n \n b",
		"tokens": [
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "br ",
				"name": "htmltag-name"
			},
			{
				"text": "/>",
				"name": "htmltag-bracket"
			},
			{
				"text": "  ",
				"name": "skipformatting"
			},
			{
				"text": "b",
				"name": ""
			}
		]
	},
	{
		"desc": "5b. White-space in indent-pre",
		"wikitext": " a\n \n b\n \n \n c",
		"tokens": [
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": "  ",
				"name": "skipformatting"
			},
			{
				"text": "b",
				"name": ""
			},
			{
				"text": "   ",
				"name": "skipformatting"
			},
			{
				"text": "c",
				"name": ""
			}
		]
	},
	{
		"desc": "5c. White-space in indent-pre",
		"wikitext": " ''a''\n  ''b''\n   ''c''",
		"tokens": [
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "a",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "b",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "  ",
				"name": ""
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "c",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "6. Pre-blocks should extend across lines with leading WS even when there is no wrappable content",
		"wikitext": " a\n \n <!-- continue -->\n b\n\n c\n \nd",
		"tokens": [
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": "  ",
				"name": "skipformatting"
			},
			{
				"text": "<!-- continue -->",
				"name": "comment"
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "b",
				"name": ""
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "c",
				"name": ""
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "d",
				"name": ""
			}
		]
	},
	{
		"desc": "7a. Indent-pre and category links",
		"wikitext": " [[Category:foo]] <!-- No pre-wrapping -->\n{{1x| [[Category:foo]]}} <!-- No pre-wrapping -->",
		"tokens": [
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Category:foo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "<!-- No pre-wrapping -->",
				"name": "comment"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": " ",
				"name": "template-ground template"
			},
			{
				"text": "[[",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "Category:foo",
				"name": "template-link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "<!-- No pre-wrapping -->",
				"name": "comment"
			}
		]
	},
	{
		"desc": "Indent-Pre: Newlines in comments shouldn't affect sol state",
		"wikitext": "a <!--\nfoo\n--> b",
		"tokens": [
			{
				"text": "a ",
				"name": ""
			},
			{
				"text": "<!--foo-->",
				"name": "comment"
			},
			{
				"text": " b",
				"name": ""
			}
		]
	},
	{
		"desc": "Indent pre with leading colon",
		"wikitext": " :foo",
		"tokens": [
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": ":foo",
				"name": ""
			}
		]
	},
	{
		"desc": "Indent-Pre regression test: Trailing whitespace after sol-transparent content",
		"wikitext": "[[Category:Foo]]   \n[[Category:Bar]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Category:Foo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "   ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Category:Bar",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Preserving leading whitespace in indent-pre suppressing contexts",
		"wikitext": "<ol>\n<li>\n foo\n bar\n</li>\n</ol>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "ol",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "bar",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "li",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "ol",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "indicators"
	},
	{
		"desc": "Page status indicators: Empty name is invalid",
		"wikitext": "<indicator name=\" \"></indicator>\n<indicator></indicator>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "indicator ",
				"name": "exttag-name"
			},
			{
				"text": "name=\" \"",
				"name": "exttag-attribute ext-indicator"
			},
			{
				"text": "></",
				"name": "exttag-bracket"
			},
			{
				"text": "indicator",
				"name": "exttag-name"
			},
			{
				"text": "><",
				"name": "exttag-bracket"
			},
			{
				"text": "indicator",
				"name": "exttag-name"
			},
			{
				"text": "></",
				"name": "exttag-bracket"
			},
			{
				"text": "indicator",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Page status indicators: Weird syntaxes that are okay",
		"wikitext": "<indicator name=\"empty\" />\n<indicator name=\"name\"></indicator>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "indicator ",
				"name": "exttag-name"
			},
			{
				"text": "name=\"empty\" ",
				"name": "exttag-attribute ext-indicator"
			},
			{
				"text": "/><",
				"name": "exttag-bracket"
			},
			{
				"text": "indicator ",
				"name": "exttag-name"
			},
			{
				"text": "name=\"name\"",
				"name": "exttag-attribute ext-indicator"
			},
			{
				"text": "></",
				"name": "exttag-bracket"
			},
			{
				"text": "indicator",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Page status indicators: Stress test",
		"wikitext": "<indicator name=\"01\">hello world</indicator>\n<indicator name=\"02\">[[Main Page]]</indicator>\n<indicator name=\"03\">[[File:Foobar.jpg|25px|link=]]</indicator>\n<indicator name=\"04\">[[File:Foobar.jpg|25px]]</indicator>\n<indicator name=\"05\">*foo\n*bar</indicator>\n<indicator name=\"06\"><nowiki>foo</nowiki></indicator>\n<indicator name=\"07\"> Preformatted</indicator>\n<indicator name=\"08\"><div>Broken tag</indicator>\n<indicator name=\"09\">{| class=wikitable\n|cell\n|}</indicator>\n<indicator name=\"10\">Two\n\nparagraphs</indicator>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "indicator ",
				"name": "exttag-name"
			},
			{
				"text": "name=\"01\"",
				"name": "exttag-attribute ext-indicator"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "hello world",
				"name": "tag-indicator"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "indicator",
				"name": "exttag-name"
			},
			{
				"text": "><",
				"name": "exttag-bracket"
			},
			{
				"text": "indicator ",
				"name": "exttag-name"
			},
			{
				"text": "name=\"02\"",
				"name": "exttag-attribute ext-indicator"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "[[",
				"name": "tag-indicator link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "tag-indicator link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "tag-indicator link-ground link-bracket"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "indicator",
				"name": "exttag-name"
			},
			{
				"text": "><",
				"name": "exttag-bracket"
			},
			{
				"text": "indicator ",
				"name": "exttag-name"
			},
			{
				"text": "name=\"03\"",
				"name": "exttag-attribute ext-indicator"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "[[",
				"name": "tag-indicator link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "tag-indicator link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "tag-indicator link-ground link-delimiter"
			},
			{
				"text": "25px",
				"name": "tag-indicator link-ground file-text"
			},
			{
				"text": "|",
				"name": "tag-indicator link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "tag-indicator link-ground image-parameter"
			},
			{
				"text": "]]",
				"name": "tag-indicator link-ground link-bracket"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "indicator",
				"name": "exttag-name"
			},
			{
				"text": "><",
				"name": "exttag-bracket"
			},
			{
				"text": "indicator ",
				"name": "exttag-name"
			},
			{
				"text": "name=\"04\"",
				"name": "exttag-attribute ext-indicator"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "[[",
				"name": "tag-indicator link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "tag-indicator link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "tag-indicator link-ground link-delimiter"
			},
			{
				"text": "25px",
				"name": "tag-indicator link-ground file-text"
			},
			{
				"text": "]]",
				"name": "tag-indicator link-ground link-bracket"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "indicator",
				"name": "exttag-name"
			},
			{
				"text": "><",
				"name": "exttag-bracket"
			},
			{
				"text": "indicator ",
				"name": "exttag-name"
			},
			{
				"text": "name=\"05\"",
				"name": "exttag-attribute ext-indicator"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "*foo",
				"name": "tag-indicator"
			},
			{
				"text": "*",
				"name": "tag-indicator list"
			},
			{
				"text": "bar",
				"name": "tag-indicator"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "indicator",
				"name": "exttag-name"
			},
			{
				"text": "><",
				"name": "exttag-bracket"
			},
			{
				"text": "indicator ",
				"name": "exttag-name"
			},
			{
				"text": "name=\"06\"",
				"name": "exttag-attribute ext-indicator"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "<",
				"name": "tag-indicator exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "tag-indicator exttag-name"
			},
			{
				"text": ">",
				"name": "tag-indicator exttag-bracket"
			},
			{
				"text": "foo",
				"name": "tag-indicator tag-nowiki"
			},
			{
				"text": "</",
				"name": "tag-indicator exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "tag-indicator exttag-name"
			},
			{
				"text": ">",
				"name": "tag-indicator exttag-bracket"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "indicator",
				"name": "exttag-name"
			},
			{
				"text": "><",
				"name": "exttag-bracket"
			},
			{
				"text": "indicator ",
				"name": "exttag-name"
			},
			{
				"text": "name=\"07\"",
				"name": "exttag-attribute ext-indicator"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": " Preformatted",
				"name": "tag-indicator"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "indicator",
				"name": "exttag-name"
			},
			{
				"text": "><",
				"name": "exttag-bracket"
			},
			{
				"text": "indicator ",
				"name": "exttag-name"
			},
			{
				"text": "name=\"08\"",
				"name": "exttag-attribute ext-indicator"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "<",
				"name": "tag-indicator htmltag-bracket"
			},
			{
				"text": "div",
				"name": "tag-indicator htmltag-name"
			},
			{
				"text": ">",
				"name": "tag-indicator htmltag-bracket"
			},
			{
				"text": "Broken tag",
				"name": "tag-indicator"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "indicator",
				"name": "exttag-name"
			},
			{
				"text": "><",
				"name": "exttag-bracket"
			},
			{
				"text": "indicator ",
				"name": "exttag-name"
			},
			{
				"text": "name=\"09\"",
				"name": "exttag-attribute ext-indicator"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "{| class=wikitable|cell|}",
				"name": "tag-indicator"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "indicator",
				"name": "exttag-name"
			},
			{
				"text": "><",
				"name": "exttag-bracket"
			},
			{
				"text": "indicator ",
				"name": "exttag-name"
			},
			{
				"text": "name=\"10\"",
				"name": "exttag-attribute ext-indicator"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "Twoparagraphs",
				"name": "tag-indicator"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "indicator",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Decoding of HTML entities in indicator names for IDs (T104196)",
		"wikitext": "<indicator name=\"1&2&amp;3&amp;amp;4&amp;amp;amp;5\">Indicator</indicator>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "indicator ",
				"name": "exttag-name"
			},
			{
				"text": "name=\"1&2&amp;3&amp;amp;4&amp;amp;amp;5\"",
				"name": "exttag-attribute ext-indicator"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "Indicator",
				"name": "tag-indicator"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "indicator",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Decoding of HTML entities in indicator names for IDs (unambiguous) (T104196)",
		"wikitext": "<indicator name=\"1&2&3&amp;amp;4&amp;amp;amp;5\">Indicator</indicator>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "indicator ",
				"name": "exttag-name"
			},
			{
				"text": "name=\"1&2&3&amp;amp;4&amp;amp;amp;5\"",
				"name": "exttag-attribute ext-indicator"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "Indicator",
				"name": "tag-indicator"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "indicator",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Indicators with duplicate names: Last one wins",
		"wikitext": "<indicator name=\"x\">foo</indicator>\n<indicator name=\"x\">bar</indicator>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "indicator ",
				"name": "exttag-name"
			},
			{
				"text": "name=\"x\"",
				"name": "exttag-attribute ext-indicator"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "foo",
				"name": "tag-indicator"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "indicator",
				"name": "exttag-name"
			},
			{
				"text": "><",
				"name": "exttag-bracket"
			},
			{
				"text": "indicator ",
				"name": "exttag-name"
			},
			{
				"text": "name=\"x\"",
				"name": "exttag-attribute ext-indicator"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "bar",
				"name": "tag-indicator"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "indicator",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Templates where an indicator is the leading content (1)",
		"wikitext": "abcd\n{{1x|<indicator name=\"x\">foo</indicator>}}",
		"tokens": [
			{
				"text": "abcd",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "<",
				"name": "template-ground exttag-bracket"
			},
			{
				"text": "indicator ",
				"name": "template-ground exttag-name"
			},
			{
				"text": "name=\"x\"",
				"name": "template-ground exttag-attribute ext-indicator"
			},
			{
				"text": ">",
				"name": "template-ground exttag-bracket"
			},
			{
				"text": "foo",
				"name": "tag-indicator"
			},
			{
				"text": "</",
				"name": "template-ground exttag-bracket"
			},
			{
				"text": "indicator",
				"name": "template-ground exttag-name"
			},
			{
				"text": ">",
				"name": "template-ground exttag-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates where an indicator is the leading content (2)",
		"wikitext": "abcd\n<indicator name=\"x\">bar</indicator>\n{{1x|<indicator name=\"x\">foo</indicator>}}",
		"tokens": [
			{
				"text": "abcd",
				"name": ""
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "indicator ",
				"name": "exttag-name"
			},
			{
				"text": "name=\"x\"",
				"name": "exttag-attribute ext-indicator"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "bar",
				"name": "tag-indicator"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "indicator",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "<",
				"name": "template-ground exttag-bracket"
			},
			{
				"text": "indicator ",
				"name": "template-ground exttag-name"
			},
			{
				"text": "name=\"x\"",
				"name": "template-ground exttag-attribute ext-indicator"
			},
			{
				"text": ">",
				"name": "template-ground exttag-bracket"
			},
			{
				"text": "foo",
				"name": "tag-indicator"
			},
			{
				"text": "</",
				"name": "template-ground exttag-bracket"
			},
			{
				"text": "indicator",
				"name": "template-ground exttag-name"
			},
			{
				"text": ">",
				"name": "template-ground exttag-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates where an indicator is not the leading content (1)",
		"wikitext": "abcd\n{{1x|efgh<indicator name=\"x\">foo</indicator>}}",
		"tokens": [
			{
				"text": "abcd",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "efgh",
				"name": "template-ground template"
			},
			{
				"text": "<",
				"name": "template-ground exttag-bracket"
			},
			{
				"text": "indicator ",
				"name": "template-ground exttag-name"
			},
			{
				"text": "name=\"x\"",
				"name": "template-ground exttag-attribute ext-indicator"
			},
			{
				"text": ">",
				"name": "template-ground exttag-bracket"
			},
			{
				"text": "foo",
				"name": "tag-indicator"
			},
			{
				"text": "</",
				"name": "template-ground exttag-bracket"
			},
			{
				"text": "indicator",
				"name": "template-ground exttag-name"
			},
			{
				"text": ">",
				"name": "template-ground exttag-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templates where an indicator is not the leading content (2)",
		"wikitext": "abcd\n<indicator name=\"x\">bar</indicator>\n{{1x|efgh<indicator name=\"x\">foo</indicator>}}",
		"tokens": [
			{
				"text": "abcd",
				"name": ""
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "indicator ",
				"name": "exttag-name"
			},
			{
				"text": "name=\"x\"",
				"name": "exttag-attribute ext-indicator"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "bar",
				"name": "tag-indicator"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "indicator",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "efgh",
				"name": "template-ground template"
			},
			{
				"text": "<",
				"name": "template-ground exttag-bracket"
			},
			{
				"text": "indicator ",
				"name": "template-ground exttag-name"
			},
			{
				"text": "name=\"x\"",
				"name": "template-ground exttag-attribute ext-indicator"
			},
			{
				"text": ">",
				"name": "template-ground exttag-bracket"
			},
			{
				"text": "foo",
				"name": "tag-indicator"
			},
			{
				"text": "</",
				"name": "template-ground exttag-bracket"
			},
			{
				"text": "indicator",
				"name": "template-ground exttag-name"
			},
			{
				"text": ">",
				"name": "template-ground exttag-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "legacyMedia"
	},
	{
		"desc": "Simple image",
		"wikitext": "[[Image:foobar.jpg]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Simple image redirect",
		"wikitext": "[[Image:Redirect to foobar.jpg]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:Redirect to foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Simple image (using File: namespace, now canonical)",
		"wikitext": "[[File:Foobar.jpg]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Right-aligned image",
		"wikitext": "[[File:Foobar.jpg|right]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "right",
				"name": "link-ground image-parameter"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with caption",
		"wikitext": "[[File:Foobar.jpg|right|Caption text]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "right",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Caption text",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with caption, T55312 #1",
		"wikitext": "[[File:Foobar.jpg|right|Caption page stuff]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "right",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Caption page stuff",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with caption, T55312 #2",
		"wikitext": "[[File:Foobar.jpg|right|Caption page=]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "right",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Caption page=",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with caption, T55312 #3",
		"wikitext": "[[File:Foobar.jpg|right|Caption page=stuff]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "right",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Caption page=stuff",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image caption with pipe entity",
		"wikitext": "[[File:Foobar.jpg|thumb|one &#x7C; two]]\n[[File:Foobar.jpg|thumb|one ''two'' &#x7C; three]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "one ",
				"name": "link-ground file-text"
			},
			{
				"text": "&#x7C;",
				"name": "link-ground entity"
			},
			{
				"text": " two",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "one ",
				"name": "link-ground file-text"
			},
			{
				"text": "''",
				"name": "link-ground apostrophes"
			},
			{
				"text": "two",
				"name": "link-ground file-text em"
			},
			{
				"text": "''",
				"name": "link-ground apostrophes"
			},
			{
				"text": " ",
				"name": "link-ground file-text"
			},
			{
				"text": "&#x7C;",
				"name": "link-ground entity"
			},
			{
				"text": " three",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Bad images - basic functionality",
		"wikitext": "[[File:Bad.jpg]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Bad.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Bad images - T18039: text after bad image disappears",
		"wikitext": "Foo bar\n[[File:Bad.jpg]]\nBar foo",
		"tokens": [
			{
				"text": "Foo bar",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Bad.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Bar foo",
				"name": ""
			}
		]
	},
	{
		"desc": "Bad images - manualthumb",
		"wikitext": "[[File:Foobar.jpg|thumbnail=Bad.jpg|Uh oh]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumbnail=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Bad.jpg",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Uh oh",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Bad images - in gallery",
		"wikitext": "<gallery>\nFile:Bad.jpg\n</gallery>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Bad.jpg",
				"name": "tag-gallery"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Allow empty links in image captions (T62753)",
		"wikitext": "[[File:Foobar.jpg|thumb|Caption [[Link1]]\n[[]]\n[[Link2]]\n]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Caption ",
				"name": "link-ground file-text"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Link1",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "[[",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Link2",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "]]",
				"name": ""
			}
		]
	},
	{
		"desc": "Titles in unlinked images (T23454)",
		"wikitext": "[[File:Foobar.jpg|link=|stuff]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "stuff",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Link with empty target",
		"wikitext": "[[]]",
		"tokens": [
			{
				"text": "[[]]",
				"name": ""
			}
		]
	},
	{
		"desc": "Image with link trail",
		"wikitext": "Linktrails should not work for images: [[File:Foobar.jpg]]s",
		"tokens": [
			{
				"text": "Linktrails should not work for images: ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "s",
				"name": ""
			}
		]
	},
	{
		"desc": "Image with empty attribute",
		"wikitext": "[[File:Foobar.jpg|right||Caption text]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "right",
				"name": "link-ground image-parameter"
			},
			{
				"text": "||",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Caption text",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "1. Block image with individual attributes from templates",
		"wikitext": "[[File:Foobar.jpg|thumb|{{1x|137px}}|This is a caption]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground template-delimiter"
			},
			{
				"text": "137px",
				"name": "template-link-ground template"
			},
			{
				"text": "}}",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "This is a caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "2. Block Image with individual attributes from templates",
		"wikitext": "[[File:Foobar.jpg|{{1x|thumb}}|{{1x|137px}}|This is a caption]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground template-delimiter"
			},
			{
				"text": "thumb",
				"name": "template-link-ground template"
			},
			{
				"text": "}}",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground template-delimiter"
			},
			{
				"text": "137px",
				"name": "template-link-ground template"
			},
			{
				"text": "}}",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "This is a caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "3. Inline image with individual attributes from templates",
		"wikitext": "[[File:Foobar.jpg|{{1x|50px}}]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground template-delimiter"
			},
			{
				"text": "50px",
				"name": "template-link-ground template"
			},
			{
				"text": "}}",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with multiple attributes from the same template",
		"wikitext": "[[File:Foobar.jpg|{{image_attribs}}]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "image_attribs",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with link tails",
		"wikitext": "123[[File:Foobar.jpg]]456\n123[[File:Foobar.jpg|right]]456\n123[[File:Foobar.jpg|thumb]]456",
		"tokens": [
			{
				"text": "123",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "456123",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "right",
				"name": "link-ground image-parameter"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "456123",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "456",
				"name": ""
			}
		]
	},
	{
		"desc": "Image with multiple captions -- only last one is accepted",
		"wikitext": "[[File:Foobar.jpg|right|Caption1 - ignored|[[Caption2]] - ignored|Caption3 - accepted]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "right",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Caption1 - ignored",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Caption2",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " - ignored",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Caption3 - accepted",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with multiple widths -- use last",
		"wikitext": "[[File:Foobar.jpg|200px|300px|caption]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "200px",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "300px",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with multiple alignments -- use first (T50664)",
		"wikitext": "[[File:Foobar.jpg|thumb|left|right|center|caption]]\n\n[[File:Foobar.jpg|middle|text-top|caption]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "left",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "right",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "center",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "middle",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "text-top",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with width attribute at different positions",
		"wikitext": "[[File:Foobar.jpg|200px|right|Caption]]\n[[File:Foobar.jpg|right|200px|Caption]]\n[[File:Foobar.jpg|right|Caption|200px]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "200px",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "right",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "right",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "200px",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "right",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Caption",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "200px",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with size specified with pxpx (T15500, T53628)",
		"wikitext": "[[File:Foobar.jpg|20pxpx]]\n[[File:Foobar.jpg|200x20pxpx]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "20pxpx",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "200x20pxpx",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with link parameter, wiki target",
		"wikitext": "[[File:Foobar.jpg|link=Main Page]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Main Page",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with link parameter, URL target",
		"wikitext": "[[File:Foobar.jpg|link=http://example.com/]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "http://example.com/",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with link parameter, protocol-less URL target",
		"wikitext": "[[File:Foobar.jpg|link=//example.com/]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "//example.com/",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with link parameter, wgExternalLinkTarget",
		"wikitext": "[[Image:foobar.jpg|link=http://example.com/]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "http://example.com/",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with link parameter, wgNoFollowLinks set to false",
		"wikitext": "[[Image:foobar.jpg|link=http://example.com/]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "http://example.com/",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with link parameter, wgNoFollowDomainExceptions",
		"wikitext": "[[Image:foobar.jpg|link=http://example.com/]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "http://example.com/",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with link parameter, wgExternalLinkTarget, unnamed parameter",
		"wikitext": "[[Image:foobar.jpg|link=http://example.com/|Title]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "http://example.com/",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Title",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with empty link parameter",
		"wikitext": "[[File:Foobar.jpg|link=]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with link parameter (wiki target) and unnamed parameter",
		"wikitext": "[[File:Foobar.jpg|link=Main_Page|Title]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Main_Page",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Title",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with link parameter (URL target) and unnamed parameter",
		"wikitext": "[[File:Foobar.jpg|link=http://example.com/|Title]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "http://example.com/",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Title",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Thumbnail image with link parameter",
		"wikitext": "[[File:Foobar.jpg|thumb|link=http://example.com/|Title]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "http://example.com/",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Title",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Manually-specified thumbnail image",
		"wikitext": "[[File:Foobar.jpg|thumbnail=Thumb.png|Title]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumbnail=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Thumb.png",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Title",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Manually-specified thumbnail image with explicit link to wiki page",
		"wikitext": "[[File:Foobar.jpg|thumb=Thumb.png|link=Main_Page|Title]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Thumb.png",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Main_Page",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Title",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Manually-specified thumbnail image with explicit link to url",
		"wikitext": "[[File:Foobar.jpg|thumb=Thumb.png|link=http://example.com|Title]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Thumb.png",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "http://example.com",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Title",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Manually-specified thumbnail image with explicit no link",
		"wikitext": "[[File:Foobar.jpg|thumb=Thumb.png|link=|Title]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Thumb.png",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Title",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Manually-specified thumbnail image with explicit link and alt text",
		"wikitext": "[[File:Foobar.jpg|thumb=Thumb.png|link=Main_Page|alt=alttext|Title]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Thumb.png",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Main_Page",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "alt=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "alttext",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Title",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with frame and link",
		"wikitext": "[[File:Foobar.jpg|frame|left|This is a test image [[Main Page]]]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frame",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "left",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "This is a test image ",
				"name": "link-ground file-text"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with frame and link and explicit alt",
		"wikitext": "[[Image:Foobar.jpg|frame|left|This is a test image [[Main Page]]|alt=Altitude]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frame",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "left",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "This is a test image ",
				"name": "link-ground file-text"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "alt=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Altitude",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with wiki markup in implicit alt",
		"wikitext": "[[Image:Foobar.jpg|testing '''bold''' in alt]]\n\n[[Image:Foobar.jpg|alt=testing '''bold''' in alt]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "testing ",
				"name": "link-ground file-text"
			},
			{
				"text": "'''",
				"name": "link-ground apostrophes"
			},
			{
				"text": "bold",
				"name": "link-ground file-text strong"
			},
			{
				"text": "'''",
				"name": "link-ground apostrophes"
			},
			{
				"text": " in alt",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "alt=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "testing ",
				"name": "link-ground file-text"
			},
			{
				"text": "'''",
				"name": "link-ground apostrophes"
			},
			{
				"text": "bold",
				"name": "link-ground file-text strong"
			},
			{
				"text": "'''",
				"name": "link-ground apostrophes"
			},
			{
				"text": " in alt",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Alt image option should handle most kinds of wikitext without barfing",
		"wikitext": "[[Image:Foobar.jpg|thumb|This is the image caption|alt=This is a [[link]] and a {{1x|''bold template''}}.]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "This is the image caption",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "alt=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "This is a ",
				"name": "link-ground file-text"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "link",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " and a ",
				"name": "link-ground file-text"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground template-delimiter"
			},
			{
				"text": "''",
				"name": "template-link-ground apostrophes"
			},
			{
				"text": "bold template",
				"name": "template-link-ground template"
			},
			{
				"text": "''",
				"name": "template-link-ground apostrophes"
			},
			{
				"text": "}}",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": ".",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Ampersand in alt attribute (T206940)",
		"wikitext": "[[File:Foobar.jpg|alt=&amp;amp;]]\n\n<!-- consistency with gallery extension -->\n<gallery>\nFile:Foobar.jpg|alt=&amp;amp;\n</gallery>",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "alt=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "&amp;",
				"name": "link-ground entity"
			},
			{
				"text": "amp;",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "<!-- consistency with gallery extension -->",
				"name": "comment"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg|alt=",
				"name": "tag-gallery"
			},
			{
				"text": "&amp;",
				"name": "tag-gallery entity"
			},
			{
				"text": "amp;",
				"name": "tag-gallery"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Link with encoded pipe in alt option",
		"wikitext": "[[File:Foobar.jpg|alt=http://testing.123?4=5&#x7C;6|caption]]\n\n[[File:Foobar.jpg|alt=http://testing.123?4=5&vert;6|caption]]\n\n<!-- consistency with gallery extension -->\n<gallery>\nFile:Foobar.jpg|alt=http://testing.123?4=5&#x7C;6|caption\nFile:Foobar.jpg|alt=http://testing.123?4=5&vert;6|caption\n</gallery>",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "alt=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "http://testing.123?4=5",
				"name": "link-ground file-text"
			},
			{
				"text": "&#x7C;",
				"name": "link-ground entity"
			},
			{
				"text": "6",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "alt=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "http://testing.123?4=5",
				"name": "link-ground file-text"
			},
			{
				"text": "&vert;",
				"name": "link-ground entity"
			},
			{
				"text": "6",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "<!-- consistency with gallery extension -->",
				"name": "comment"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg|alt=",
				"name": "tag-gallery"
			},
			{
				"text": "http://",
				"name": "tag-gallery free-extlink-protocol"
			},
			{
				"text": "testing.123?4=5&#x7C;6|caption",
				"name": "tag-gallery free-extlink"
			},
			{
				"text": "File:Foobar.jpg|alt=",
				"name": "tag-gallery"
			},
			{
				"text": "http://",
				"name": "tag-gallery free-extlink-protocol"
			},
			{
				"text": "testing.123?4=5&vert;6|caption",
				"name": "tag-gallery free-extlink"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Italics markup in alt attribute (T206940)",
		"wikitext": "[[File:Foobar.jpg|alt=''x''|caption]]\n\n<!-- consistency with gallery extension -->\n<gallery>\nFile:Foobar.jpg|alt=''x''|caption\n</gallery>",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "alt=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "''",
				"name": "link-ground apostrophes"
			},
			{
				"text": "x",
				"name": "link-ground file-text em"
			},
			{
				"text": "''",
				"name": "link-ground apostrophes"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "<!-- consistency with gallery extension -->",
				"name": "comment"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg|alt=",
				"name": "tag-gallery"
			},
			{
				"text": "''",
				"name": "tag-gallery apostrophes"
			},
			{
				"text": "x",
				"name": "tag-gallery em"
			},
			{
				"text": "''",
				"name": "tag-gallery apostrophes"
			},
			{
				"text": "|caption",
				"name": "tag-gallery"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Nowiki markup in alt attribute (edited html, no data-parsoid) (T206940)",
		"wikitext": "[[File:Foobar.jpg|alt=<nowiki>''x''</nowiki>|caption]]\n\n<!-- consistency with gallery extension -->\n<gallery>\nFile:Foobar.jpg|alt=<nowiki>''x''</nowiki>|caption\n</gallery>",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "alt=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "<",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "link-ground exttag-name"
			},
			{
				"text": ">",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": "''x''",
				"name": "tag-nowiki"
			},
			{
				"text": "</",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "link-ground exttag-name"
			},
			{
				"text": ">",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "<!-- consistency with gallery extension -->",
				"name": "comment"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg|alt=",
				"name": "tag-gallery"
			},
			{
				"text": "<",
				"name": "tag-gallery exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "tag-gallery exttag-name"
			},
			{
				"text": ">",
				"name": "tag-gallery exttag-bracket"
			},
			{
				"text": "''x''",
				"name": "tag-gallery tag-nowiki"
			},
			{
				"text": "</",
				"name": "tag-gallery exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "tag-gallery exttag-name"
			},
			{
				"text": ">",
				"name": "tag-gallery exttag-bracket"
			},
			{
				"text": "|caption",
				"name": "tag-gallery"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Ampersand in link attribute (edited html, no data-parsoid) (T206940)",
		"wikitext": "[[File:Foobar.jpg|link=Foo_&_bar]]\n\n<!-- consistency with gallery extension -->\n<gallery>\nFile:Foobar.jpg|link=Foo_&_bar\n</gallery>",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Foo_&_bar",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "<!-- consistency with gallery extension -->",
				"name": "comment"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg|link=Foo_&_bar",
				"name": "tag-gallery"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Italics markup in link attribute (T206940)",
		"wikitext": "[[Foo''s bar''s]]\n\n<!-- Note that \"italics\" are stripped, even though this is a valid page title -->\n[[File:Foobar.jpg|link=Foo''s bar''s|caption1]]\n\n[[File:Foobar.jpg|link=''Main Page''|caption2]]\n\n<!-- consistency with gallery extension -->\n<gallery>\nFile:Foobar.jpg|link=Foo''s bar''s|caption1\nFile:Foobar.jpg|link=''Main Page''|caption2\n</gallery>",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Foo''s bar''s",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "<!-- Note that \"italics\" are stripped, even though this is a valid page title -->",
				"name": "comment"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Foo",
				"name": "link-ground file-text"
			},
			{
				"text": "''",
				"name": "link-ground apostrophes"
			},
			{
				"text": "s bar",
				"name": "link-ground file-text em"
			},
			{
				"text": "''",
				"name": "link-ground apostrophes"
			},
			{
				"text": "s",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption1",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "''",
				"name": "link-ground apostrophes"
			},
			{
				"text": "Main Page",
				"name": "link-ground file-text em"
			},
			{
				"text": "''",
				"name": "link-ground apostrophes"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption2",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "<!-- consistency with gallery extension -->",
				"name": "comment"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg|link=Foo",
				"name": "tag-gallery"
			},
			{
				"text": "''",
				"name": "tag-gallery apostrophes"
			},
			{
				"text": "s bar",
				"name": "tag-gallery em"
			},
			{
				"text": "''",
				"name": "tag-gallery apostrophes"
			},
			{
				"text": "s|caption1File:Foobar.jpg|link=",
				"name": "tag-gallery"
			},
			{
				"text": "''",
				"name": "tag-gallery apostrophes"
			},
			{
				"text": "Main Page",
				"name": "tag-gallery em"
			},
			{
				"text": "''",
				"name": "tag-gallery apostrophes"
			},
			{
				"text": "|caption2",
				"name": "tag-gallery"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Nowiki markup in link attribute (edited html, no data-parsoid) (T206940)",
		"wikitext": "[[File:Foobar.jpg|link=Foo<nowiki>''s_bar''</nowiki>s|caption]]\n\n<!-- consistency with gallery extension -->\n<gallery>\nFile:Foobar.jpg|link=Foo<nowiki>''s_bar''</nowiki>s|caption\n</gallery>",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Foo",
				"name": "link-ground file-text"
			},
			{
				"text": "<",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "link-ground exttag-name"
			},
			{
				"text": ">",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": "''s_bar''",
				"name": "tag-nowiki"
			},
			{
				"text": "</",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "link-ground exttag-name"
			},
			{
				"text": ">",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": "s",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "<!-- consistency with gallery extension -->",
				"name": "comment"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg|link=Foo",
				"name": "tag-gallery"
			},
			{
				"text": "<",
				"name": "tag-gallery exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "tag-gallery exttag-name"
			},
			{
				"text": ">",
				"name": "tag-gallery exttag-bracket"
			},
			{
				"text": "''s_bar''",
				"name": "tag-gallery tag-nowiki"
			},
			{
				"text": "</",
				"name": "tag-gallery exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "tag-gallery exttag-name"
			},
			{
				"text": ">",
				"name": "tag-gallery exttag-bracket"
			},
			{
				"text": "s|caption",
				"name": "tag-gallery"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "HTML entity prefix in link markup (T209236)",
		"wikitext": "[[File:Foobar.jpg|link=https://example.com?foo&params=bar]]\n\n<!-- consistency with gallery extension -->\n<gallery>\nFile:Foobar.jpg|link=https://example.com?foo&params=bar\n</gallery>",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "https://example.com?foo&params=bar",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "<!-- consistency with gallery extension -->",
				"name": "comment"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg|link=",
				"name": "tag-gallery"
			},
			{
				"text": "https://",
				"name": "tag-gallery free-extlink-protocol"
			},
			{
				"text": "example.com?foo&params=bar",
				"name": "tag-gallery free-extlink"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Image with heading and horizontal rule in caption",
		"wikitext": "[[File:Foobar.jpg|thumb|\n===Testing===\n123\n--------------\n]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "===Testing===123--------------",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with 'frameless' first.",
		"wikitext": "[[File:Foobar.jpg|frameless|caption]]\n\n[[File:Foobar.jpg|frameless|frame|caption]]\n\n[[File:Foobar.jpg|frameless|thumb|caption]]\n\n[[File:Foobar.jpg|frameless|thumbnail=Thumb.png|caption]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frameless",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frameless",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frame",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frameless",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frameless",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumbnail=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Thumb.png",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with 'frame' first.",
		"wikitext": "[[File:Foobar.jpg|frame|caption]]\n[[File:Foobar.jpg|frame|frameless|caption]]\n[[File:Foobar.jpg|frame|thumb|caption]]\n[[File:Foobar.jpg|frame|thumbnail=Thumb.png|caption]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frame",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frame",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frameless",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frame",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frame",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumbnail=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Thumb.png",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with 'thumb' first.",
		"wikitext": "[[File:Foobar.jpg|thumb|caption]]\n[[File:Foobar.jpg|thumb|frameless|caption]]\n[[File:Foobar.jpg|thumb|frame|caption]]\n[[File:Foobar.jpg|thumb|thumbnail=Thumb.png|caption]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frameless",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frame",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumbnail=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Thumb.png",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with 'thumbnail=' first.",
		"wikitext": "[[File:Foobar.jpg|thumbnail=Thumb.png|caption]]\n[[File:Foobar.jpg|thumbnail=Thumb.png|frameless|caption]]\n[[File:Foobar.jpg|thumbnail=Thumb.png|frame|caption]]\n[[File:Foobar.jpg|thumbnail=Thumb.png|thumb|caption]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumbnail=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Thumb.png",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumbnail=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Thumb.png",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frameless",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumbnail=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Thumb.png",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frame",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumbnail=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Thumb.png",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image: unspecified format and border enlarge",
		"wikitext": "[[File:Foobar.jpg|2000px]]\n\n[[File:Foobar.jpg|border|2000px]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "2000px",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "border",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "2000px",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image: \"unspecified format\" and border reduce",
		"wikitext": "[[File:Foobar.jpg|1000px]]\n\n[[File:Foobar.jpg|border|1000px]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "1000px",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "border",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "1000px",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image: thumbs reduce",
		"wikitext": "[[File:Foobar.jpg|thumb|50px]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "50px",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image: bitmap thumbs can't be enlarged past original size, but vector can.",
		"wikitext": "[[File:Foobar.jpg|thumb|2000px]]\n\n[[File:Foobar.svg|thumb|2000px]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "2000px",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.svg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "2000px",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image: frameless can reduce in size",
		"wikitext": "[[File:Foobar.jpg|frameless|50px]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frameless",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "50px",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image: bitmap frameless can't be enlarged past original size, but vector can",
		"wikitext": "[[File:Foobar.jpg|frameless|2000px]]\n\n[[File:Foobar.svg|frameless|2000px]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frameless",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "2000px",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.svg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frameless",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "2000px",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image: framed images are always unscaled.",
		"wikitext": "[[File:Foobar.jpg|frame]]\n\n[[File:Foobar.jpg|frame|50px]]\n\n[[File:Foobar.jpg|frame|50x50px]]\n\n[[File:Foobar.jpg|frame|2000px]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frame",
				"name": "link-ground image-parameter"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frame",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "50px",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frame",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "50x50px",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frame",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "2000px",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image: manualthumb images are always unscaled.",
		"wikitext": "[[File:Foobar.jpg|thumbnail=Thumb.png]]\n\n[[File:Foobar.jpg|thumbnail=Thumb.png|50px]]\n\n[[File:Foobar.jpg|thumbnail=Thumb.png|50x50px]]\n\n[[File:Foobar.jpg|thumbnail=Thumb.png|2000px]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumbnail=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Thumb.png",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumbnail=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Thumb.png",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "50px",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumbnail=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Thumb.png",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "50x50px",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumbnail=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Thumb.png",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "2000px",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Link to image page- image page normally doesn't exist, hence edit link\nAdd test with existing image page\n#<p><a href=\"/wiki/File:Test\" title=\"Image:Test\">Image:test</a>",
		"wikitext": "[[:Image:test]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": ":Image:test",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "T20784  Link to non-existent image page with caption should use caption as link text",
		"wikitext": "[[:Image:test|caption]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": ":Image:test",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Frameless image caption with a free URL",
		"wikitext": "[[File:Foobar.jpg|http://example.com]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "http://example.com",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Thumbnail image caption with a free URL",
		"wikitext": "[[File:Foobar.jpg|thumb|http://example.com]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "http://example.com",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Thumbnail image caption with a free URL and explicit alt",
		"wikitext": "[[File:Foobar.jpg|thumb|http://example.com|alt=Alteration]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "http://example.com",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "alt=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Alteration",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "SVG thumbnails with no language set",
		"wikitext": "[[File:Foobar.svg|thumb|caption]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.svg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "SVG thumbnails with language de",
		"wikitext": "[[File:Foobar.svg|lang=de|thumb|caption]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.svg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "lang=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "de",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "SVG thumbnails with invalid language code",
		"wikitext": "[[File:Foobar.svg|thumb|caption|lang=invalid:language:code]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.svg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "lang=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "invalid:language:code",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "T3887: A ISBN with a thumbnail",
		"wikitext": "[[File:Foobar.jpg|thumb|ISBN 1235467890]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "ISBN 1235467890",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "T3887: A RFC with a thumbnail",
		"wikitext": "[[File:Foobar.jpg|thumb|This is RFC 12354]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "This is RFC 12354",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "T3887: A mailto link with a thumbnail",
		"wikitext": "[[File:Foobar.jpg|thumb|Please mailto:nobody@example.com]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Please mailto:nobody@example.com",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "T2648: Frameless image caption with a link",
		"wikitext": "[[File:Foobar.jpg|text with a [[link]] in it]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "text with a ",
				"name": "link-ground file-text"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "link",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " in it",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "T2648: Frameless image caption with a link (suffix)",
		"wikitext": "[[File:Foobar.jpg|text with a [[link]]foo in it]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "text with a ",
				"name": "link-ground file-text"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "link",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "foo in it",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "T2648: Frameless image caption with an interwiki link",
		"wikitext": "[[File:Foobar.jpg|text with a [[MeatBall:Link]] in it]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "text with a ",
				"name": "link-ground file-text"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "MeatBall:Link",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " in it",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "T2648: Frameless image caption with a piped interwiki link",
		"wikitext": "[[File:Foobar.jpg|text with a [[MeatBall:Link|link]] in it]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "text with a ",
				"name": "link-ground file-text"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "MeatBall:Link",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " in it",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Escape HTML special chars in image alt text",
		"wikitext": "[[File:Foobar.jpg|& < > \"]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "& < > \"",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Entities in file name and attributes",
		"wikitext": "[[File:7%25 solution.gif|manualthumb=7%25 solution.gif|link=7%25 solution|[[7%25 solution]]]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:7%25 solution.gif",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "manualthumb=7%25 solution.gif",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "7%25 solution",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "7%25 solution",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "T2499: Alt text should have &#1234;, not &amp;1234;",
		"wikitext": "[[File:Foobar.jpg|&#9792;]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "&#9792;",
				"name": "link-ground entity"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Broken image caption with link",
		"wikitext": "[[Image:Foobar.jpg|thumb|This is a broken caption. But [[Main Page|this]] is just an ordinary link.",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "This is a broken caption. But ",
				"name": "link-ground file-text"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "this",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " is just an ordinary link.",
				"name": "link-ground file-text"
			}
		]
	},
	{
		"desc": "Image caption containing another image",
		"wikitext": "[[File:Foobar.jpg|thumb|This is a caption with another [[File:Thumb.png|image]] inside it!]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "This is a caption with another ",
				"name": "link-ground file-text"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Thumb.png",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "image",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " inside it!",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image: caption containing a newline",
		"wikitext": "[[File:Foobar.jpg|This\n*is some text]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "This*is some text",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image: caption containing leading space\n(The leading space should not trigger nowiki escaping in wt2wt mode)",
		"wikitext": "[[File:Foobar.jpg|thumb| bar]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "| ",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "bar",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image: caption containing a table",
		"wikitext": "[[Image:Foobar.jpg|thumb|200px|This is an example image thumbnail caption with a table\n{|\n!Foo!!Bar\n|-\n|Foo1||Bar1\n|}\nand some more text.]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "200px",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "This is an example image thumbnail caption with a table{",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "!Foo!!Bar",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "-",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Foo1",
				"name": "link-ground file-text"
			},
			{
				"text": "||",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Bar1",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "}and some more text.",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "T5090: External links other than http: in image captions",
		"wikitext": "[[File:Foobar.jpg|thumb|200x200px|This caption has [irc://example.net irc] and [https://example.com Secure] ext links in it.]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "200x200px",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "This caption has ",
				"name": "link-ground file-text"
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "irc://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "example.net",
				"name": "link-ground extlink"
			},
			{
				"text": " irc",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": " and ",
				"name": "link-ground file-text"
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "https://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "example.com",
				"name": "link-ground extlink"
			},
			{
				"text": " Secure",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": " ext links in it.",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Custom class",
		"wikitext": "[[Image:foobar.jpg|a|class=b]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "a",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "class=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "b",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "\"border\", \"frameless\" and \"class\" attributes on an image.",
		"wikitext": "[[File:Foobar.jpg|frameless|border|class=extra|caption]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frameless",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "border",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "class=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "extra",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Invalid image attributes (T64500)",
		"wikitext": "[[File:Foobar.jpg|thumb|float|left|caption]]\n\n[[File:Foobar.jpg|thumb|righ|caption]]\n\n[[File:Foobar.jpg|bogus1|thumb|bogus2|left|bogus3|caption]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "float",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "left",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "righ",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "bogus1",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "bogus2",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "left",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "bogus3",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Redirected image",
		"wikitext": "[[Image:Barfoo.jpg]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:Barfoo.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "File containing double quotes and spaces",
		"wikitext": "[[File:Cool \"Gator\".png]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Cool \"Gator\".png",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "File containing single quotes",
		"wikitext": "[[File:Foo's ''italic'' bar.jpg]]\n[[File:Foo's ''italic'' bar.jpg|Foo's ''italic'' bar]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foo's ''italic'' bar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foo's ''italic'' bar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Foo's ",
				"name": "link-ground file-text"
			},
			{
				"text": "''",
				"name": "link-ground apostrophes"
			},
			{
				"text": "italic",
				"name": "link-ground file-text em"
			},
			{
				"text": "''",
				"name": "link-ground apostrophes"
			},
			{
				"text": " bar",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Broken image links with HTML captions (T41700)",
		"wikitext": "[[File:Nonexistent|<script></script>]]\n[[File:Nonexistent|100x100px|<script></script>]]\n[[File:Nonexistent|&lt;]]\n[[File:Nonexistent|a<i>b</i>c]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Nonexistent",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "<script></script>",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Nonexistent",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "100x100px",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "<script></script>",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Nonexistent",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "&lt;",
				"name": "link-ground entity"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Nonexistent",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "a",
				"name": "link-ground file-text"
			},
			{
				"text": "<",
				"name": "link-ground htmltag-bracket"
			},
			{
				"text": "i",
				"name": "link-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "link-ground htmltag-bracket"
			},
			{
				"text": "b",
				"name": "link-ground file-text"
			},
			{
				"text": "</",
				"name": "link-ground htmltag-bracket"
			},
			{
				"text": "i",
				"name": "link-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "link-ground htmltag-bracket"
			},
			{
				"text": "c",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Media in wikilink",
		"wikitext": "[[Test|[[File:Foobar.jpg]]]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Test",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "]]",
				"name": ""
			}
		]
	},
	{
		"desc": "Template with thumb image (with link in description)",
		"wikitext": "{{paramtest|param=[[Image:noimage.png|thumb|[[no link|link]] [[no link|caption]]]]}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "paramtest",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "param=",
				"name": "template-ground template-argument-name"
			},
			{
				"text": "[[",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "Image:noimage.png",
				"name": "template-link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "template-link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "template-link-ground link-delimiter"
			},
			{
				"text": "[[",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "no link",
				"name": "template-link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground link-delimiter"
			},
			{
				"text": "link",
				"name": "template-link-ground link-text"
			},
			{
				"text": "]]",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": " ",
				"name": "template-link-ground file-text"
			},
			{
				"text": "[[",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "no link",
				"name": "template-link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "template-link-ground link-text"
			},
			{
				"text": "]]]]",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "T3219 URL next to image (good)",
		"wikitext": "http://example.com [[File:Foobar.jpg]]",
		"tokens": [
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com",
				"name": "free-extlink"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "T3219 URL next to image (broken)",
		"wikitext": "http://example.com[[File:Foobar.jpg]]",
		"tokens": [
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com",
				"name": "free-extlink"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image link to nonexistent file (T3850 - good)",
		"wikitext": "[[File:No_such.jpg]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:No_such.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": ":Image link to nonexistent file (T3850 - bad)",
		"wikitext": "[[:Image:No such.jpg]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": ":Image:No such.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Fuzz testing: image with bogus manual thumbnail",
		"wikitext": "[[Image:foobar.jpg|thumbnail= ]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumbnail=",
				"name": "link-ground image-parameter"
			},
			{
				"text": " ",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Gallery with valid attributes",
		"wikitext": "<gallery type=\"123\" summary=\"345\">\nFile:File:Foobar.jpg\n</gallery>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery ",
				"name": "exttag-name"
			},
			{
				"text": "type=\"123\" summary=\"345\"",
				"name": "exttag-attribute ext-gallery"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:File:Foobar.jpg",
				"name": "tag-gallery"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Gallery (without px units)",
		"wikitext": "<gallery widths=\"70\" heights=\"40\">\nFile:Foobar.jpg\n</gallery>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery ",
				"name": "exttag-name"
			},
			{
				"text": "widths=\"70\" heights=\"40\"",
				"name": "exttag-attribute ext-gallery"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "tag-gallery"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Gallery (with invalid units)",
		"wikitext": "<gallery widths=\"70em\" heights=\"40em\">\nFile:Foobar.jpg\n</gallery>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery ",
				"name": "exttag-name"
			},
			{
				"text": "widths=\"70em\" heights=\"40em\"",
				"name": "exttag-attribute ext-gallery"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "tag-gallery"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Gallery with template inside caption",
		"wikitext": "<gallery caption=\"{{1x|hi}}\">\nFile:Foobar.jpg|{{1x|ho}}\n</gallery>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery ",
				"name": "exttag-name"
			},
			{
				"text": "caption=\"{{1x|hi}}\"",
				"name": "exttag-attribute ext-gallery"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg|",
				"name": "tag-gallery"
			},
			{
				"text": "{{",
				"name": "tag-gallery template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "tag-gallery template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "tag-gallery template-ground template-delimiter"
			},
			{
				"text": "ho",
				"name": "tag-gallery template-ground template"
			},
			{
				"text": "}}",
				"name": "tag-gallery template-ground template-bracket"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Gallery with wikitext inside caption",
		"wikitext": "<gallery>\nFile:Foobar.jpg|alt=galleryalt|[[File:Foobar.jpg|alt=inneralt|20x20px|desc]]\nFile:Foobar.jpg|alt=galleryalt|{{Test|unamedParam|alt=param}}\n</gallery>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg|alt=galleryalt|",
				"name": "tag-gallery"
			},
			{
				"text": "[[",
				"name": "tag-gallery link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "tag-gallery link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "tag-gallery link-ground link-delimiter"
			},
			{
				"text": "alt=",
				"name": "tag-gallery link-ground image-parameter"
			},
			{
				"text": "inneralt",
				"name": "tag-gallery link-ground file-text"
			},
			{
				"text": "|",
				"name": "tag-gallery link-ground link-delimiter"
			},
			{
				"text": "20x20px",
				"name": "tag-gallery link-ground file-text"
			},
			{
				"text": "|",
				"name": "tag-gallery link-ground link-delimiter"
			},
			{
				"text": "desc",
				"name": "tag-gallery link-ground file-text"
			},
			{
				"text": "]]",
				"name": "tag-gallery link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg|alt=galleryalt|",
				"name": "tag-gallery"
			},
			{
				"text": "{{",
				"name": "tag-gallery template-ground template-bracket"
			},
			{
				"text": "Test",
				"name": "tag-gallery template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "tag-gallery template-ground template-delimiter"
			},
			{
				"text": "unamedParam",
				"name": "tag-gallery template-ground template"
			},
			{
				"text": "|",
				"name": "tag-gallery template-ground template-delimiter"
			},
			{
				"text": "alt=",
				"name": "tag-gallery template-ground template-argument-name"
			},
			{
				"text": "param",
				"name": "tag-gallery template-ground template"
			},
			{
				"text": "}}",
				"name": "tag-gallery template-ground template-bracket"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Gallery with wikitext incl bogus HTML tag (T237318)",
		"wikitext": "<gallery>\nFile:Foobar.jpg|</ref>\n</gallery>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg|",
				"name": "tag-gallery"
			},
			{
				"text": "</ref>",
				"name": "tag-gallery error"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Gallery (with showfilename option)",
		"wikitext": "<gallery showfilename=\"\">\nFile:Nonexistent.jpg|caption\nFile:Nonexistent.jpg\nFile:Foobar.jpg|some '''caption''' [[Main Page]]\nFile:Foobar.jpg\nFile:Redirect to foobar.jpg\n</gallery>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery ",
				"name": "exttag-name"
			},
			{
				"text": "showfilename=\"\"",
				"name": "exttag-attribute ext-gallery"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Nonexistent.jpg|captionFile:Nonexistent.jpgFile:Foobar.jpg|some ",
				"name": "tag-gallery"
			},
			{
				"text": "'''",
				"name": "tag-gallery apostrophes"
			},
			{
				"text": "caption",
				"name": "tag-gallery strong"
			},
			{
				"text": "'''",
				"name": "tag-gallery apostrophes"
			},
			{
				"text": " ",
				"name": "tag-gallery"
			},
			{
				"text": "[[",
				"name": "tag-gallery link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "tag-gallery link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "tag-gallery link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpgFile:Redirect to foobar.jpg",
				"name": "tag-gallery"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Gallery override link with wikilink (T36852)",
		"wikitext": "<gallery>\nFile:Foobar.jpg|link=Wikilink|alt=galleryalt\n</gallery>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg|link=Wikilink|alt=galleryalt",
				"name": "tag-gallery"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Gallery override link with absolute external link (T36852)",
		"wikitext": "<gallery>\nFile:Foobar.jpg|alt=galleryalt|link=http://www.example.org\n</gallery>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg|alt=galleryalt|link=",
				"name": "tag-gallery"
			},
			{
				"text": "http://",
				"name": "tag-gallery free-extlink-protocol"
			},
			{
				"text": "www.example.org",
				"name": "tag-gallery free-extlink"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Gallery with class and style attributes",
		"wikitext": "<gallery class=\"center\" style=\"text-align: center;\">\nFile:Foobar.jpg\n</gallery>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery ",
				"name": "exttag-name"
			},
			{
				"text": "class=\"center\" style=\"text-align: center;\"",
				"name": "exttag-attribute ext-gallery"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "tag-gallery"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Gallery in nolines mode",
		"wikitext": "<gallery mode=\"nolines\" showfilenames=\"yes\" caption=\"No Lines!\">\nFile:Foobar.jpg|foo\n</gallery>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery ",
				"name": "exttag-name"
			},
			{
				"text": "mode=\"nolines\" showfilenames=\"yes\" caption=\"No Lines!\"",
				"name": "exttag-attribute ext-gallery"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg|foo",
				"name": "tag-gallery"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Gallery in slideshow mode",
		"wikitext": "<gallery mode=\"slideshow\" showthumbnails=\"\">\nFile:Foobar.jpg\n</gallery>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery ",
				"name": "exttag-name"
			},
			{
				"text": "mode=\"slideshow\" showthumbnails=\"\"",
				"name": "exttag-attribute ext-gallery"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "tag-gallery"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Gallery in packed mode",
		"wikitext": "<gallery mode=\"packed\">\nFile:Foobar.jpg\n</gallery>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery ",
				"name": "exttag-name"
			},
			{
				"text": "mode=\"packed\"",
				"name": "exttag-attribute ext-gallery"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "tag-gallery"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Gallery in packed-overlay mode",
		"wikitext": "<gallery mode=\"packed-overlay\" showfilenames=\"yes\" caption=\"Packed Overlay!\">\nFile:Foobar.jpg|foo\n</gallery>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery ",
				"name": "exttag-name"
			},
			{
				"text": "mode=\"packed-overlay\" showfilenames=\"yes\" caption=\"Packed Overlay!\"",
				"name": "exttag-attribute ext-gallery"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg|foo",
				"name": "tag-gallery"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Gallery in packed-hover mode",
		"wikitext": "<gallery mode=\"packed-hover\" showfilenames=\"yes\" caption=\"Packed Hover!\">\nFile:Foobar.jpg|foo\n</gallery>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery ",
				"name": "exttag-name"
			},
			{
				"text": "mode=\"packed-hover\" showfilenames=\"yes\" caption=\"Packed Hover!\"",
				"name": "exttag-attribute ext-gallery"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg|foo",
				"name": "tag-gallery"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Centre-aligned image",
		"wikitext": "[[Image:foobar.jpg|centre]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "centre",
				"name": "link-ground image-parameter"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "None-aligned image",
		"wikitext": "[[Image:foobar.jpg|none]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "none",
				"name": "link-ground image-parameter"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Width + Height sized image (using px) (height is ignored)",
		"wikitext": "[[Image:foobar.jpg|640x480px]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "640x480px",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Width-sized image (using px, no following whitespace)",
		"wikitext": "[[Image:foobar.jpg|640px]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "640px",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Width-sized image (using px, with following whitespace - test regression from r39467)",
		"wikitext": "[[Image:foobar.jpg|640px ]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "640px ",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Width-sized image (using px, with preceding whitespace - test regression from r39467)",
		"wikitext": "[[Image:foobar.jpg| 640px]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "| ",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "640px",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with page parameter",
		"wikitext": "[[File:LoremIpsum.djvu]]\n\n[[File:LoremIpsum.djvu|page=2]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:LoremIpsum.djvu",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:LoremIpsum.djvu",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "page=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "2",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with page parameter generated by a template",
		"wikitext": "[[File:LoremIpsum.djvu|page={{1x|2}}]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:LoremIpsum.djvu",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "page=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground template-delimiter"
			},
			{
				"text": "2",
				"name": "template-link-ground template"
			},
			{
				"text": "}}",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Images with the \"|\" character in the comment",
		"wikitext": "[[File:Foobar.jpg|thumb|An [http://test/?param1=|left|&param2=|x external] URL]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "An ",
				"name": "link-ground file-text"
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "test/?param1=|left|&param2=|x",
				"name": "link-ground extlink"
			},
			{
				"text": " external",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": " URL",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Free external link invading image caption",
		"wikitext": "[[File:Foobar.jpg|thumb|http://x|hello]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "http://x",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "hello",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Special characters in embedded file links (T29679)",
		"wikitext": "[[File:Contains & ampersand.jpg]]\n[[File:Does not exist.jpg|Title with & ampersand]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Contains & ampersand.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Does not exist.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Title with & ampersand",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "1. Treebuilder fixup of formatting elt",
		"wikitext": "{|\n|\n<small>\n[[Image:Foobar.jpg|right|Test]]\n</small>\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "small",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "right",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Test",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "small",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "2. Treebuilder fixup of formatting elt",
		"wikitext": "'''foo[[File:Foobar.jpg|thumb|caption]]bar'''\n\n<small>[[Image:Foobar.jpg|right|300px]]</small>",
		"tokens": [
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "foo",
				"name": "strong"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename strong"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text strong"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "bar",
				"name": "strong"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "small",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "right",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "300px",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "small",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "3. Treebuilder fixup of formatting elt",
		"wikitext": "<small>'''foo[[File:Foobar.jpg|thumb|caption]]bar'''</small>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "small",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "foo",
				"name": "strong"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename strong"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text strong"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "bar",
				"name": "strong"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "small",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "4. Treebuilder fixup of formatting elt: formatting tags around captionless images",
		"wikitext": "'''<small>[[Image:Foobar.jpg|right|300px]]</small>'''",
		"tokens": [
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "small",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:Foobar.jpg",
				"name": "link-ground link-pagename pagename strong"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "right",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "300px",
				"name": "link-ground file-text strong"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "small",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Image: empty alt attribute (T50924)",
		"wikitext": "[[File:Foobar.jpg|alt=|thumb|bar]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "alt=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "bar",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image: Invalid title as link",
		"wikitext": "[[File:Foobar.jpg|link=<]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "<",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Percent decode titles in the link option (T216003#7836261)",
		"wikitext": "[[Test%22123]]\n[[File:Foobar.jpg|link=Test%22123]]\n[[File:Foobar.jpg|link=[[Test%22123]]]]\n\n<gallery>\nFile:Foobar.jpg|link=Test%22123\nFile:Foobar.jpg|link=[[Test%22123]]\n</gallery>",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Test%22123",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Test%22123",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Test%22123",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg|link=Test%22123File:Foobar.jpg|link=",
				"name": "tag-gallery"
			},
			{
				"text": "[[",
				"name": "tag-gallery link-ground link-bracket"
			},
			{
				"text": "Test%22123",
				"name": "tag-gallery link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "tag-gallery link-ground link-bracket"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Magic links inside image captions (autolinked)",
		"wikitext": "[[File:Foobar.jpg|thumb|http://example.com]]\n[[File:Foobar.jpg|thumb|RFC 1234]]\n[[File:Foobar.jpg|thumb|PMID 1234]]\n[[File:Foobar.jpg|thumb|ISBN 123456789x]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "http://example.com",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "RFC 1234",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "PMID 1234",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "ISBN 123456789x",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Thumbnail output",
		"wikitext": "[[File:Thumb.png|thumb]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Thumb.png",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "File with caption with pipe in extension tag attribute",
		"wikitext": "[[File:Foobar.jpg|thumb|Test <nowiki bogus=\"attri|bute\"/> 123]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Test ",
				"name": "link-ground file-text"
			},
			{
				"text": "<",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": "nowiki ",
				"name": "link-ground exttag-name"
			},
			{
				"text": "bogus=\"attri|bute\"",
				"name": "link-ground exttag-attribute ext-nowiki"
			},
			{
				"text": "/>",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": " 123",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "File with table in caption with extra table attribute spaces",
		"wikitext": "[[File:Foobar.jpg|thumb|\n{|\n|-  \n|hi\n|}\n]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "{",
				"name": "link-ground file-text"
			},
			{
				"text": "||",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "-  ",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "hi",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "}",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Broken inline media with a caption and an alt",
		"wikitext": "[[File:Broken.jpg|alt=An alternative text description.|A caption for the media.]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Broken.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "alt=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "An alternative text description.",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "A caption for the media.",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Broken block media with a caption and an alt",
		"wikitext": "[[File:Broken.jpg|alt=An alternative text description.|thumb|A caption for the media.]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Broken.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "alt=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "An alternative text description.",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "A caption for the media.",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Broken inline media with a caption",
		"wikitext": "[[File:Broken.jpg|A caption for the media.]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Broken.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "A caption for the media.",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Broken block media with a caption",
		"wikitext": "[[File:Broken.jpg|thumb|A caption for the media.]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Broken.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "A caption for the media.",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "magicWords"
	},
	{
		"desc": "Magic Word: {{CURRENTDAY}}",
		"wikitext": "{{CURRENTDAY}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "CURRENTDAY",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Magic Word: {{CURRENTDAY2}}",
		"wikitext": "{{CURRENTDAY2}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "CURRENTDAY2",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Magic Word: {{CURRENTDAYNAME}}",
		"wikitext": "{{CURRENTDAYNAME}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "CURRENTDAYNAME",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Magic Word: {{CURRENTDOW}}",
		"wikitext": "{{CURRENTDOW}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "CURRENTDOW",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Magic Word: {{CURRENTMONTH}}",
		"wikitext": "{{CURRENTMONTH}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "CURRENTMONTH",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Magic Word: {{CURRENTMONTH1}}",
		"wikitext": "{{CURRENTMONTH1}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "CURRENTMONTH1",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Magic Word: {{CURRENTMONTHABBREV}}",
		"wikitext": "{{CURRENTMONTHABBREV}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "CURRENTMONTHABBREV",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Magic Word: {{CURRENTMONTHNAME}}",
		"wikitext": "{{CURRENTMONTHNAME}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "CURRENTMONTHNAME",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Magic Word: {{CURRENTMONTHNAMEGEN}}",
		"wikitext": "{{CURRENTMONTHNAMEGEN}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "CURRENTMONTHNAMEGEN",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Magic Word: {{CURRENTTIME}}",
		"wikitext": "{{CURRENTTIME}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "CURRENTTIME",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Magic Word: {{CURRENTHOUR}}",
		"wikitext": "{{CURRENTHOUR}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "CURRENTHOUR",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Magic Word: {{CURRENTWEEK}} (T6594)",
		"wikitext": "{{CURRENTWEEK}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "CURRENTWEEK",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Magic Word: {{CURRENTYEAR}}",
		"wikitext": "{{CURRENTYEAR}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "CURRENTYEAR",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Magic Word: {{CURRENTTIMESTAMP}}",
		"wikitext": "{{CURRENTTIMESTAMP}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "CURRENTTIMESTAMP",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Magic Words LOCAL (UTC)",
		"wikitext": "*{{LOCALMONTH}}\n*{{LOCALMONTH1}}\n*{{LOCALMONTHNAME}}\n*{{LOCALMONTHNAMEGEN}}\n*{{LOCALMONTHABBREV}}\n*{{LOCALDAY}}\n*{{LOCALDAY2}}\n*{{LOCALDAYNAME}}\n*{{LOCALYEAR}}\n*{{LOCALTIME}}\n*{{LOCALHOUR}}\n*{{LOCALWEEK}}\n*{{LOCALDOW}}\n*{{LOCALTIMESTAMP}}",
		"tokens": [
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "LOCALMONTH",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "LOCALMONTH1",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "LOCALMONTHNAME",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "LOCALMONTHNAMEGEN",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "LOCALMONTHABBREV",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "LOCALDAY",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "LOCALDAY2",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "LOCALDAYNAME",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "LOCALYEAR",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "LOCALTIME",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "LOCALHOUR",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "LOCALWEEK",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "LOCALDOW",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "LOCALTIMESTAMP",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Parser functions with interwiki titles (T355706)",
		"wikitext": "* {{PAGEID:Parser test}} - {{PAGEID:wikipedia:Parser test}}\n* {{PAGESIZE:Parser test}} - {{PAGESIZE:wikipedia:Parser test}}\n* {{REVISIONID:Parser test}} - {{REVISIONID:wikipedia:Parser test}}\n* {{REVISIONDAY:Parser test}} - {{REVISIONDAY:wikipedia:Parser test}}\n* {{REVISIONDAY2:Parser test}} - {{REVISIONDAY2:wikipedia:Parser test}}\n* {{REVISIONMONTH:Parser test}} - {{REVISIONMONTH:wikipedia:Parser test}}\n* {{REVISIONMONTH1:Parser test}} - {{REVISIONMONTH1:wikipedia:Parser test}}\n* {{REVISIONYEAR:Parser test}} - {{REVISIONYEAR:wikipedia:Parser test}}\n* {{REVISIONTIMESTAMP:Parser test}} - {{REVISIONTIMESTAMP:wikipedia:Parser test}}\n* {{REVISIONUSER:Parser test}} - {{REVISIONUSER:wikipedia:Parser test}}",
		"tokens": [
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "PAGEID",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "Parser test",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": " - ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "PAGEID",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "wikipedia:Parser test",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "PAGESIZE",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "Parser test",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": " - ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "PAGESIZE",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "wikipedia:Parser test",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "REVISIONID",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "Parser test",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": " - ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "REVISIONID",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "wikipedia:Parser test",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "REVISIONDAY",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "Parser test",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": " - ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "REVISIONDAY",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "wikipedia:Parser test",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "REVISIONDAY2",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "Parser test",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": " - ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "REVISIONDAY2",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "wikipedia:Parser test",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "REVISIONMONTH",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "Parser test",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": " - ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "REVISIONMONTH",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "wikipedia:Parser test",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "REVISIONMONTH1",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "Parser test",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": " - ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "REVISIONMONTH1",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "wikipedia:Parser test",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "REVISIONYEAR",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "Parser test",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": " - ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "REVISIONYEAR",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "wikipedia:Parser test",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "REVISIONTIMESTAMP",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "Parser test",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": " - ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "REVISIONTIMESTAMP",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "wikipedia:Parser test",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "REVISIONUSER",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "Parser test",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": " - ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "REVISIONUSER",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "wikipedia:Parser test",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Case-sensitive magic words, when cased differently, should just be template transclusions",
		"wikitext": "{{CurrentMonth}}\n{{currentday}}\n{{cURreNTweEK}}\n{{currentHour}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "CurrentMonth",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "currentday",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "cURreNTweEK",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "currentHour",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Case-insensitive magic words should still work with weird casing.",
		"wikitext": "{{sErVeRNaMe}}\n{{LCFirst:AOEU}}\n{{ucFIRST:aoeu}}\n{{SERver}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "sErVeRNaMe",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "LCFirst",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "AOEU",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "ucFIRST",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "aoeu",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "}}{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "SERver",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "Magic Word: case-insensitive (all-lowercase)",
		"wikitext": "foo\n__notoc__\nbar",
		"tokens": [
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "__notoc__",
				"name": "double-underscore"
			},
			{
				"text": "bar",
				"name": ""
			}
		]
	},
	{
		"desc": "Magic Word: case-insensitive (mixed case)",
		"wikitext": "foo\n__NOtOC__\nbar",
		"tokens": [
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "__NOtOC__",
				"name": "double-underscore"
			},
			{
				"text": "bar",
				"name": ""
			}
		]
	},
	{
		"desc": "media"
	},
	{
		"desc": "Simple image",
		"wikitext": "[[Image:foobar.jpg]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Simple image redirect",
		"wikitext": "[[Image:Redirect to foobar.jpg]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:Redirect to foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Simple image (using File: namespace, now canonical)",
		"wikitext": "[[File:Foobar.jpg]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Right-aligned image",
		"wikitext": "[[File:Foobar.jpg|right]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "right",
				"name": "link-ground image-parameter"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with caption",
		"wikitext": "[[File:Foobar.jpg|right|Caption text]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "right",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Caption text",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with caption, T55312 #1",
		"wikitext": "[[File:Foobar.jpg|right|Caption page stuff]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "right",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Caption page stuff",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with caption, T55312 #2",
		"wikitext": "[[File:Foobar.jpg|right|Caption page=]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "right",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Caption page=",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with caption, T55312 #3",
		"wikitext": "[[File:Foobar.jpg|right|Caption page=stuff]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "right",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Caption page=stuff",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image caption with pipe entity",
		"wikitext": "[[File:Foobar.jpg|thumb|one &#x7C; two]]\n[[File:Foobar.jpg|thumb|one ''two'' &#x7C; three]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "one ",
				"name": "link-ground file-text"
			},
			{
				"text": "&#x7C;",
				"name": "link-ground entity"
			},
			{
				"text": " two",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "one ",
				"name": "link-ground file-text"
			},
			{
				"text": "''",
				"name": "link-ground apostrophes"
			},
			{
				"text": "two",
				"name": "link-ground file-text em"
			},
			{
				"text": "''",
				"name": "link-ground apostrophes"
			},
			{
				"text": " ",
				"name": "link-ground file-text"
			},
			{
				"text": "&#x7C;",
				"name": "link-ground entity"
			},
			{
				"text": " three",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Bad images - basic functionality",
		"wikitext": "[[File:Bad.jpg]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Bad.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Bad images - T18039: text after bad image disappears",
		"wikitext": "Foo bar\n[[File:Bad.jpg]]\nBar foo",
		"tokens": [
			{
				"text": "Foo bar",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Bad.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Bar foo",
				"name": ""
			}
		]
	},
	{
		"desc": "Bad images - manualthumb",
		"wikitext": "[[File:Foobar.jpg|thumbnail=Bad.jpg|Uh oh]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumbnail=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Bad.jpg",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Uh oh",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Bad images - in gallery",
		"wikitext": "<gallery>\nFile:Bad.jpg\n</gallery>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Bad.jpg",
				"name": "tag-gallery"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Allow empty links in image captions (T62753)",
		"wikitext": "[[File:Foobar.jpg|thumb|Caption [[Link1]]\n[[]]\n[[Link2]]\n]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Caption ",
				"name": "link-ground file-text"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Link1",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "[[",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Link2",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "]]",
				"name": ""
			}
		]
	},
	{
		"desc": "Titles in unlinked images (T23454)",
		"wikitext": "[[File:Foobar.jpg|link=|stuff]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "stuff",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Unlinked media in gallery",
		"wikitext": "<gallery>\nFile:Foobar.jpg|link=|stuff\n</gallery>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg|link=|stuff",
				"name": "tag-gallery"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Link with empty target",
		"wikitext": "[[]]",
		"tokens": [
			{
				"text": "[[]]",
				"name": ""
			}
		]
	},
	{
		"desc": "Image with link trail",
		"wikitext": "Linktrails should not work for images: [[File:Foobar.jpg]]s",
		"tokens": [
			{
				"text": "Linktrails should not work for images: ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "s",
				"name": ""
			}
		]
	},
	{
		"desc": "Image with empty attribute",
		"wikitext": "[[File:Foobar.jpg|right||Caption text]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "right",
				"name": "link-ground image-parameter"
			},
			{
				"text": "||",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Caption text",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "1. Block image with individual attributes from templates",
		"wikitext": "[[File:Foobar.jpg|thumb|{{1x|137px}}|This is a caption]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground template-delimiter"
			},
			{
				"text": "137px",
				"name": "template-link-ground template"
			},
			{
				"text": "}}",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "This is a caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "2. Block Image with individual attributes from templates",
		"wikitext": "[[File:Foobar.jpg|{{1x|thumb}}|{{1x|137px}}|This is a caption]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground template-delimiter"
			},
			{
				"text": "thumb",
				"name": "template-link-ground template"
			},
			{
				"text": "}}",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground template-delimiter"
			},
			{
				"text": "137px",
				"name": "template-link-ground template"
			},
			{
				"text": "}}",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "This is a caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "3. Inline image with individual attributes from templates",
		"wikitext": "[[File:Foobar.jpg|{{1x|50px}}]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground template-delimiter"
			},
			{
				"text": "50px",
				"name": "template-link-ground template"
			},
			{
				"text": "}}",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with multiple attributes from the same template",
		"wikitext": "[[File:Foobar.jpg|{{image_attribs}}]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "image_attribs",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with link tails",
		"wikitext": "123[[File:Foobar.jpg]]456\n123[[File:Foobar.jpg|right]]456\n123[[File:Foobar.jpg|thumb]]456",
		"tokens": [
			{
				"text": "123",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "456123",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "right",
				"name": "link-ground image-parameter"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "456123",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "456",
				"name": ""
			}
		]
	},
	{
		"desc": "Image with multiple captions -- only last one is accepted",
		"wikitext": "[[File:Foobar.jpg|right|Caption1 - ignored|[[Caption2]] - ignored|Caption3 - accepted]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "right",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Caption1 - ignored",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Caption2",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " - ignored",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Caption3 - accepted",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with multiple widths -- use last",
		"wikitext": "[[File:Foobar.jpg|200px|300px|caption]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "200px",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "300px",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with multiple alignments -- use first (T50664)",
		"wikitext": "[[File:Foobar.jpg|thumb|left|right|center|caption]]\n\n[[File:Foobar.jpg|middle|text-top|caption]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "left",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "right",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "center",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "middle",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "text-top",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with width attribute at different positions",
		"wikitext": "[[File:Foobar.jpg|200px|right|Caption]]\n[[File:Foobar.jpg|right|200px|Caption]]\n[[File:Foobar.jpg|right|Caption|200px]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "200px",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "right",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "right",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "200px",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "right",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Caption",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "200px",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with size specified with pxpx (T15500, T53628)",
		"wikitext": "[[File:Foobar.jpg|20pxpx]]\n[[File:Foobar.jpg|200x20pxpx]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "20pxpx",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "200x20pxpx",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with link parameter, wiki target",
		"wikitext": "[[File:Foobar.jpg|link=Main Page]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Main Page",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "File with link to page section",
		"wikitext": "[[Main Page#section]]\n[[File:Foobar.jpg|link=Main Page#section]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "#section",
				"name": "link-ground link-tosection"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Main Page#section",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with link parameter, URL target",
		"wikitext": "[[File:Foobar.jpg|link=http://example.com/]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "http://example.com/",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with link parameter, protocol-less URL target",
		"wikitext": "[[File:Foobar.jpg|link=//example.com/]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "//example.com/",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with link parameter, wgExternalLinkTarget",
		"wikitext": "[[Image:foobar.jpg|link=http://example.com/]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "http://example.com/",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Thumb with link parameter, wgExternalLinkTarget",
		"wikitext": "[[Image:foobar.jpg|thumb|link=http://example.com/]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "http://example.com/",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with link parameter, wgNoFollowLinks set to false",
		"wikitext": "[[Image:foobar.jpg|link=http://example.com/]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "http://example.com/",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with link parameter, wgNoFollowDomainExceptions",
		"wikitext": "[[Image:foobar.jpg|link=http://example.com/]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "http://example.com/",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with link parameter, wgExternalLinkTarget, unnamed parameter",
		"wikitext": "[[Image:foobar.jpg|link=http://example.com/|Title]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "http://example.com/",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Title",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with empty link parameter",
		"wikitext": "[[File:Foobar.jpg|link=]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with link parameter (wiki target) and unnamed parameter",
		"wikitext": "[[File:Foobar.jpg|link=Main_Page|Title]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Main_Page",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Title",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with link parameter (URL target) and unnamed parameter",
		"wikitext": "[[File:Foobar.jpg|link=http://example.com/|Title]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "http://example.com/",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Title",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Thumbnail image with link parameter",
		"wikitext": "[[File:Foobar.jpg|thumb|link=http://example.com/|Title]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "http://example.com/",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Title",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Manually-specified thumbnail image",
		"wikitext": "[[File:Foobar.jpg|thumbnail=Thumb.png|Title]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumbnail=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Thumb.png",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Title",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Manually-specified thumbnail image with explicit link to wiki page",
		"wikitext": "[[File:Foobar.jpg|thumb=Thumb.png|link=Main_Page|Title]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Thumb.png",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Main_Page",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Title",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Manually-specified thumbnail image with explicit link to url",
		"wikitext": "[[File:Foobar.jpg|thumb=Thumb.png|link=http://example.com|Title]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Thumb.png",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "http://example.com",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Title",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Manually-specified thumbnail image with explicit no link",
		"wikitext": "[[File:Foobar.jpg|thumb=Thumb.png|link=|Title]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Thumb.png",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Title",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Manually-specified thumbnail image with explicit link and alt text",
		"wikitext": "[[File:Foobar.jpg|thumb=Thumb.png|link=Main_Page|alt=alttext|Title]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Thumb.png",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Main_Page",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "alt=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "alttext",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Title",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with frame and link",
		"wikitext": "[[File:Foobar.jpg|frame|left|This is a test image [[Main Page]]]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frame",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "left",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "This is a test image ",
				"name": "link-ground file-text"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with frame and link and explicit alt",
		"wikitext": "[[Image:Foobar.jpg|frame|left|This is a test image [[Main Page]]|alt=Altitude]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frame",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "left",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "This is a test image ",
				"name": "link-ground file-text"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "alt=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Altitude",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with wiki markup in implicit alt",
		"wikitext": "[[Image:Foobar.jpg|testing '''bold''' in alt]]\n\n[[Image:Foobar.jpg|alt=testing '''bold''' in alt]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "testing ",
				"name": "link-ground file-text"
			},
			{
				"text": "'''",
				"name": "link-ground apostrophes"
			},
			{
				"text": "bold",
				"name": "link-ground file-text strong"
			},
			{
				"text": "'''",
				"name": "link-ground apostrophes"
			},
			{
				"text": " in alt",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "alt=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "testing ",
				"name": "link-ground file-text"
			},
			{
				"text": "'''",
				"name": "link-ground apostrophes"
			},
			{
				"text": "bold",
				"name": "link-ground file-text strong"
			},
			{
				"text": "'''",
				"name": "link-ground apostrophes"
			},
			{
				"text": " in alt",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Alt image option should handle most kinds of wikitext without barfing",
		"wikitext": "[[Image:Foobar.jpg|thumb|This is the image caption|alt=This is a [[link]] and a {{1x|''bold template''}}.]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "This is the image caption",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "alt=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "This is a ",
				"name": "link-ground file-text"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "link",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " and a ",
				"name": "link-ground file-text"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground template-delimiter"
			},
			{
				"text": "''",
				"name": "template-link-ground apostrophes"
			},
			{
				"text": "bold template",
				"name": "template-link-ground template"
			},
			{
				"text": "''",
				"name": "template-link-ground apostrophes"
			},
			{
				"text": "}}",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": ".",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Ampersand in alt attribute (T206940)",
		"wikitext": "[[File:Foobar.jpg|alt=&amp;amp;]]\n\n<!-- consistency with gallery extension -->\n<gallery>\nFile:Foobar.jpg|alt=&amp;amp;\n</gallery>",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "alt=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "&amp;",
				"name": "link-ground entity"
			},
			{
				"text": "amp;",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "<!-- consistency with gallery extension -->",
				"name": "comment"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg|alt=",
				"name": "tag-gallery"
			},
			{
				"text": "&amp;",
				"name": "tag-gallery entity"
			},
			{
				"text": "amp;",
				"name": "tag-gallery"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Link with encoded pipe in alt option",
		"wikitext": "[[File:Foobar.jpg|alt=http://testing.123?4=5&#x7C;6|caption]]\n\n[[File:Foobar.jpg|alt=http://testing.123?4=5&vert;6|caption]]\n\n<!-- consistency with gallery extension -->\n<gallery>\nFile:Foobar.jpg|alt=http://testing.123?4=5&#x7C;6|caption\nFile:Foobar.jpg|alt=http://testing.123?4=5&vert;6|caption\n</gallery>",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "alt=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "http://testing.123?4=5",
				"name": "link-ground file-text"
			},
			{
				"text": "&#x7C;",
				"name": "link-ground entity"
			},
			{
				"text": "6",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "alt=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "http://testing.123?4=5",
				"name": "link-ground file-text"
			},
			{
				"text": "&vert;",
				"name": "link-ground entity"
			},
			{
				"text": "6",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "<!-- consistency with gallery extension -->",
				"name": "comment"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg|alt=",
				"name": "tag-gallery"
			},
			{
				"text": "http://",
				"name": "tag-gallery free-extlink-protocol"
			},
			{
				"text": "testing.123?4=5&#x7C;6|caption",
				"name": "tag-gallery free-extlink"
			},
			{
				"text": "File:Foobar.jpg|alt=",
				"name": "tag-gallery"
			},
			{
				"text": "http://",
				"name": "tag-gallery free-extlink-protocol"
			},
			{
				"text": "testing.123?4=5&vert;6|caption",
				"name": "tag-gallery free-extlink"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Italics markup in alt attribute (T206940)",
		"wikitext": "[[File:Foobar.jpg|alt=''x''|caption]]\n\n<!-- consistency with gallery extension -->\n<gallery>\nFile:Foobar.jpg|alt=''x''|caption\n</gallery>",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "alt=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "''",
				"name": "link-ground apostrophes"
			},
			{
				"text": "x",
				"name": "link-ground file-text em"
			},
			{
				"text": "''",
				"name": "link-ground apostrophes"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "<!-- consistency with gallery extension -->",
				"name": "comment"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg|alt=",
				"name": "tag-gallery"
			},
			{
				"text": "''",
				"name": "tag-gallery apostrophes"
			},
			{
				"text": "x",
				"name": "tag-gallery em"
			},
			{
				"text": "''",
				"name": "tag-gallery apostrophes"
			},
			{
				"text": "|caption",
				"name": "tag-gallery"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Nowiki markup in alt attribute (edited html, no data-parsoid) (T206940)",
		"wikitext": "[[File:Foobar.jpg|alt=<nowiki>''x''</nowiki>|caption]]\n\n<!-- consistency with gallery extension -->\n<gallery>\nFile:Foobar.jpg|alt=<nowiki>''x''</nowiki>|caption\n</gallery>",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "alt=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "<",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "link-ground exttag-name"
			},
			{
				"text": ">",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": "''x''",
				"name": "tag-nowiki"
			},
			{
				"text": "</",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "link-ground exttag-name"
			},
			{
				"text": ">",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "<!-- consistency with gallery extension -->",
				"name": "comment"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg|alt=",
				"name": "tag-gallery"
			},
			{
				"text": "<",
				"name": "tag-gallery exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "tag-gallery exttag-name"
			},
			{
				"text": ">",
				"name": "tag-gallery exttag-bracket"
			},
			{
				"text": "''x''",
				"name": "tag-gallery tag-nowiki"
			},
			{
				"text": "</",
				"name": "tag-gallery exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "tag-gallery exttag-name"
			},
			{
				"text": ">",
				"name": "tag-gallery exttag-bracket"
			},
			{
				"text": "|caption",
				"name": "tag-gallery"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Ampersand in link attribute (edited html, no data-parsoid) (T206940)",
		"wikitext": "[[File:Foobar.jpg|link=Foo_&_bar]]\n\n<!-- consistency with gallery extension -->\n<gallery>\nFile:Foobar.jpg|link=Foo_&_bar\n</gallery>",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Foo_&_bar",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "<!-- consistency with gallery extension -->",
				"name": "comment"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg|link=Foo_&_bar",
				"name": "tag-gallery"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Italics markup in link attribute (T206940)",
		"wikitext": "[[Foo''s bar''s]]\n\n<!-- Note that \"italics\" are stripped, even though this is a valid page title -->\n[[File:Foobar.jpg|link=Foo''s bar''s|caption1]]\n\n[[File:Foobar.jpg|link=''Main Page''|caption2]]\n\n<!-- consistency with gallery extension -->\n<gallery>\nFile:Foobar.jpg|link=Foo''s bar''s|caption1\nFile:Foobar.jpg|link=''Main Page''|caption2\n</gallery>",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Foo''s bar''s",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "<!-- Note that \"italics\" are stripped, even though this is a valid page title -->",
				"name": "comment"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Foo",
				"name": "link-ground file-text"
			},
			{
				"text": "''",
				"name": "link-ground apostrophes"
			},
			{
				"text": "s bar",
				"name": "link-ground file-text em"
			},
			{
				"text": "''",
				"name": "link-ground apostrophes"
			},
			{
				"text": "s",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption1",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "''",
				"name": "link-ground apostrophes"
			},
			{
				"text": "Main Page",
				"name": "link-ground file-text em"
			},
			{
				"text": "''",
				"name": "link-ground apostrophes"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption2",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "<!-- consistency with gallery extension -->",
				"name": "comment"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg|link=Foo",
				"name": "tag-gallery"
			},
			{
				"text": "''",
				"name": "tag-gallery apostrophes"
			},
			{
				"text": "s bar",
				"name": "tag-gallery em"
			},
			{
				"text": "''",
				"name": "tag-gallery apostrophes"
			},
			{
				"text": "s|caption1File:Foobar.jpg|link=",
				"name": "tag-gallery"
			},
			{
				"text": "''",
				"name": "tag-gallery apostrophes"
			},
			{
				"text": "Main Page",
				"name": "tag-gallery em"
			},
			{
				"text": "''",
				"name": "tag-gallery apostrophes"
			},
			{
				"text": "|caption2",
				"name": "tag-gallery"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Nowiki markup in link attribute (edited html, no data-parsoid) (T206940)",
		"wikitext": "[[File:Foobar.jpg|link=Foo<nowiki>''s_bar''</nowiki>s|caption]]\n\n<!-- consistency with gallery extension -->\n<gallery>\nFile:Foobar.jpg|link=Foo<nowiki>''s_bar''</nowiki>s|caption\n</gallery>",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Foo",
				"name": "link-ground file-text"
			},
			{
				"text": "<",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "link-ground exttag-name"
			},
			{
				"text": ">",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": "''s_bar''",
				"name": "tag-nowiki"
			},
			{
				"text": "</",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "link-ground exttag-name"
			},
			{
				"text": ">",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": "s",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "<!-- consistency with gallery extension -->",
				"name": "comment"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg|link=Foo",
				"name": "tag-gallery"
			},
			{
				"text": "<",
				"name": "tag-gallery exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "tag-gallery exttag-name"
			},
			{
				"text": ">",
				"name": "tag-gallery exttag-bracket"
			},
			{
				"text": "''s_bar''",
				"name": "tag-gallery tag-nowiki"
			},
			{
				"text": "</",
				"name": "tag-gallery exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "tag-gallery exttag-name"
			},
			{
				"text": ">",
				"name": "tag-gallery exttag-bracket"
			},
			{
				"text": "s|caption",
				"name": "tag-gallery"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "HTML entity prefix in link markup (T209236)",
		"wikitext": "[[File:Foobar.jpg|link=https://example.com?foo&params=bar]]\n\n<!-- consistency with gallery extension -->\n<gallery>\nFile:Foobar.jpg|link=https://example.com?foo&params=bar\n</gallery>",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "https://example.com?foo&params=bar",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "<!-- consistency with gallery extension -->",
				"name": "comment"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg|link=",
				"name": "tag-gallery"
			},
			{
				"text": "https://",
				"name": "tag-gallery free-extlink-protocol"
			},
			{
				"text": "example.com?foo&params=bar",
				"name": "tag-gallery free-extlink"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Image with heading and horizontal rule in caption",
		"wikitext": "[[File:Foobar.jpg|thumb|\n===Testing===\n123\n--------------\n]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "===Testing===123--------------",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with 'frameless' first.",
		"wikitext": "[[File:Foobar.jpg|frameless|caption]]\n\n[[File:Foobar.jpg|frameless|frame|caption]]\n\n[[File:Foobar.jpg|frameless|thumb|caption]]\n\n[[File:Foobar.jpg|frameless|thumbnail=Thumb.png|caption]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frameless",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frameless",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frame",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frameless",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frameless",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumbnail=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Thumb.png",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with 'frame' first.",
		"wikitext": "[[File:Foobar.jpg|frame|caption]]\n[[File:Foobar.jpg|frame|frameless|caption]]\n[[File:Foobar.jpg|frame|thumb|caption]]\n[[File:Foobar.jpg|frame|thumbnail=Thumb.png|caption]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frame",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frame",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frameless",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frame",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frame",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumbnail=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Thumb.png",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with 'thumb' first.",
		"wikitext": "[[File:Foobar.jpg|thumb|caption]]\n[[File:Foobar.jpg|thumb|frameless|caption]]\n[[File:Foobar.jpg|thumb|frame|caption]]\n[[File:Foobar.jpg|thumb|thumbnail=Thumb.png|caption]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frameless",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frame",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumbnail=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Thumb.png",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with 'thumbnail=' first.",
		"wikitext": "[[File:Foobar.jpg|thumbnail=Thumb.png|caption]]\n[[File:Foobar.jpg|thumbnail=Thumb.png|frameless|caption]]\n[[File:Foobar.jpg|thumbnail=Thumb.png|frame|caption]]\n[[File:Foobar.jpg|thumbnail=Thumb.png|thumb|caption]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumbnail=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Thumb.png",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumbnail=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Thumb.png",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frameless",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumbnail=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Thumb.png",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frame",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumbnail=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Thumb.png",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image: unspecified format and border enlarge",
		"wikitext": "[[File:Foobar.jpg|2000px]]\n\n[[File:Foobar.jpg|border|2000px]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "2000px",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "border",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "2000px",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image: \"unspecified format\" and border reduce",
		"wikitext": "[[File:Foobar.jpg|1000px]]\n\n[[File:Foobar.jpg|border|1000px]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "1000px",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "border",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "1000px",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image: thumbs reduce",
		"wikitext": "[[File:Foobar.jpg|thumb|50px]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "50px",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image: bitmap thumbs can't be enlarged past original size, but vector can.",
		"wikitext": "[[File:Foobar.jpg|thumb|2000px]]\n\n[[File:Foobar.svg|thumb|2000px]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "2000px",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.svg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "2000px",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image: frameless can reduce in size",
		"wikitext": "[[File:Foobar.jpg|frameless|50px]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frameless",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "50px",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image: bitmap frameless can't be enlarged past original size, but vector can",
		"wikitext": "[[File:Foobar.jpg|frameless|2000px]]\n\n[[File:Foobar.svg|frameless|2000px]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frameless",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "2000px",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.svg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frameless",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "2000px",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image: framed images are always unscaled.",
		"wikitext": "[[File:Foobar.jpg|frame]]\n\n[[File:Foobar.jpg|frame|50px]]\n\n[[File:Foobar.jpg|frame|50x50px]]\n\n[[File:Foobar.jpg|frame|2000px]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frame",
				"name": "link-ground image-parameter"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frame",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "50px",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frame",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "50x50px",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frame",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "2000px",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image: framed vector images are scaled to their default size AND have srcset",
		"wikitext": "[[File:Foobar.svg|frame]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.svg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frame",
				"name": "link-ground image-parameter"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image: manualthumb images are always unscaled.",
		"wikitext": "[[File:Foobar.jpg|thumbnail=Thumb.png]]\n\n[[File:Foobar.jpg|thumbnail=Thumb.png|50px]]\n\n[[File:Foobar.jpg|thumbnail=Thumb.png|50x50px]]\n\n[[File:Foobar.jpg|thumbnail=Thumb.png|2000px]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumbnail=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Thumb.png",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumbnail=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Thumb.png",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "50px",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumbnail=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Thumb.png",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "50x50px",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumbnail=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Thumb.png",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "2000px",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Link to image page- image page normally doesn't exist, hence edit link\nAdd test with existing image page\n#<p><a href=\"/wiki/File:Test\" title=\"Image:Test\">Image:test</a>",
		"wikitext": "[[:Image:test]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": ":Image:test",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "T20784  Link to non-existent image page with caption should use caption as link text",
		"wikitext": "[[:Image:test|caption]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": ":Image:test",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Frameless image caption with a free URL",
		"wikitext": "[[File:Foobar.jpg|http://example.com]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "http://example.com",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Thumbnail image caption with a free URL",
		"wikitext": "[[File:Foobar.jpg|thumb|http://example.com]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "http://example.com",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Thumbnail image caption with a free URL and explicit alt",
		"wikitext": "[[File:Foobar.jpg|thumb|http://example.com|alt=Alteration]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "http://example.com",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "alt=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Alteration",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "SVG thumbnails with no language set",
		"wikitext": "[[File:Foobar.svg|thumb|caption]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.svg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "SVG thumbnails with language de",
		"wikitext": "[[File:Foobar.svg|lang=de|thumb|caption]]\n\n<gallery>\nFile:Foobar.svg|lang=de|caption\n</gallery>",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.svg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "lang=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "de",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.svg|lang=de|caption",
				"name": "tag-gallery"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "SVG thumbnails with invalid language code",
		"wikitext": "[[File:Foobar.svg|thumb|caption|lang=invalid:language:code]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.svg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "lang=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "invalid:language:code",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "T3887: A ISBN with a thumbnail",
		"wikitext": "[[File:Foobar.jpg|thumb|ISBN 1235467890]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "ISBN 1235467890",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "T3887: A RFC with a thumbnail",
		"wikitext": "[[File:Foobar.jpg|thumb|This is RFC 12354]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "This is RFC 12354",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "T3887: A mailto link with a thumbnail",
		"wikitext": "[[File:Foobar.jpg|thumb|Please mailto:nobody@example.com]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Please mailto:nobody@example.com",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "T2648: Frameless image caption with a link",
		"wikitext": "[[File:Foobar.jpg|text with a [[link]] in it]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "text with a ",
				"name": "link-ground file-text"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "link",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " in it",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "T2648: Frameless image caption with a link (suffix)",
		"wikitext": "[[File:Foobar.jpg|text with a [[link]]foo in it]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "text with a ",
				"name": "link-ground file-text"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "link",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "foo in it",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "T2648: Frameless image caption with an interwiki link",
		"wikitext": "[[File:Foobar.jpg|text with a [[MeatBall:Link]] in it]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "text with a ",
				"name": "link-ground file-text"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "MeatBall:Link",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " in it",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "T2648: Frameless image caption with a piped interwiki link",
		"wikitext": "[[File:Foobar.jpg|text with a [[MeatBall:Link|link]] in it]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "text with a ",
				"name": "link-ground file-text"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "MeatBall:Link",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " in it",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Escape HTML special chars in image alt text",
		"wikitext": "[[File:Foobar.jpg|& < > \"]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "& < > \"",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Entities in file name and attributes",
		"wikitext": "[[File:7%25 solution.gif|manualthumb=7%25 solution.gif|link=7%25 solution|[[7%25 solution]]]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:7%25 solution.gif",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "manualthumb=7%25 solution.gif",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "7%25 solution",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "7%25 solution",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "T2499: Alt text should have &#1234;, not &amp;1234;",
		"wikitext": "[[File:Foobar.jpg|&#9792;]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "&#9792;",
				"name": "link-ground entity"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Broken image caption with link",
		"wikitext": "[[Image:Foobar.jpg|thumb|This is a broken caption. But [[Main Page|this]] is just an ordinary link.",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "This is a broken caption. But ",
				"name": "link-ground file-text"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "this",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " is just an ordinary link.",
				"name": "link-ground file-text"
			}
		]
	},
	{
		"desc": "Image caption containing another image",
		"wikitext": "[[File:Foobar.jpg|thumb|This is a caption with another [[File:Thumb.png|image]] inside it!]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "This is a caption with another ",
				"name": "link-ground file-text"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Thumb.png",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "image",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " inside it!",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image: caption containing a newline",
		"wikitext": "[[File:Foobar.jpg|This\n*is some text]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "This*is some text",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image: caption containing leading space",
		"wikitext": "[[File:Foobar.jpg|thumb| bar]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "| ",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "bar",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image: caption containing a table",
		"wikitext": "[[Image:Foobar.jpg|thumb|200px|This is an example image thumbnail caption with a table\n{|\n!Foo!!Bar\n|-\n|Foo1||Bar1\n|}\nand some more text.]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "200px",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "This is an example image thumbnail caption with a table{",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "!Foo!!Bar",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "-",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Foo1",
				"name": "link-ground file-text"
			},
			{
				"text": "||",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Bar1",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "}and some more text.",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "T5090: External links other than http: in image captions",
		"wikitext": "[[File:Foobar.jpg|thumb|200x200px|This caption has [irc://example.net irc] and [https://example.com Secure] ext links in it.]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "200x200px",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "This caption has ",
				"name": "link-ground file-text"
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "irc://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "example.net",
				"name": "link-ground extlink"
			},
			{
				"text": " irc",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": " and ",
				"name": "link-ground file-text"
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "https://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "example.com",
				"name": "link-ground extlink"
			},
			{
				"text": " Secure",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": " ext links in it.",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Custom class",
		"wikitext": "[[Image:foobar.jpg|a|class=b]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "a",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "class=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "b",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "\"border\", \"frameless\" and \"class\" attributes on an image.",
		"wikitext": "[[File:Foobar.jpg|frameless|border|class=extra|caption]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frameless",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "border",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "class=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "extra",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Invalid image attributes (T64500)",
		"wikitext": "[[File:Foobar.jpg|thumb|float|left|caption]]\n\n[[File:Foobar.jpg|thumb|righ|caption]]\n\n[[File:Foobar.jpg|bogus1|thumb|bogus2|left|bogus3|caption]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "float",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "left",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "righ",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "bogus1",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "bogus2",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "left",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "bogus3",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Redirected image",
		"wikitext": "[[Image:Barfoo.jpg]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:Barfoo.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Parsoid-specific image handling - lang option",
		"wikitext": "foo\n[[File:Foobar.svg|lang=de|caption]]\nbar",
		"tokens": [
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.svg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "lang=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "de",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "bar",
				"name": ""
			}
		]
	},
	{
		"desc": "File containing double quotes and spaces",
		"wikitext": "[[File:Cool \"Gator\".png]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Cool \"Gator\".png",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "File containing single quotes",
		"wikitext": "[[File:Foo's ''italic'' bar.jpg]]\n[[File:Foo's ''italic'' bar.jpg|Foo's ''italic'' bar]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foo's ''italic'' bar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foo's ''italic'' bar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Foo's ",
				"name": "link-ground file-text"
			},
			{
				"text": "''",
				"name": "link-ground apostrophes"
			},
			{
				"text": "italic",
				"name": "link-ground file-text em"
			},
			{
				"text": "''",
				"name": "link-ground apostrophes"
			},
			{
				"text": " bar",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Broken image links with HTML captions (T41700)",
		"wikitext": "[[File:Nonexistent|<script></script>]]\n[[File:Nonexistent|100x100px|<script></script>]]\n[[File:Nonexistent|&lt;]]\n[[File:Nonexistent|a<i>b</i>c]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Nonexistent",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "<script></script>",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Nonexistent",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "100x100px",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "<script></script>",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Nonexistent",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "&lt;",
				"name": "link-ground entity"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Nonexistent",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "a",
				"name": "link-ground file-text"
			},
			{
				"text": "<",
				"name": "link-ground htmltag-bracket"
			},
			{
				"text": "i",
				"name": "link-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "link-ground htmltag-bracket"
			},
			{
				"text": "b",
				"name": "link-ground file-text"
			},
			{
				"text": "</",
				"name": "link-ground htmltag-bracket"
			},
			{
				"text": "i",
				"name": "link-ground htmltag-name"
			},
			{
				"text": ">",
				"name": "link-ground htmltag-bracket"
			},
			{
				"text": "c",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Media in wikilink",
		"wikitext": "[[Test|[[File:Foobar.jpg]]]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Test",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "]]",
				"name": ""
			}
		]
	},
	{
		"desc": "Template with thumb image (with link in description)",
		"wikitext": "{{paramtest|param=[[Image:noimage.png|thumb|[[no link|link]] [[no link|caption]]]]}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "paramtest",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "param=",
				"name": "template-ground template-argument-name"
			},
			{
				"text": "[[",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "Image:noimage.png",
				"name": "template-link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "template-link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "template-link-ground link-delimiter"
			},
			{
				"text": "[[",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "no link",
				"name": "template-link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground link-delimiter"
			},
			{
				"text": "link",
				"name": "template-link-ground link-text"
			},
			{
				"text": "]]",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": " ",
				"name": "template-link-ground file-text"
			},
			{
				"text": "[[",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "no link",
				"name": "template-link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "template-link-ground link-text"
			},
			{
				"text": "]]]]",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "T3219 URL next to image (good)",
		"wikitext": "http://example.com [[File:Foobar.jpg]]",
		"tokens": [
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com",
				"name": "free-extlink"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "T3219 URL next to image (broken)",
		"wikitext": "http://example.com[[File:Foobar.jpg]]",
		"tokens": [
			{
				"text": "http://",
				"name": "free-extlink-protocol"
			},
			{
				"text": "example.com",
				"name": "free-extlink"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image link to nonexistent file (T3850 - good)",
		"wikitext": "[[File:No_such.jpg]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:No_such.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": ":Image link to nonexistent file (T3850 - bad)",
		"wikitext": "[[:Image:No such.jpg]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": ":Image:No such.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Fuzz testing: image with bogus manual thumbnail",
		"wikitext": "[[Image:foobar.jpg|thumbnail= ]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumbnail=",
				"name": "link-ground image-parameter"
			},
			{
				"text": " ",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Gallery with valid attributes",
		"wikitext": "<gallery type=\"123\" summary=\"345\">\nFile:File:Foobar.jpg\n</gallery>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery ",
				"name": "exttag-name"
			},
			{
				"text": "type=\"123\" summary=\"345\"",
				"name": "exttag-attribute ext-gallery"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:File:Foobar.jpg",
				"name": "tag-gallery"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Gallery with line not in the file namespace",
		"wikitext": "<gallery>\n:'''''Albert Willimsky''' ''Geboren am 28.2.1890''\n</gallery>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": ":",
				"name": "tag-gallery list"
			},
			{
				"text": "'''''",
				"name": "tag-gallery apostrophes"
			},
			{
				"text": "Albert Willimsky",
				"name": "tag-gallery strong em"
			},
			{
				"text": "'''",
				"name": "tag-gallery apostrophes"
			},
			{
				"text": " ",
				"name": "tag-gallery em"
			},
			{
				"text": "''",
				"name": "tag-gallery apostrophes"
			},
			{
				"text": "Geboren am 28.2.1890",
				"name": "tag-gallery"
			},
			{
				"text": "''",
				"name": "tag-gallery apostrophes"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Gallery (without px units)",
		"wikitext": "<gallery widths=\"70\" heights=\"40\">\nFile:Foobar.jpg\n</gallery>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery ",
				"name": "exttag-name"
			},
			{
				"text": "widths=\"70\" heights=\"40\"",
				"name": "exttag-attribute ext-gallery"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "tag-gallery"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Gallery (with invalid units)",
		"wikitext": "<gallery widths=\"70em\" heights=\"40em\">\nFile:Foobar.jpg\n</gallery>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery ",
				"name": "exttag-name"
			},
			{
				"text": "widths=\"70em\" heights=\"40em\"",
				"name": "exttag-attribute ext-gallery"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "tag-gallery"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Gallery with template inside caption",
		"wikitext": "<gallery caption=\"{{1x|hi}}\">\nFile:Foobar.jpg|{{1x|ho}}\n</gallery>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery ",
				"name": "exttag-name"
			},
			{
				"text": "caption=\"{{1x|hi}}\"",
				"name": "exttag-attribute ext-gallery"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg|",
				"name": "tag-gallery"
			},
			{
				"text": "{{",
				"name": "tag-gallery template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "tag-gallery template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "tag-gallery template-ground template-delimiter"
			},
			{
				"text": "ho",
				"name": "tag-gallery template-ground template"
			},
			{
				"text": "}}",
				"name": "tag-gallery template-ground template-bracket"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Gallery with wikitext inside caption",
		"wikitext": "<gallery>\nFile:Foobar.jpg|alt=galleryalt|[[File:Foobar.jpg|alt=inneralt|20x20px|desc]]\nFile:Foobar.jpg|alt=galleryalt|{{Test|unamedParam|alt=param}}\n</gallery>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg|alt=galleryalt|",
				"name": "tag-gallery"
			},
			{
				"text": "[[",
				"name": "tag-gallery link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "tag-gallery link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "tag-gallery link-ground link-delimiter"
			},
			{
				"text": "alt=",
				"name": "tag-gallery link-ground image-parameter"
			},
			{
				"text": "inneralt",
				"name": "tag-gallery link-ground file-text"
			},
			{
				"text": "|",
				"name": "tag-gallery link-ground link-delimiter"
			},
			{
				"text": "20x20px",
				"name": "tag-gallery link-ground file-text"
			},
			{
				"text": "|",
				"name": "tag-gallery link-ground link-delimiter"
			},
			{
				"text": "desc",
				"name": "tag-gallery link-ground file-text"
			},
			{
				"text": "]]",
				"name": "tag-gallery link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg|alt=galleryalt|",
				"name": "tag-gallery"
			},
			{
				"text": "{{",
				"name": "tag-gallery template-ground template-bracket"
			},
			{
				"text": "Test",
				"name": "tag-gallery template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "tag-gallery template-ground template-delimiter"
			},
			{
				"text": "unamedParam",
				"name": "tag-gallery template-ground template"
			},
			{
				"text": "|",
				"name": "tag-gallery template-ground template-delimiter"
			},
			{
				"text": "alt=",
				"name": "tag-gallery template-ground template-argument-name"
			},
			{
				"text": "param",
				"name": "tag-gallery template-ground template"
			},
			{
				"text": "}}",
				"name": "tag-gallery template-ground template-bracket"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Gallery with wikitext incl bogus HTML tag (T237318)",
		"wikitext": "<gallery>\nFile:Foobar.jpg|</ref>\n</gallery>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg|",
				"name": "tag-gallery"
			},
			{
				"text": "</ref>",
				"name": "tag-gallery error"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Gallery (with showfilename option)",
		"wikitext": "<gallery showfilename=\"\">\nFile:Nonexistent.jpg|caption\nFile:Nonexistent.jpg\nFile:Foobar.jpg|some '''caption''' [[Main Page]]\nFile:Foobar.jpg\nFile:Redirect to foobar.jpg\n</gallery>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery ",
				"name": "exttag-name"
			},
			{
				"text": "showfilename=\"\"",
				"name": "exttag-attribute ext-gallery"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Nonexistent.jpg|captionFile:Nonexistent.jpgFile:Foobar.jpg|some ",
				"name": "tag-gallery"
			},
			{
				"text": "'''",
				"name": "tag-gallery apostrophes"
			},
			{
				"text": "caption",
				"name": "tag-gallery strong"
			},
			{
				"text": "'''",
				"name": "tag-gallery apostrophes"
			},
			{
				"text": " ",
				"name": "tag-gallery"
			},
			{
				"text": "[[",
				"name": "tag-gallery link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "tag-gallery link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "tag-gallery link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpgFile:Redirect to foobar.jpg",
				"name": "tag-gallery"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Gallery override link with wikilink (T36852)",
		"wikitext": "<gallery>\nFile:Foobar.jpg|link=Wikilink|alt=galleryalt\n</gallery>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg|link=Wikilink|alt=galleryalt",
				"name": "tag-gallery"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Gallery override link with absolute external link (T36852)",
		"wikitext": "<gallery>\nFile:Foobar.jpg|alt=galleryalt|link=http://www.example.org\n</gallery>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg|alt=galleryalt|link=",
				"name": "tag-gallery"
			},
			{
				"text": "http://",
				"name": "tag-gallery free-extlink-protocol"
			},
			{
				"text": "www.example.org",
				"name": "tag-gallery free-extlink"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Gallery with class and style attributes",
		"wikitext": "<gallery class=\"center\" style=\"text-align: center;\">\nFile:Foobar.jpg\n</gallery>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery ",
				"name": "exttag-name"
			},
			{
				"text": "class=\"center\" style=\"text-align: center;\"",
				"name": "exttag-attribute ext-gallery"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "tag-gallery"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Gallery in nolines mode",
		"wikitext": "<gallery mode=\"nolines\" showfilenames=\"yes\" caption=\"No Lines!\">\nFile:Foobar.jpg|foo\n</gallery>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery ",
				"name": "exttag-name"
			},
			{
				"text": "mode=\"nolines\" showfilenames=\"yes\" caption=\"No Lines!\"",
				"name": "exttag-attribute ext-gallery"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg|foo",
				"name": "tag-gallery"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Gallery in slideshow mode",
		"wikitext": "<gallery mode=\"slideshow\" showthumbnails=\"\">\nFile:Foobar.jpg\n</gallery>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery ",
				"name": "exttag-name"
			},
			{
				"text": "mode=\"slideshow\" showthumbnails=\"\"",
				"name": "exttag-attribute ext-gallery"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "tag-gallery"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Gallery in packed mode",
		"wikitext": "<gallery mode=\"packed\">\nFile:Foobar.jpg\n</gallery>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery ",
				"name": "exttag-name"
			},
			{
				"text": "mode=\"packed\"",
				"name": "exttag-attribute ext-gallery"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "tag-gallery"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Gallery in packed-overlay mode",
		"wikitext": "<gallery mode=\"packed-overlay\" showfilenames=\"yes\" caption=\"Packed Overlay!\">\nFile:Foobar.jpg|foo\n</gallery>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery ",
				"name": "exttag-name"
			},
			{
				"text": "mode=\"packed-overlay\" showfilenames=\"yes\" caption=\"Packed Overlay!\"",
				"name": "exttag-attribute ext-gallery"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg|foo",
				"name": "tag-gallery"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Gallery in packed-hover mode",
		"wikitext": "<gallery mode=\"packed-hover\" showfilenames=\"yes\" caption=\"Packed Hover!\">\nFile:Foobar.jpg|foo\n</gallery>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery ",
				"name": "exttag-name"
			},
			{
				"text": "mode=\"packed-hover\" showfilenames=\"yes\" caption=\"Packed Hover!\"",
				"name": "exttag-attribute ext-gallery"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg|foo",
				"name": "tag-gallery"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Centre-aligned image",
		"wikitext": "[[Image:foobar.jpg|centre]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "centre",
				"name": "link-ground image-parameter"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "None-aligned image",
		"wikitext": "[[Image:foobar.jpg|none]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "none",
				"name": "link-ground image-parameter"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Width + Height sized image (using px) (height is ignored)",
		"wikitext": "[[Image:foobar.jpg|640x480px]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "640x480px",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Width-sized image (using px, no following whitespace)",
		"wikitext": "[[Image:foobar.jpg|640px]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "640px",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Width-sized image (using px, with following whitespace - test regression from r39467)",
		"wikitext": "[[Image:foobar.jpg|640px ]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "640px ",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Width-sized image (using px, with preceding whitespace - test regression from r39467)",
		"wikitext": "[[Image:foobar.jpg| 640px]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "| ",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "640px",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with page parameter",
		"wikitext": "[[File:LoremIpsum.djvu]]\n\n[[File:LoremIpsum.djvu|page=2]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:LoremIpsum.djvu",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:LoremIpsum.djvu",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "page=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "2",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with page parameter and link",
		"wikitext": "[[File:LoremIpsum.djvu|link=https://google.com|page=2]]\n[[File:LoremIpsum.djvu|link=https://google.com?page=4|page=2]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:LoremIpsum.djvu",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "https://google.com",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "page=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "2",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:LoremIpsum.djvu",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "https://google.com?page=4",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "page=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "2",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with page parameter and manualthumb",
		"wikitext": "[[File:LoremIpsum.djvu|thumbnail=Thumb.png|page=2]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:LoremIpsum.djvu",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumbnail=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Thumb.png",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "page=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "2",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with page parameter generated by a template",
		"wikitext": "[[File:LoremIpsum.djvu|page={{1x|2}}]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:LoremIpsum.djvu",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "page=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground template-delimiter"
			},
			{
				"text": "2",
				"name": "template-link-ground template"
			},
			{
				"text": "}}",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Images with the \"|\" character in the comment",
		"wikitext": "[[File:Foobar.jpg|thumb|An [http://test/?param1=|left|&param2=|x external] URL]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "An ",
				"name": "link-ground file-text"
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "test/?param1=|left|&param2=|x",
				"name": "link-ground extlink"
			},
			{
				"text": " external",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": " URL",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Free external link invading image caption",
		"wikitext": "[[File:Foobar.jpg|thumb|http://x|hello]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "http://x",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "hello",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Special characters in embedded file links (T29679)",
		"wikitext": "[[File:Contains & ampersand.jpg]]\n[[File:Does not exist.jpg|Title with & ampersand]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Contains & ampersand.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Does not exist.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Title with & ampersand",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "1. Treebuilder fixup of formatting elt",
		"wikitext": "{|\n|\n<small>\n[[Image:Foobar.jpg|right|Test]]\n</small>\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "small",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "right",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Test",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "small",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "2. Treebuilder fixup of formatting elt",
		"wikitext": "'''foo[[File:Foobar.jpg|thumb|caption]]bar'''\n\n<small>[[Image:Foobar.jpg|right|300px]]</small>",
		"tokens": [
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "foo",
				"name": "strong"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename strong"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text strong"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "bar",
				"name": "strong"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "small",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "right",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "300px",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "small",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "3. Treebuilder fixup of formatting elt",
		"wikitext": "<small>'''foo[[File:Foobar.jpg|thumb|caption]]bar'''</small>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "small",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "foo",
				"name": "strong"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename strong"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "caption",
				"name": "link-ground file-text strong"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "bar",
				"name": "strong"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "small",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "4. Treebuilder fixup of formatting elt: formatting tags around captionless images",
		"wikitext": "'''<small>[[Image:Foobar.jpg|right|300px]]</small>'''",
		"tokens": [
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "small",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Image:Foobar.jpg",
				"name": "link-ground link-pagename pagename strong"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "right",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "300px",
				"name": "link-ground file-text strong"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "small",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Image: empty alt attribute (T50924)",
		"wikitext": "[[File:Foobar.jpg|alt=|thumb|bar]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "alt=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "bar",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image: Invalid title as link",
		"wikitext": "[[File:Foobar.jpg|link=<]]\n[[File:Foobar.jpg|link=<|thumb]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "<",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "<",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Image with page parameter and invalid link",
		"wikitext": "[[File:LoremIpsum.djvu|link=<|page=2]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:LoremIpsum.djvu",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "<",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "page=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "2",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Percent decode titles in the link option (T216003#7836261)",
		"wikitext": "[[Test%22123]]\n[[File:Foobar.jpg|link=Test%22123]]\n[[File:Foobar.jpg|link=[[Test%22123]]]]\n\n<gallery>\nFile:Foobar.jpg|link=Test%22123\nFile:Foobar.jpg|link=[[Test%22123]]\n</gallery>",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Test%22123",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Test%22123",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Test%22123",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "File:Foobar.jpg|link=Test%22123File:Foobar.jpg|link=",
				"name": "tag-gallery"
			},
			{
				"text": "[[",
				"name": "tag-gallery link-ground link-bracket"
			},
			{
				"text": "Test%22123",
				"name": "tag-gallery link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "tag-gallery link-ground link-bracket"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Should not double decode the link option",
		"wikitext": "[[Test%2522]]\n[[File:Foobar.jpg|link=Test%2522]]\n[[File:Foobar.jpg|link=[[Test%2522]]]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Test%2522",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Test%2522",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Test%2522",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Magic links inside image captions (autolinked)",
		"wikitext": "[[File:Foobar.jpg|thumb|http://example.com]]\n[[File:Foobar.jpg|thumb|RFC 1234]]\n[[File:Foobar.jpg|thumb|PMID 1234]]\n[[File:Foobar.jpg|thumb|ISBN 123456789x]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "http://example.com",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "RFC 1234",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "PMID 1234",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "ISBN 123456789x",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Thumbnail output",
		"wikitext": "[[File:Thumb.png|thumb]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Thumb.png",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "File with caption with pipe in extension tag attribute",
		"wikitext": "[[File:Foobar.jpg|thumb|Test <nowiki bogus=\"attri|bute\"/> 123]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "Test ",
				"name": "link-ground file-text"
			},
			{
				"text": "<",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": "nowiki ",
				"name": "link-ground exttag-name"
			},
			{
				"text": "bogus=\"attri|bute\"",
				"name": "link-ground exttag-attribute ext-nowiki"
			},
			{
				"text": "/>",
				"name": "link-ground exttag-bracket"
			},
			{
				"text": " 123",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "File with table in caption with extra table attribute spaces",
		"wikitext": "[[File:Foobar.jpg|thumb|\n{|\n|-  \n|hi\n|}\n]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "{",
				"name": "link-ground file-text"
			},
			{
				"text": "||",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "-  ",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "hi",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "}",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "File in formatting element violating content model",
		"wikitext": "<p>''[[File:Foobar.jpg|thumb]]''</p>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "p",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename em"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "p",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "File in formatting element violating content model, multiple open",
		"wikitext": "<p>'''''[[File:Foobar.jpg|thumb]]'''''</p>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "p",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "'''''",
				"name": "apostrophes"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename strong em"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "'''''",
				"name": "apostrophes"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "p",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "File in formatting element violating content model, figcaption content",
		"wikitext": "<p>''test [[File:Foobar.jpg|thumb|123]] 456''</p>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "p",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "test ",
				"name": "em"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename em"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "123",
				"name": "link-ground file-text em"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": " 456",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "p",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Table in figcaption nested in table",
		"wikitext": "{|\n|foo\n|[[File:Foobar.jpg|thumb|\n{|\n|bar\n|}\n]]\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "{",
				"name": "link-ground file-text"
			},
			{
				"text": "||",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "bar",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "}",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Broken inline media with a caption and an alt",
		"wikitext": "[[File:Broken.jpg|alt=An alternative text description.|A caption for the media.]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Broken.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "alt=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "An alternative text description.",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "A caption for the media.",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Broken block media with a caption and an alt",
		"wikitext": "[[File:Broken.jpg|alt=An alternative text description.|thumb|A caption for the media.]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Broken.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "alt=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "An alternative text description.",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "A caption for the media.",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Broken inline media with a caption",
		"wikitext": "[[File:Broken.jpg|A caption for the media.]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Broken.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "A caption for the media.",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Broken block media with a caption",
		"wikitext": "[[File:Broken.jpg|thumb|A caption for the media.]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Broken.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumb",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "A caption for the media.",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Gallery line without file namespace",
		"wikitext": "<gallery>\nFoobar.jpg\n</gallery>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "Foobar.jpg",
				"name": "tag-gallery"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "gallery",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Broken media with frame and frameless formats",
		"wikitext": "[[File:Barfoo.jpg|frame|123]]\n[[File:Barfoo.jpg|frameless|123]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Barfoo.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frame",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "123",
				"name": "link-ground file-text"
			},
			{
				"text": "]][[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Barfoo.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "frameless",
				"name": "link-ground image-parameter"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "123",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Media with broken manualthumb",
		"wikitext": "[[File:Foobar.jpg|thumbnail=Barfoo.jpg|123]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "thumbnail=",
				"name": "link-ground image-parameter"
			},
			{
				"text": "Barfoo.jpg",
				"name": "link-ground file-text"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "123",
				"name": "link-ground file-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "Media with caption that would stringify to a valid media option",
		"wikitext": "[[File:Foobar.jpg|'''thumb''']]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "File:Foobar.jpg",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "'''",
				"name": "link-ground apostrophes"
			},
			{
				"text": "thumb",
				"name": "link-ground file-text strong"
			},
			{
				"text": "'''",
				"name": "link-ground apostrophes"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "pfeqParserTests"
	},
	{
		"desc": "Basic usage of {{=}}",
		"wikitext": "This uses {{=}}.",
		"tokens": [
			{
				"text": "This uses ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "=",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": ".",
				"name": ""
			}
		]
	},
	{
		"desc": "Using {{Template:=}} doesn't invoke the parser function",
		"wikitext": "This uses {{Template:=}}.",
		"tokens": [
			{
				"text": "This uses ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "Template:=",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": ".",
				"name": ""
			}
		]
	},
	{
		"desc": "preTags"
	},
	{
		"desc": "<pre> with attributes (T5202)",
		"wikitext": "<pre style=\"background: blue; color:white\">Bluescreen of WikiDeath</pre>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "pre ",
				"name": "exttag-name"
			},
			{
				"text": "style=\"background: blue; color:white\"",
				"name": "exttag-attribute ext-pre"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "Bluescreen of WikiDeath",
				"name": "tag-pre"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "<pre> with width attribute (T5202)",
		"wikitext": "<pre width=\"8\">Narrow screen goodies</pre>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "pre ",
				"name": "exttag-name"
			},
			{
				"text": "width=\"8\"",
				"name": "exttag-attribute ext-pre"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "Narrow screen goodies",
				"name": "tag-pre"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "<pre> with forbidden attribute (T5202)",
		"wikitext": "<pre width=\"8\" onmouseover=\"alert(document.cookie)\">Narrow screen goodies</pre>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "pre ",
				"name": "exttag-name"
			},
			{
				"text": "width=\"8\" onmouseover=\"alert(document.cookie)\"",
				"name": "exttag-attribute ext-pre"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "Narrow screen goodies",
				"name": "tag-pre"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Entities inside <pre>",
		"wikitext": "<pre>&lt;</pre>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "&lt;",
				"name": "tag-pre entity"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "<pre> with forbidden attribute values (T5202)",
		"wikitext": "<pre width=\"8\" style=\"border-width: expression(alert(document.cookie))\">Narrow screen goodies</pre>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "pre ",
				"name": "exttag-name"
			},
			{
				"text": "width=\"8\" style=\"border-width: expression(alert(document.cookie))\"",
				"name": "exttag-attribute ext-pre"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "Narrow screen goodies",
				"name": "tag-pre"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "<nowiki> inside <pre> (T15238)",
		"wikitext": "<pre>\n<nowiki>\n</pre>\n<pre>\n<nowiki></nowiki>\n</pre>\n<pre><nowiki><nowiki></nowiki>Foo<nowiki></nowiki></nowiki></pre>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "<nowiki>",
				"name": "tag-pre"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": "><",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "<nowiki></nowiki>",
				"name": "tag-pre"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": "><",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "<nowiki><nowiki></nowiki>Foo<nowiki></nowiki></nowiki>",
				"name": "tag-pre"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "<nowiki> inside of #tag:pre",
		"wikitext": "{{#tag:pre|Foo <nowiki>&rarr;bar</nowiki>}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "#tag",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "pre",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "Foo ",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "<",
				"name": "ext-ground exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "ext-ground exttag-name"
			},
			{
				"text": ">",
				"name": "ext-ground exttag-bracket"
			},
			{
				"text": "&rarr;",
				"name": "tag-nowiki entity"
			},
			{
				"text": "bar",
				"name": "tag-nowiki"
			},
			{
				"text": "</",
				"name": "ext-ground exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "ext-ground exttag-name"
			},
			{
				"text": ">",
				"name": "ext-ground exttag-bracket"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			}
		]
	},
	{
		"desc": "<nowiki> and <pre> preference (first one wins)",
		"wikitext": "<pre>\n<nowiki>\n</pre>\n</nowiki>\n</pre>\n\n<nowiki>\n<pre>\n<nowiki>\n</pre>\n</nowiki>\n</pre>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "<nowiki>",
				"name": "tag-pre"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "</nowiki></pre>",
				"name": "error"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "<pre><nowiki></pre>",
				"name": "tag-nowiki"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "</pre>",
				"name": "error"
			}
		]
	},
	{
		"desc": "</pre> inside nowiki",
		"wikitext": "<nowiki></pre></nowiki>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "</pre>",
				"name": "tag-nowiki"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Empty pre; pre inside other HTML tags (T56946)",
		"wikitext": "a\n\n<div><pre>\nfoo\n</pre></div>\n<pre></pre>",
		"tokens": [
			{
				"text": "a",
				"name": ""
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "foo",
				"name": "tag-pre"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": "></",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "HTML pre followed by indent-pre",
		"wikitext": "<pre>foo</pre>\n bar",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "foo",
				"name": "tag-pre"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": " ",
				"name": "skipformatting"
			},
			{
				"text": "bar",
				"name": ""
			}
		]
	},
	{
		"desc": "Block tag pre",
		"wikitext": "<p><pre>foo</pre></p>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "p",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "foo",
				"name": "tag-pre"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "p",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Pres with newline attributes",
		"wikitext": "<pre class=\"one\ntwo\">hi</pre>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "pre ",
				"name": "exttag-name"
			},
			{
				"text": "class=\"onetwo\"",
				"name": "exttag-attribute ext-pre"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "hi",
				"name": "tag-pre"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Things that look like <pre> tags aren't treated as such",
		"wikitext": "Barack Obama <President> of the United States\n<President></President>",
		"tokens": [
			{
				"text": "Barack Obama <President> of the United States<President></President>",
				"name": ""
			}
		]
	},
	{
		"desc": "Handle broken pre-like tags (T66025)",
		"wikitext": "{{1x|<pre <pre>x</pre>}}\n\n<table><pre </table>",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "<",
				"name": "template-ground exttag-bracket"
			},
			{
				"text": "pre ",
				"name": "template-ground exttag-name"
			},
			{
				"text": "<pre",
				"name": "template-ground exttag-attribute ext-pre"
			},
			{
				"text": ">",
				"name": "template-ground exttag-bracket"
			},
			{
				"text": "x",
				"name": "tag-pre"
			},
			{
				"text": "</",
				"name": "template-ground exttag-bracket"
			},
			{
				"text": "pre",
				"name": "template-ground exttag-name"
			},
			{
				"text": ">",
				"name": "template-ground exttag-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "pre ",
				"name": "exttag-name"
			},
			{
				"text": "</table",
				"name": "exttag-attribute ext-pre"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Less than in attribute position",
		"wikitext": "<pre <pre>123</pre>\n\n<div <div>123</div>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "pre ",
				"name": "exttag-name"
			},
			{
				"text": "<pre",
				"name": "exttag-attribute ext-pre"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "123",
				"name": "tag-pre"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "123",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Parsoid: handle pre with space after attribute",
		"wikitext": "<pre style=\"width:50%;\" >{{1x|foo}}</pre>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "pre ",
				"name": "exttag-name"
			},
			{
				"text": "style=\"width:50%;\" ",
				"name": "exttag-attribute ext-pre"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "{{1x|foo}}",
				"name": "tag-pre"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "Self-closed pre",
		"wikitext": "<pre />",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "pre ",
				"name": "exttag-name"
			},
			{
				"text": "/>",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "HTML-pre: 1. embedded newlines",
		"wikitext": "<pre>foo</pre>\n\n<pre>\nfoo\n</pre>\n\n<pre>\n\nfoo\n</pre>\n\n<pre>\n\n\nfoo\n</pre>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "foo",
				"name": "tag-pre"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": "><",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "foo",
				"name": "tag-pre"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": "><",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "foo",
				"name": "tag-pre"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": "><",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "foo",
				"name": "tag-pre"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "HTML-pre: big spaces",
		"wikitext": "<pre>\n\n\n\n\nhaha\n\n\n\n\nhaha\n\n\n\n\n</pre>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "hahahaha",
				"name": "tag-pre"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "HTML-pre: 2: indented text",
		"wikitext": "<pre>\n foo\n</pre>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": " foo",
				"name": "tag-pre"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "HTML-pre: 3: other wikitext",
		"wikitext": "<pre>\n* foo\n# bar\n= no-h =\n'' no-italic ''\n[[ NoLink ]]\n</pre>",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "* foo# bar= no-h ='' no-italic ''[[ NoLink ]]",
				"name": "tag-pre"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			}
		]
	},
	{
		"desc": "preprocessor"
	},
	{
		"desc": "Preprocessor precedence 1: link is rightmost opening",
		"wikitext": "{{[[Foo|bar}}]]\n\nBut close-brace is not a valid character in a link title:\n{{[[Foo}}|bar]]\n\nHowever, we can still tell this was handled as a link in the preprocessor:\n{{1x|[[Foo}}|bar]]|bat}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "[[",
				"name": "template-ground error"
			},
			{
				"text": "Foo",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "bar",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "]]But close-brace is not a valid character in a link title:",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "[[",
				"name": "template-ground error"
			},
			{
				"text": "Foo",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "|bar]]However, we can still tell this was handled as a link in the preprocessor:",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "[[",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "Foo",
				"name": "template-link-ground link-pagename pagename"
			},
			{
				"text": "}}",
				"name": "template-link-ground error"
			},
			{
				"text": "|",
				"name": "template-link-ground link-delimiter"
			},
			{
				"text": "bar",
				"name": "template-link-ground link-text"
			},
			{
				"text": "]]",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "bat",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Preprocessor precedence 5: tplarg takes precedence over template",
		"wikitext": "{{Precedence5|Bullet}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "Precedence5",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "Bullet",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Preprocessor precedence 6: broken link is rightmost opening",
		"wikitext": "{{1x|[[Foo}}\n\n{{1x|[[Foo|bar|bat=baz}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "[[",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "Foo",
				"name": "template-link-ground link-pagename pagename"
			},
			{
				"text": "}}",
				"name": "template-link-ground error"
			},
			{
				"text": "{{",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template2-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template2-ground template-delimiter"
			},
			{
				"text": "[[",
				"name": "template2-link-ground link-bracket"
			},
			{
				"text": "Foo",
				"name": "template2-link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "template2-link-ground link-delimiter"
			},
			{
				"text": "bar|bat=baz}}",
				"name": "template2-link-ground link-text"
			}
		]
	},
	{
		"desc": "Preprocessor precedence 7: broken template is rightmost opening",
		"wikitext": "[[Foo|{{1x|Bar]]\n\n[[Foo|{{1x|Bar]]-x}}-y]]-z\n\nCareful: linktrails can move the end of the wikilink:\n[[Foo|{{1x|y']]a}}l]]l",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Foo",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "{{",
				"name": "template-link-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-link-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground template-delimiter"
			},
			{
				"text": "Bar]]",
				"name": "template-link-ground template"
			},
			{
				"text": "[[",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "Foo",
				"name": "template-link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground link-delimiter"
			},
			{
				"text": "{{",
				"name": "template2-link-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template2-link-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template2-link-ground template-delimiter"
			},
			{
				"text": "Bar]]-x",
				"name": "template2-link-ground template"
			},
			{
				"text": "}}",
				"name": "template2-link-ground template-bracket"
			},
			{
				"text": "-y",
				"name": "template-link-ground link-text"
			},
			{
				"text": "]]",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "-zCareful: linktrails can move the end of the wikilink:",
				"name": "template-link-ground template"
			},
			{
				"text": "[[",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "Foo",
				"name": "template-link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "template-link-ground link-delimiter"
			},
			{
				"text": "{{",
				"name": "template2-link-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template2-link-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template2-link-ground template-delimiter"
			},
			{
				"text": "y']]a",
				"name": "template2-link-ground template"
			},
			{
				"text": "}}",
				"name": "template2-link-ground template-bracket"
			},
			{
				"text": "l",
				"name": "template-link-ground link-text"
			},
			{
				"text": "]]",
				"name": "template-link-ground link-bracket"
			},
			{
				"text": "l",
				"name": "template-link-ground template"
			}
		]
	},
	{
		"desc": "Preprocessor precedence 9: groups of braces",
		"wikitext": "{{Preprocessor precedence 9|Four|Bullet|1|2}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "Preprocessor precedence 9",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "Four",
				"name": "template-ground template"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "Bullet",
				"name": "template-ground template"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "1",
				"name": "template-ground template"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "2",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Preprocessor precedence 11: found during visual diff testing",
		"wikitext": "{{#tag:span|-{{#tag:span|-{{1x|x}}}}}}\n\n{{1x|-{{1x|-{{1x|x}}}}}}\n\n{{1x|-{{1x|x}}}}",
		"tokens": [
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "#tag",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "span",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "|",
				"name": "ext-ground parserfunction-delimiter"
			},
			{
				"text": "-",
				"name": "ext-ground parserfunction"
			},
			{
				"text": "{{",
				"name": "ext2-ground parserfunction-bracket"
			},
			{
				"text": "#tag",
				"name": "ext2-ground parserfunction-name"
			},
			{
				"text": ":",
				"name": "ext2-ground parserfunction-delimiter"
			},
			{
				"text": "span",
				"name": "ext2-ground parserfunction"
			},
			{
				"text": "|",
				"name": "ext2-ground parserfunction-delimiter"
			},
			{
				"text": "-",
				"name": "ext2-ground parserfunction"
			},
			{
				"text": "{{",
				"name": "template-ext2-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ext2-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ext2-ground template-delimiter"
			},
			{
				"text": "x",
				"name": "template-ext2-ground template"
			},
			{
				"text": "}}",
				"name": "template-ext2-ground template-bracket"
			},
			{
				"text": "}}",
				"name": "ext2-ground parserfunction-bracket"
			},
			{
				"text": "}}",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "-",
				"name": "template-ground template"
			},
			{
				"text": "{{",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template2-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template2-ground template-delimiter"
			},
			{
				"text": "-",
				"name": "template2-ground template"
			},
			{
				"text": "{{",
				"name": "template3-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template3-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template3-ground template-delimiter"
			},
			{
				"text": "x",
				"name": "template3-ground template"
			},
			{
				"text": "}}",
				"name": "template3-ground template-bracket"
			},
			{
				"text": "}}",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "-",
				"name": "template-ground template"
			},
			{
				"text": "{{",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template2-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template2-ground template-delimiter"
			},
			{
				"text": "x",
				"name": "template2-ground template"
			},
			{
				"text": "}}",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Preprocessor precedence 12: broken language converter closed by brace.",
		"wikitext": "This form breaks the template, which is unfortunate:\n*{{1x|foo-{bar}bat}}\n\nBut if the broken language converter markup is inside an extension\ntag, nothing bad happens:\n*<nowiki>foo-{bar}bat</nowiki>\n*{{1x|<nowiki>foo-{bar}bat</nowiki>}}\n*<pre>foo-{bar}bat</pre>\n*{{1x|<pre>foo-{bar}bat</pre>}}",
		"tokens": [
			{
				"text": "This form breaks the template, which is unfortunate:",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "foo-{bar}bat",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "But if the broken language converter markup is inside an extensiontag, nothing bad happens:",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "foo-{bar}bat",
				"name": "tag-nowiki"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "<",
				"name": "template-ground exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "template-ground exttag-name"
			},
			{
				"text": ">",
				"name": "template-ground exttag-bracket"
			},
			{
				"text": "foo-{bar}bat",
				"name": "tag-nowiki"
			},
			{
				"text": "</",
				"name": "template-ground exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "template-ground exttag-name"
			},
			{
				"text": ">",
				"name": "template-ground exttag-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "foo-{bar}bat",
				"name": "tag-pre"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "pre",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "<",
				"name": "template-ground exttag-bracket"
			},
			{
				"text": "pre",
				"name": "template-ground exttag-name"
			},
			{
				"text": ">",
				"name": "template-ground exttag-bracket"
			},
			{
				"text": "foo-{bar}bat",
				"name": "tag-pre"
			},
			{
				"text": "</",
				"name": "template-ground exttag-bracket"
			},
			{
				"text": "pre",
				"name": "template-ground exttag-name"
			},
			{
				"text": ">",
				"name": "template-ground exttag-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Preprocessor precedence 13: broken language converter in external link",
		"wikitext": "*[http://example.com/-{foo Example in URL]\n*[http://example.com Example in -{link} description]\n*{{1x|[http://example.com/-{foo Breaks template, however]}}",
		"tokens": [
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "example.com/-{foo",
				"name": "link-ground extlink"
			},
			{
				"text": " Example in URL",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "example.com",
				"name": "link-ground extlink"
			},
			{
				"text": " Example in -{link} description",
				"name": "link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "[",
				"name": "template-link-ground extlink-bracket"
			},
			{
				"text": "http://",
				"name": "template-link-ground extlink-protocol"
			},
			{
				"text": "example.com/-{foo",
				"name": "template-link-ground extlink"
			},
			{
				"text": " Breaks template, however",
				"name": "template-link-ground extlink-text"
			},
			{
				"text": "]",
				"name": "template-link-ground extlink-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Preprocessor precedence 14: broken language converter in comment",
		"wikitext": "*<!--{{foo}}-->...should be ok\n*<!---{{foo}}-->...extra dashes\n*{{1x|foo<!-- -{bar} -->bat}}...should be ok",
		"tokens": [
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "<!--{{foo}}-->",
				"name": "comment"
			},
			{
				"text": "...should be ok",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "<!---{{foo}}-->",
				"name": "comment"
			},
			{
				"text": "...extra dashes",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "foo",
				"name": "template-ground template"
			},
			{
				"text": "<!-- -{bar} -->",
				"name": "template-ground comment"
			},
			{
				"text": "bat",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "...should be ok",
				"name": ""
			}
		]
	},
	{
		"desc": "Preprocessor precedence 15: broken brace markup in headings",
		"wikitext": "__NOTOC__ __NOEDITSECTION__\n===1 foo[bar 1===\n1\n===2 foo[[bar 2===\n2\n===3 foo{bar 3===\n3\n===4 foo{{bar 4===\n4\n===5 foo{{{bar 5===\n5\n===6 foo-{bar 6===\n6",
		"tokens": [
			{
				"text": "__NOTOC__",
				"name": "double-underscore"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "__NOEDITSECTION__",
				"name": "double-underscore"
			},
			{
				"text": "===",
				"name": "section-header section--3"
			},
			{
				"text": "1 foo[bar 1",
				"name": "section"
			},
			{
				"text": "===",
				"name": "section-header"
			},
			{
				"text": "1",
				"name": ""
			},
			{
				"text": "===",
				"name": "section-header section--3"
			},
			{
				"text": "2 foo",
				"name": "section"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "bar 2===",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "2",
				"name": "section-header"
			},
			{
				"text": "===",
				"name": "section-header section--3"
			},
			{
				"text": "3 foo{bar 3",
				"name": "section"
			},
			{
				"text": "===",
				"name": "section-header"
			},
			{
				"text": "3",
				"name": ""
			},
			{
				"text": "===",
				"name": "section-header section--3"
			},
			{
				"text": "4 foo",
				"name": "section"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "bar 4===",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "4",
				"name": "section-header"
			},
			{
				"text": "===",
				"name": "section-header section--3"
			},
			{
				"text": "5 foo",
				"name": "section"
			},
			{
				"text": "{{{",
				"name": "templatevariable-bracket"
			},
			{
				"text": "bar 5===5===6 foo-{bar 6===6",
				"name": "templatevariable-name"
			}
		]
	},
	{
		"desc": "Preprocessor precedence 17: template w/o target shouldn't prevent closing",
		"wikitext": "{{1x|hi {{}}}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "hi ",
				"name": "template-ground template"
			},
			{
				"text": "{{}}",
				"name": "template2-ground template-bracket"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Preprocessor precedence 19: break syntax",
		"wikitext": "-{{",
		"tokens": [
			{
				"text": "-",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Language converter over extlink",
		"wikitext": "{{1x\n| [-{oh no]}-]\n}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": " [-{oh no]}-]",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "quotes"
	},
	{
		"desc": "Quotes",
		"wikitext": "Normal text. '''Bold text.''' Normal text. ''Italic text.''\n\nNormal text. '''''Bold italic text.''''' Normal text.",
		"tokens": [
			{
				"text": "Normal text. ",
				"name": ""
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "Bold text.",
				"name": "strong"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": " Normal text. ",
				"name": ""
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "Italic text.",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "Normal text. ",
				"name": ""
			},
			{
				"text": "'''''",
				"name": "apostrophes"
			},
			{
				"text": "Bold italic text.",
				"name": "strong em"
			},
			{
				"text": "'''''",
				"name": "apostrophes"
			},
			{
				"text": " Normal text.",
				"name": ""
			}
		]
	},
	{
		"desc": "Quotes wrapping HTML table",
		"wikitext": "'''<table><tr><td>hi</td></tr></table>'''",
		"tokens": [
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "tr",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "hi",
				"name": "strong"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "tr",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Unclosed and unmatched quotes",
		"wikitext": "'''''Bold italic text '''with bold deactivated''' in between.'''''\n\n'''''Bold italic text ''with italic deactivated'' in between.'''''\n\n'''Bold text..\n\n..spanning two paragraphs (should not work).'''\n\n'''Bold tag left open\n\n''Italic tag left open\n\nNormal text.\n\n<!-- Unmatching number of opening, closing tags: -->\n'''This year''''s election ''should'' beat '''last year''''s.\n\n''Tom'''s car is bigger than ''Susan'''s.\n\nPlain ''italic'''s plain",
		"tokens": [
			{
				"text": "'''''",
				"name": "apostrophes"
			},
			{
				"text": "Bold italic text ",
				"name": "strong em"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "with bold deactivated",
				"name": "em"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": " in between.",
				"name": "strong em"
			},
			{
				"text": "''''''''''",
				"name": "apostrophes"
			},
			{
				"text": "Bold italic text ",
				"name": "strong em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "with italic deactivated",
				"name": "strong"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": " in between.",
				"name": "strong em"
			},
			{
				"text": "''''''''",
				"name": "apostrophes"
			},
			{
				"text": "Bold text..",
				"name": "strong"
			},
			{
				"text": "..spanning two paragraphs (should not work).",
				"name": ""
			},
			{
				"text": "''''''",
				"name": "apostrophes"
			},
			{
				"text": "Bold tag left open",
				"name": "strong"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "Italic tag left open",
				"name": "em"
			},
			{
				"text": "Normal text.",
				"name": ""
			},
			{
				"text": "<!-- Unmatching number of opening, closing tags: -->",
				"name": "comment"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "This year'",
				"name": "strong"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "s election ",
				"name": ""
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "should",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": " beat ",
				"name": ""
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "last year'",
				"name": "strong"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "s.",
				"name": ""
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "Tom",
				"name": "em"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "s car is bigger than ",
				"name": "strong em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "Susan",
				"name": "strong"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "s.Plain ",
				"name": ""
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "italic'",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "s plain",
				"name": ""
			}
		]
	},
	{
		"desc": "Italics and bold",
		"wikitext": "*plain\n*plain''italic''plain\n*plain''italic''plain''italic''plain\n*plain'''bold'''plain\n*plain'''bold'''plain'''bold'''plain\n*plain''italic''plain'''bold'''plain\n*plain'''bold'''plain''italic''plain\n*plain''italic'''bold-italic'''italic''plain\n*plain'''bold''bold-italic''bold'''plain\n*plain'''''bold-italic'''italic''plain\n*plain'''''bold-italic''bold'''plain\n*plain''italic'''bold-italic'''''plain\n*plain'''bold''bold-italic'''''plain\n*plain l'''italic''plain\n*plain l''''bold''' plain",
		"tokens": [
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "plain",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "plain",
				"name": ""
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "italic",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "plain",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "plain",
				"name": ""
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "italic",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "plain",
				"name": ""
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "italic",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "plain",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "plain",
				"name": ""
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "bold",
				"name": "strong"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "plain",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "plain",
				"name": ""
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "bold",
				"name": "strong"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "plain",
				"name": ""
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "bold",
				"name": "strong"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "plain",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "plain",
				"name": ""
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "italic",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "plain",
				"name": ""
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "bold",
				"name": "strong"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "plain",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "plain",
				"name": ""
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "bold",
				"name": "strong"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "plain",
				"name": ""
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "italic",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "plain",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "plain",
				"name": ""
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "italic",
				"name": "em"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "bold-italic",
				"name": "strong em"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "italic",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "plain",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "plain",
				"name": ""
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "bold",
				"name": "strong"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "bold-italic",
				"name": "strong em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "bold",
				"name": "strong"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "plain",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "plain",
				"name": ""
			},
			{
				"text": "'''''",
				"name": "apostrophes"
			},
			{
				"text": "bold-italic",
				"name": "strong em"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "italic",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "plain",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "plain",
				"name": ""
			},
			{
				"text": "'''''",
				"name": "apostrophes"
			},
			{
				"text": "bold-italic",
				"name": "strong em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "bold",
				"name": "strong"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "plain",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "plain",
				"name": ""
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "italic",
				"name": "em"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "bold-italic",
				"name": "strong em"
			},
			{
				"text": "'''''",
				"name": "apostrophes"
			},
			{
				"text": "plain",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "plain",
				"name": ""
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "bold",
				"name": "strong"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "bold-italic",
				"name": "strong em"
			},
			{
				"text": "'''''",
				"name": "apostrophes"
			},
			{
				"text": "plain",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "plain l'",
				"name": ""
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "italic",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "plain",
				"name": ""
			},
			{
				"text": "*",
				"name": "list"
			},
			{
				"text": "plain l'",
				"name": ""
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "bold",
				"name": "strong"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": " plain",
				"name": ""
			}
		]
	},
	{
		"desc": "Italics and possessives (1)",
		"wikitext": "obtained by ''[[Lunar Prospector]]'''s gamma-ray spectrometer",
		"tokens": [
			{
				"text": "obtained by ",
				"name": ""
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Lunar Prospector",
				"name": "link-ground link-pagename pagename em"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "'",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "s gamma-ray spectrometer",
				"name": ""
			}
		]
	},
	{
		"desc": "Italics and possessives (2)",
		"wikitext": "'''''Flaming Pie''''' is ... released in 1997. In ''Flaming Pie'''s liner notes",
		"tokens": [
			{
				"text": "'''''",
				"name": "apostrophes"
			},
			{
				"text": "Flaming Pie",
				"name": "strong em"
			},
			{
				"text": "'''''",
				"name": "apostrophes"
			},
			{
				"text": " is ... released in 1997. In ",
				"name": ""
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "Flaming Pie'",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "s liner notes",
				"name": ""
			}
		]
	},
	{
		"desc": "Italics and possessives (3)",
		"wikitext": "The first monolingual dictionary written in a Romance language was ''Sebasti√°n Covarrubias''' ''Tesoro de la lengua castellana o espa√±ola'', published in 1611 in Madrid. In 1612 the first edition of the ''Vocabolario dell'[[Accademia della Crusca]]'', for Italian, was published. In 1690 in Rotterdam was published, posthumously, the ''Dictionnaire Universel''.",
		"tokens": [
			{
				"text": "The first monolingual dictionary written in a Romance language was ",
				"name": ""
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "Sebasti√°n Covarrubias'",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "Tesoro de la lengua castellana o espa√±ola",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": ", published in 1611 in Madrid. In 1612 the first edition of the ",
				"name": ""
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "Vocabolario dell'",
				"name": "em"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Accademia della Crusca",
				"name": "link-ground link-pagename pagename em"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": ", for Italian, was published. In 1690 in Rotterdam was published, posthumously, the ",
				"name": ""
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "Dictionnaire Universel",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": ".",
				"name": ""
			}
		]
	},
	{
		"desc": "Italics and bold: 2-quote opening sequence: (2,2)",
		"wikitext": "''foo''",
		"tokens": [
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "foo",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Italics and bold: 2-quote opening sequence: (2,3)",
		"wikitext": "''foo'''",
		"tokens": [
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "foo'",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Italics and bold: 2-quote opening sequence: (2,4)",
		"wikitext": "''foo''''",
		"tokens": [
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "foo''",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Italics and bold: 2-quote opening sequence: (2,4) w/ nowiki",
		"wikitext": "''foo<nowiki>''</nowiki>''",
		"tokens": [
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "foo",
				"name": "em"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "''",
				"name": "tag-nowiki"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Italics and bold: 2-quote opening sequence: (2,5)",
		"wikitext": "''foo'''''",
		"tokens": [
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "foo",
				"name": "em"
			},
			{
				"text": "'''''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Italics and bold: 3-quote opening sequence: (3,2)",
		"wikitext": "'''foo''",
		"tokens": [
			{
				"text": "'",
				"name": ""
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "foo",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Italics and bold: 3-quote opening sequence: (3,3)",
		"wikitext": "'''foo'''",
		"tokens": [
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "foo",
				"name": "strong"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Italics and bold: 3-quote opening sequence: (3,4)",
		"wikitext": "'''foo''''",
		"tokens": [
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "foo'",
				"name": "strong"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Italics and bold: 3-quote opening sequence: (3,5)",
		"wikitext": "'''foo'''''",
		"tokens": [
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "foo",
				"name": "strong"
			},
			{
				"text": "'''''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Italics and bold: 4-quote opening sequence: (4,2)",
		"wikitext": "''''foo''",
		"tokens": [
			{
				"text": "''",
				"name": ""
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "foo",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Italics and bold: 4-quote opening sequence: (4,2) w/ nowiki",
		"wikitext": "<nowiki>''</nowiki>''foo''",
		"tokens": [
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "''",
				"name": "tag-nowiki"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "foo",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Italics and bold: 4-quote opening sequence: (4,3)",
		"wikitext": "''''foo'''",
		"tokens": [
			{
				"text": "'",
				"name": ""
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "foo",
				"name": "strong"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Italics and bold: 4-quote opening sequence: (4,4)",
		"wikitext": "''''foo''''",
		"tokens": [
			{
				"text": "'",
				"name": ""
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "foo'",
				"name": "strong"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Italics and bold: 4-quote opening sequence: (4,4) w/ nowiki",
		"wikitext": "'<nowiki/>'''foo''''",
		"tokens": [
			{
				"text": "'",
				"name": ""
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": "/>",
				"name": "exttag-bracket"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "foo'",
				"name": "strong"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Italics and bold: 4-quote opening sequence: (4,5)",
		"wikitext": "''''foo'''''",
		"tokens": [
			{
				"text": "'",
				"name": ""
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "foo",
				"name": "strong"
			},
			{
				"text": "'''''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Italics and bold: 5-quote opening sequence: (5,2)",
		"wikitext": "'''''foo''",
		"tokens": [
			{
				"text": "'''''",
				"name": "apostrophes"
			},
			{
				"text": "foo",
				"name": "strong em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Italics and bold: 5-quote opening sequence: (5,2+3)",
		"wikitext": "'''''foo'''''",
		"tokens": [
			{
				"text": "'''''",
				"name": "apostrophes"
			},
			{
				"text": "foo",
				"name": "strong em"
			},
			{
				"text": "'''''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Italics and bold: 5-quote opening sequence: (5,3)",
		"wikitext": "'''''foo'''",
		"tokens": [
			{
				"text": "'''''",
				"name": "apostrophes"
			},
			{
				"text": "foo",
				"name": "strong em"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Italics and bold: 5-quote opening sequence: (5,3+2)",
		"wikitext": "'''''foo'''''",
		"tokens": [
			{
				"text": "'''''",
				"name": "apostrophes"
			},
			{
				"text": "foo",
				"name": "strong em"
			},
			{
				"text": "'''''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Italics and bold: 5-quote opening sequence: (5,4)",
		"wikitext": "'''''foo''''",
		"tokens": [
			{
				"text": "'''''",
				"name": "apostrophes"
			},
			{
				"text": "foo'",
				"name": "strong em"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Italics and bold: 5-quote opening sequence: (5,5)",
		"wikitext": "'''''foo'''''",
		"tokens": [
			{
				"text": "'''''",
				"name": "apostrophes"
			},
			{
				"text": "foo",
				"name": "strong em"
			},
			{
				"text": "'''''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Italics and bold: 5-quote opening sequence: (5,6)",
		"wikitext": "'''''foo''''''",
		"tokens": [
			{
				"text": "'''''",
				"name": "apostrophes"
			},
			{
				"text": "foo'",
				"name": "strong em"
			},
			{
				"text": "'''''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Italics and bold: multiple quote sequences: (2,4,2)",
		"wikitext": "''foo''''bar''",
		"tokens": [
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "foo'",
				"name": "em"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "bar",
				"name": "strong em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Italics and bold: multiple quote sequences: (2,4,2+3) w/ nowiki",
		"wikitext": "''foo'<nowiki/>'''bar'''''",
		"tokens": [
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "foo'",
				"name": "em"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": "/>",
				"name": "exttag-bracket"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "bar",
				"name": "strong em"
			},
			{
				"text": "'''''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Italics and bold: multiple quote sequences: (2,4,3)",
		"wikitext": "''foo''''bar'''",
		"tokens": [
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "foo'",
				"name": "em"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "bar",
				"name": "strong em"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Italics and bold: multiple quote sequences: (2,4,3+2) w/ nowiki",
		"wikitext": "''foo'<nowiki/>'''bar'''''",
		"tokens": [
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "foo'",
				"name": "em"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": "/>",
				"name": "exttag-bracket"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "bar",
				"name": "strong em"
			},
			{
				"text": "'''''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Italics and bold: multiple quote sequences: (2,4,4)",
		"wikitext": "''foo''''bar''''",
		"tokens": [
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "foo'",
				"name": "em"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "bar'",
				"name": "strong em"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Italics and bold: multiple quote sequences: (2,4,4+2) w/ nowiki",
		"wikitext": "''foo'<nowiki/>'''bar'<nowiki/>'''''",
		"tokens": [
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "foo'",
				"name": "em"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": "/>",
				"name": "exttag-bracket"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "bar'",
				"name": "strong em"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": "/>",
				"name": "exttag-bracket"
			},
			{
				"text": "'''''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Italics and bold: multiple quote sequences: (3,4,2)",
		"wikitext": "'''foo''''bar''",
		"tokens": [
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "foo'",
				"name": "strong"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "bar",
				"name": ""
			},
			{
				"text": "''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Italics and bold: multiple quote sequences: (3,4,3)",
		"wikitext": "'''foo''''bar'''",
		"tokens": [
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "foo'",
				"name": "strong"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "bar",
				"name": ""
			},
			{
				"text": "'''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Italics and bold: other quote tests: (2,3,5)",
		"wikitext": "''this is about '''foo's family'''''",
		"tokens": [
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "this is about ",
				"name": "em"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "foo's family",
				"name": "strong em"
			},
			{
				"text": "'''''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Italics and bold: other quote tests: (2,(3,3),2)",
		"wikitext": "''this is about '''foo's''' family''",
		"tokens": [
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "this is about ",
				"name": "em"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "foo's",
				"name": "strong em"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": " family",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Italics and bold: other quote tests: (3,2,3,2)",
		"wikitext": "'''this is about ''foo'''s family''",
		"tokens": [
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "this is about ",
				"name": "strong"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "foo",
				"name": "strong em"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "s family",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Italics and bold: other quote tests: (3,2,3+2+2,2)",
		"wikitext": "'''this is about ''foo'''''<nowiki/>''s family''",
		"tokens": [
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "this is about ",
				"name": "strong"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "foo",
				"name": "strong em"
			},
			{
				"text": "'''''",
				"name": "apostrophes"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": "/>",
				"name": "exttag-bracket"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "s family",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Italics and bold: other quote tests: (3,2,3,3)",
		"wikitext": "'''this is about ''foo'''s family'''",
		"tokens": [
			{
				"text": "'",
				"name": ""
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "this is about ",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "s family",
				"name": "strong"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Italics and bold: other quote tests: (3,(2,2),3)",
		"wikitext": "'''this is about ''foo's'' family'''",
		"tokens": [
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "this is about ",
				"name": "strong"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "foo's",
				"name": "strong em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": " family",
				"name": "strong"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			}
		]
	},
	{
		"desc": "Italicized possessive",
		"wikitext": "The ''[[Main Page]]'''s talk page.",
		"tokens": [
			{
				"text": "The ",
				"name": ""
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename em"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "'",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "s talk page.",
				"name": ""
			}
		]
	},
	{
		"desc": "Quote balancing context should be restricted to td/th cells on the same wikitext line",
		"wikitext": "{|\n!''a!!''b\n|''a||''b\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "!",
				"name": "table-delimiter"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "a",
				"name": "strong em"
			},
			{
				"text": "!!",
				"name": "table-delimiter"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "b",
				"name": "strong"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "a",
				"name": "em"
			},
			{
				"text": "||",
				"name": "table-delimiter"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "b",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Bold conversion test",
		"wikitext": "a b'''c ''d e'''f'' g h'''i ''j",
		"tokens": [
			{
				"text": "a b'",
				"name": ""
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "c ",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "d e",
				"name": ""
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "f",
				"name": "strong"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": " g h",
				"name": "strong em"
			},
			{
				"text": "'''",
				"name": "apostrophes"
			},
			{
				"text": "i ",
				"name": "em"
			},
			{
				"text": "''",
				"name": "apostrophes"
			},
			{
				"text": "j",
				"name": ""
			}
		]
	},
	{
		"desc": "redirects"
	},
	{
		"desc": "Redirect followed by block on the same line",
		"wikitext": "#REDIRECT [[Main Page]]<!-- haha -->==hi==",
		"tokens": [
			{
				"text": "#REDIRECT ",
				"name": "redirect"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "<!-- haha -->",
				"name": "comment"
			},
			{
				"text": "==hi==",
				"name": ""
			}
		]
	},
	{
		"desc": "Redirect followed by horizontal rule on the same line",
		"wikitext": "#REDIRECT [[Main Page]]----",
		"tokens": [
			{
				"text": "#REDIRECT ",
				"name": "redirect"
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "----",
				"name": ""
			}
		]
	},
	{
		"desc": "Broken redirect shouldn't crash parsoid (T332242)",
		"wikitext": "<!-- Not a valid redirect nor a valid parser function -->\n{{#REDIRECT [[]]}}",
		"tokens": [
			{
				"text": "<!-- Not a valid redirect nor a valid parser function -->",
				"name": "comment"
			},
			{
				"text": "{{",
				"name": "ext-ground parserfunction-bracket"
			},
			{
				"text": "#REDIRECT ",
				"name": "ext-ground parserfunction-name"
			},
			{
				"text": "[[]]}}",
				"name": ""
			}
		]
	},
	{
		"desc": "tables"
	},
	{
		"desc": "Tables with multiple newlines after individual lines embedded in links",
		"wikitext": "[[Test|\n{|\n\n|test\n|}]]",
		"tokens": [
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Test",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "{||test|}",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			}
		]
	},
	{
		"desc": "A table with no data.",
		"wikitext": "{||}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|}",
				"name": "table-definition html-table"
			}
		]
	},
	{
		"desc": "A table with no data (take 2)",
		"wikitext": "{|\n|}",
		"tokens": [
			{
				"text": "{||}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "A table with no data generated by a <table> markup",
		"wikitext": "<table></table>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Parsoid: Don't paragraph-wrap fosterable content even if table syntax is unbalanced",
		"wikitext": "{|\n<td>\n<td>\n</td>\n\n\n\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "A table with stray table end tags on start tag line (wt2html)",
		"wikitext": "{|style=\"color: red;\"|}\n\n{|style=\"color: red;\" |}\n|foo\n|}\n\n{|style=\"color: red;\"|} id=\"foo\"\n|foo\n|}\n\n{|style=\"color: red;\" |} id=\"foo\"\n|foo\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "style=\"color: red;\"|}",
				"name": "table-definition html-table"
			},
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "style=\"color: red;\" |}",
				"name": "table-definition html-table"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "|}{|",
				"name": "table-bracket"
			},
			{
				"text": "style=\"color: red;\"|} id=\"foo\"",
				"name": "table-definition html-table"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "|}{|",
				"name": "table-bracket"
			},
			{
				"text": "style=\"color: red;\" |} id=\"foo\"",
				"name": "table-definition html-table"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "A table with nothing but a caption",
		"wikitext": "{|\n|+caption\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|+",
				"name": "table-delimiter"
			},
			{
				"text": "caption",
				"name": "table-caption"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "A table with caption with default-spaced attributes and a table row",
		"wikitext": "{|\n|+ style=\"color: red;\" |caption1\n|-\n|foo\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|+ ",
				"name": "table-delimiter"
			},
			{
				"text": "style=\"color: red;\" ",
				"name": "table-definition html-caption"
			},
			{
				"text": "|",
				"name": "table-delimiter2"
			},
			{
				"text": "caption1",
				"name": "table-caption"
			},
			{
				"text": "|-|",
				"name": "table-delimiter"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "A table with captions with non-default spaced attributes and a table row",
		"wikitext": "{|\n|+style=\"color: red;\"|caption2\n|+ style=\"color: red;\"|caption3\n|-\n|foo\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|+",
				"name": "table-delimiter"
			},
			{
				"text": "style=\"color: red;\"",
				"name": "table-definition html-caption"
			},
			{
				"text": "|",
				"name": "table-delimiter2"
			},
			{
				"text": "caption2",
				"name": "table-caption"
			},
			{
				"text": "|+ ",
				"name": "table-delimiter"
			},
			{
				"text": "style=\"color: red;\"",
				"name": "table-definition html-caption"
			},
			{
				"text": "|",
				"name": "table-delimiter2"
			},
			{
				"text": "caption3",
				"name": "table-caption"
			},
			{
				"text": "|-|",
				"name": "table-delimiter"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Table td-cell syntax variations",
		"wikitext": "{|\n|foo bar foo|baz\n|foo bar foo||baz\n|style='color:red;'|baz\n|style='color:red;'||baz\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "foo bar foo",
				"name": "table-definition html-td"
			},
			{
				"text": "|",
				"name": "table-delimiter2"
			},
			{
				"text": "baz",
				"name": ""
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "foo bar foo",
				"name": ""
			},
			{
				"text": "||",
				"name": "table-delimiter"
			},
			{
				"text": "baz",
				"name": ""
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "style='color:red;'",
				"name": "table-definition html-td"
			},
			{
				"text": "|",
				"name": "table-delimiter2"
			},
			{
				"text": "baz",
				"name": ""
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "style='color:red;'",
				"name": ""
			},
			{
				"text": "||",
				"name": "table-delimiter"
			},
			{
				"text": "baz",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Simple table",
		"wikitext": "{|\n|1||2\n|-\n|3||4\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "1",
				"name": ""
			},
			{
				"text": "||",
				"name": "table-delimiter"
			},
			{
				"text": "2",
				"name": ""
			},
			{
				"text": "|-|",
				"name": "table-delimiter"
			},
			{
				"text": "3",
				"name": ""
			},
			{
				"text": "||",
				"name": "table-delimiter"
			},
			{
				"text": "4",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Simple table but with multiple dashes for row wikitext",
		"wikitext": "{|\n|foo\n|-----\n|bar\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "|-----|",
				"name": "table-delimiter"
			},
			{
				"text": "bar",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Multiplication table",
		"wikitext": "{| border=\"1\" cellpadding=\"2\"\n|+Multiplication table\n|-\n!&times;!!1!!2!!3\n|-\n!1\n|1||2||3\n|-\n!2\n|2||4||6\n|-\n!3\n|3||6||9\n|-\n!4\n|4||8||12\n|-\n!5\n|5||10||15\n|}",
		"tokens": [
			{
				"text": "{| ",
				"name": "table-bracket"
			},
			{
				"text": "border=\"1\" cellpadding=\"2\"",
				"name": "table-definition html-table"
			},
			{
				"text": "|+",
				"name": "table-delimiter"
			},
			{
				"text": "Multiplication table",
				"name": "table-caption"
			},
			{
				"text": "|-!",
				"name": "table-delimiter"
			},
			{
				"text": "&times;",
				"name": "entity"
			},
			{
				"text": "!!",
				"name": "table-delimiter"
			},
			{
				"text": "1",
				"name": "strong"
			},
			{
				"text": "!!",
				"name": "table-delimiter"
			},
			{
				"text": "2",
				"name": "strong"
			},
			{
				"text": "!!",
				"name": "table-delimiter"
			},
			{
				"text": "3",
				"name": "strong"
			},
			{
				"text": "|-!",
				"name": "table-delimiter"
			},
			{
				"text": "1",
				"name": "strong"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "1",
				"name": ""
			},
			{
				"text": "||",
				"name": "table-delimiter"
			},
			{
				"text": "2",
				"name": ""
			},
			{
				"text": "||",
				"name": "table-delimiter"
			},
			{
				"text": "3",
				"name": ""
			},
			{
				"text": "|-!",
				"name": "table-delimiter"
			},
			{
				"text": "2",
				"name": "strong"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "2",
				"name": ""
			},
			{
				"text": "||",
				"name": "table-delimiter"
			},
			{
				"text": "4",
				"name": ""
			},
			{
				"text": "||",
				"name": "table-delimiter"
			},
			{
				"text": "6",
				"name": ""
			},
			{
				"text": "|-!",
				"name": "table-delimiter"
			},
			{
				"text": "3",
				"name": "strong"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "3",
				"name": ""
			},
			{
				"text": "||",
				"name": "table-delimiter"
			},
			{
				"text": "6",
				"name": ""
			},
			{
				"text": "||",
				"name": "table-delimiter"
			},
			{
				"text": "9",
				"name": ""
			},
			{
				"text": "|-!",
				"name": "table-delimiter"
			},
			{
				"text": "4",
				"name": "strong"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "4",
				"name": ""
			},
			{
				"text": "||",
				"name": "table-delimiter"
			},
			{
				"text": "8",
				"name": ""
			},
			{
				"text": "||",
				"name": "table-delimiter"
			},
			{
				"text": "12",
				"name": ""
			},
			{
				"text": "|-!",
				"name": "table-delimiter"
			},
			{
				"text": "5",
				"name": "strong"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "5",
				"name": ""
			},
			{
				"text": "||",
				"name": "table-delimiter"
			},
			{
				"text": "10",
				"name": ""
			},
			{
				"text": "||",
				"name": "table-delimiter"
			},
			{
				"text": "15",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Accept \"||\" in table headings",
		"wikitext": "{|\n!h1||h2\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "!",
				"name": "table-delimiter"
			},
			{
				"text": "h1",
				"name": "strong"
			},
			{
				"text": "||",
				"name": "table-delimiter"
			},
			{
				"text": "h2",
				"name": "strong"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Accept \"!!\" in table data",
		"wikitext": "{|\n|Foo!!||\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "Foo!!",
				"name": ""
			},
			{
				"text": "||",
				"name": "table-delimiter"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Accept \"||\" in indented table headings",
		"wikitext": ":{|\n!h1||h2\n|}",
		"tokens": [
			{
				"text": ":",
				"name": "list"
			},
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "!",
				"name": "table-delimiter"
			},
			{
				"text": "h1",
				"name": "strong"
			},
			{
				"text": "||",
				"name": "table-delimiter"
			},
			{
				"text": "h2",
				"name": "strong"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Accept \"!!\" in templates",
		"wikitext": "{|\n!a {{1x|b!!c}}\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "!",
				"name": "table-delimiter"
			},
			{
				"text": "a ",
				"name": "strong"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "b!!c",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Accept \"!!\" in table headings after newline",
		"wikitext": "{|\n!a\nb!!c\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "!",
				"name": "table-delimiter"
			},
			{
				"text": "ab!!c",
				"name": "strong"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Accept \"!!\" in table data of mixed wikitext / html syntax",
		"wikitext": "{|\n!a\n<tr><td>b!!c</td></tr>\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "!",
				"name": "table-delimiter"
			},
			{
				"text": "a",
				"name": "strong"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "tr",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "b!!c",
				"name": "strong"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": "></",
				"name": "htmltag-bracket"
			},
			{
				"text": "tr",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Accept empty attributes in td/th cells (td/th cells starting with leading ||)",
		"wikitext": "{|\n!|h1\n||a\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "!",
				"name": "table-delimiter"
			},
			{
				"text": "|",
				"name": "table-delimiter2"
			},
			{
				"text": "h1",
				"name": "strong"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "|",
				"name": "table-delimiter2"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Accept \"| !\" at start of line in tables (ignore !-attribute)",
		"wikitext": "{|\n|-\n|!style=\"color:red\"|bar\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|-|",
				"name": "table-delimiter"
			},
			{
				"text": "!style=\"color:red\"",
				"name": "table-definition html-td"
			},
			{
				"text": "|",
				"name": "table-delimiter2"
			},
			{
				"text": "bar",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Allow +/- in 2nd and later cells in a row, in 1st cell when td-attrs are present, or in 1st cell when there is a space between \"|\" and +/- ",
		"wikitext": "{|\n|-\n|style='color:red;'|+1\n|style='color:blue;'|-1\n|-\n|1||2||3\n|1||+2||-3\n|-\n| +1\n| -1\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|-|",
				"name": "table-delimiter"
			},
			{
				"text": "style='color:red;'",
				"name": "table-definition html-td"
			},
			{
				"text": "|",
				"name": "table-delimiter2"
			},
			{
				"text": "+1",
				"name": ""
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "style='color:blue;'",
				"name": "table-definition html-td"
			},
			{
				"text": "|",
				"name": "table-delimiter2"
			},
			{
				"text": "-1",
				"name": ""
			},
			{
				"text": "|-|",
				"name": "table-delimiter"
			},
			{
				"text": "1",
				"name": ""
			},
			{
				"text": "||",
				"name": "table-delimiter"
			},
			{
				"text": "2",
				"name": ""
			},
			{
				"text": "||",
				"name": "table-delimiter"
			},
			{
				"text": "3",
				"name": ""
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "1",
				"name": ""
			},
			{
				"text": "||",
				"name": "table-delimiter"
			},
			{
				"text": "+2",
				"name": ""
			},
			{
				"text": "||",
				"name": "table-delimiter"
			},
			{
				"text": "-3",
				"name": ""
			},
			{
				"text": "|-| ",
				"name": "table-delimiter"
			},
			{
				"text": "+1",
				"name": ""
			},
			{
				"text": "| ",
				"name": "table-delimiter"
			},
			{
				"text": "-1",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Table rowspan",
		"wikitext": "{| border=1\n|Cell 1, row 1\n|rowspan=2|Cell 2, row 1 (and 2)\n|Cell 3, row 1\n|-\n|Cell 1, row 2\n|Cell 3, row 2\n|}",
		"tokens": [
			{
				"text": "{| ",
				"name": "table-bracket"
			},
			{
				"text": "border=1",
				"name": "table-definition html-table"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "Cell 1, row 1",
				"name": ""
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "rowspan=2",
				"name": "table-definition html-td"
			},
			{
				"text": "|",
				"name": "table-delimiter2"
			},
			{
				"text": "Cell 2, row 1 (and 2)",
				"name": ""
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "Cell 3, row 1",
				"name": ""
			},
			{
				"text": "|-|",
				"name": "table-delimiter"
			},
			{
				"text": "Cell 1, row 2",
				"name": ""
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "Cell 3, row 2",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Nested table",
		"wikitext": "{| border=1\n| &alpha;\n|\n{| bgcolor=#ABCDEF border=2\n|nested\n|-\n|table\n|}\n|the original table again\n|}",
		"tokens": [
			{
				"text": "{| ",
				"name": "table-bracket"
			},
			{
				"text": "border=1",
				"name": "table-definition html-table"
			},
			{
				"text": "| ",
				"name": "table-delimiter"
			},
			{
				"text": "&alpha;",
				"name": "entity"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "{| ",
				"name": "table-bracket"
			},
			{
				"text": "bgcolor=#ABCDEF border=2",
				"name": "table-definition html-table"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "nested",
				"name": ""
			},
			{
				"text": "|-|",
				"name": "table-delimiter"
			},
			{
				"text": "table",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "the original table again",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Invalid attributes in table cell (T3830)",
		"wikitext": "{|\n|Cell:|broken\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "Cell:",
				"name": "table-definition html-td"
			},
			{
				"text": "|",
				"name": "table-delimiter2"
			},
			{
				"text": "broken",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Table cell attributes: Pipes protected by nowikis should be treated as a plain character",
		"wikitext": "{|\n|title=\"foo\" |bar\n|title=\"foo<nowiki>|</nowiki>\" |bar\n|title=\"foo<nowiki>|</nowiki>\" bar\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "title=\"foo\" ",
				"name": "table-definition html-td"
			},
			{
				"text": "|",
				"name": "table-delimiter2"
			},
			{
				"text": "bar",
				"name": ""
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "title=\"foo",
				"name": "table-definition html-td"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "|",
				"name": "tag-nowiki"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "\" ",
				"name": "table-definition html-td"
			},
			{
				"text": "|",
				"name": "table-delimiter2"
			},
			{
				"text": "bar",
				"name": ""
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "title=\"foo",
				"name": ""
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "|",
				"name": "tag-nowiki"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "\" bar",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Table cell attributes: Pipes protected by nested nowikis should be treated as a plain character",
		"wikitext": "{|\n|<code><nowiki>{{ACB|PG}}</nowiki></code>\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "code",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "<",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "{{ACB|PG}}",
				"name": "tag-nowiki"
			},
			{
				"text": "</",
				"name": "exttag-bracket"
			},
			{
				"text": "nowiki",
				"name": "exttag-name"
			},
			{
				"text": ">",
				"name": "exttag-bracket"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "code",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Table security: embedded pipes",
		"wikitext": "{|\n| |[ftp://|x||]\" onmouseover=\"alert(document.cookie)\">test",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "| ",
				"name": "table-delimiter"
			},
			{
				"text": "|",
				"name": "table-delimiter2"
			},
			{
				"text": "[",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "ftp://",
				"name": "link-ground extlink-protocol"
			},
			{
				"text": "|x||",
				"name": "link-ground extlink"
			},
			{
				"text": "]",
				"name": "link-ground extlink-bracket"
			},
			{
				"text": "\" onmouseover=\"alert(document.cookie)\">test",
				"name": ""
			}
		]
	},
	{
		"desc": "Element attributes with double ! should not be broken up by <th>",
		"wikitext": "{|\n!hi <div class=\"!!\">ha</div> ho\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "!",
				"name": "table-delimiter"
			},
			{
				"text": "hi ",
				"name": "strong"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "class=\"!!\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "ha",
				"name": "strong"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " ho",
				"name": "strong"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "! and || in element attributes should not be parsed as <th>/<td>",
		"wikitext": "{|\n|<div style=\"color: red !important;\" data-contrived=\"put this here ||\">hi</div>\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "div ",
				"name": "htmltag-name"
			},
			{
				"text": "style=\"color: red !important;\" data-contrived=\"put this here ||\"",
				"name": "htmltag-attribute html-div"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "hi",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "div",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "! and || in td attributes should not be parsed as <th>/<td>",
		"wikitext": "{|\n|style=\"color: red !important;\" data-contrived=\"put this here ||\"|foo\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "style=\"color: red !important;\" data-contrived=\"put this here ",
				"name": ""
			},
			{
				"text": "||",
				"name": "table-delimiter"
			},
			{
				"text": "\"",
				"name": "table-definition html-td"
			},
			{
				"text": "|",
				"name": "table-delimiter2"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Invalid text in table attributes should be discarded",
		"wikitext": "{| <span>boo</span> style='border:1px solid black'\n|  <span>boo</span> style='color:blue'  |1\n|<span>boo</span> style='color:blue'|2\n|}",
		"tokens": [
			{
				"text": "{| ",
				"name": "table-bracket"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "span",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "boo",
				"name": "table-definition html-table"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "span",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " style='border:1px solid black'",
				"name": "table-definition html-table"
			},
			{
				"text": "|  ",
				"name": "table-delimiter"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "span",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "boo",
				"name": "table-definition html-td"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "span",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " style='color:blue'  ",
				"name": "table-definition html-td"
			},
			{
				"text": "|",
				"name": "table-delimiter2"
			},
			{
				"text": "1",
				"name": ""
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "span",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "boo",
				"name": "table-definition html-td"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "span",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": " style='color:blue'",
				"name": "table-definition html-td"
			},
			{
				"text": "|",
				"name": "table-delimiter2"
			},
			{
				"text": "2",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "1. Template-generated table cell attributes and cell content",
		"wikitext": "{|\n|{{table_attribs}}\n| {{table_attribs}}\n|| {{table_attribs_5}}\n| <!--foo--> <!--bar--> <!--baz--> {{table_attribs}}\n|align=center {{table_attribs}}\n| <!--foo--> align=center <!--bar--> {{table_attribs}}\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "table_attribs",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "| ",
				"name": "table-delimiter"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "table_attribs",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "| ",
				"name": "table-delimiter2"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "table_attribs_5",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "| ",
				"name": "table-delimiter"
			},
			{
				"text": "<!--foo-->",
				"name": "comment"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "<!--bar-->",
				"name": "comment"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "<!--baz-->",
				"name": "comment"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "table_attribs",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "align=center ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "table_attribs",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "| ",
				"name": "table-delimiter"
			},
			{
				"text": "<!--foo-->",
				"name": "comment"
			},
			{
				"text": " align=center ",
				"name": ""
			},
			{
				"text": "<!--bar-->",
				"name": "comment"
			},
			{
				"text": " ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "table_attribs",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "2. Template-generated table cell attributes and cell content",
		"wikitext": "{|\n|{{table_attribs_2}}\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "table_attribs_2",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "3. Template-generated table cell attributes and cell content",
		"wikitext": "{|\n!align=center {{table_header_cells}}\n|-\n|align=center {{table_cells}}\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "!",
				"name": "table-delimiter"
			},
			{
				"text": "align=center ",
				"name": "strong"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "table_header_cells",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "|-|",
				"name": "table-delimiter"
			},
			{
				"text": "align=center ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "table_cells",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "4. Template-generated table cell attributes and cell content inside a templated table",
		"wikitext": "{{tbl-start}}\n!align=center {{table_header_cells}}\n|-\n|align=center {{table_cells}}\n{{tbl-end}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "tbl-start",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "!align=center ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "table_header_cells",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "|-|align=center ",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "table_cells",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "tbl-end",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Table with row followed by newlines and table heading",
		"wikitext": "{|\n|-\n\n!foo\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|-!",
				"name": "table-delimiter"
			},
			{
				"text": "foo",
				"name": "strong"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Table with empty line following the start tag",
		"wikitext": "{|\n\n|-\n|foo\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|-|",
				"name": "table-delimiter"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Table attributes with empty value",
		"wikitext": "{|\n| style=|hello\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "| ",
				"name": "table-delimiter"
			},
			{
				"text": "style=",
				"name": "table-definition html-td"
			},
			{
				"text": "|",
				"name": "table-delimiter2"
			},
			{
				"text": "hello",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Wikitext table with a lot of comments",
		"wikitext": "{|\n<!-- c0 -->\n|foo\n<!-- c1 -->\n|-<!-- c2 -->\n<!-- c3 -->\n|<!-- c4 -->\n<!-- c5 -->\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "<!-- c0 -->",
				"name": "comment"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "<!-- c1 -->",
				"name": "comment"
			},
			{
				"text": "|-",
				"name": "table-delimiter"
			},
			{
				"text": "<!-- c2 --><!-- c3 -->",
				"name": "comment"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "<!-- c4 --><!-- c5 -->",
				"name": "comment"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Wikitext table comments represented in parsoid dom",
		"wikitext": "{|<!--c1--><!--c2-->\n|-<!--c3-->\n|x\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "<!--c1--><!--c2-->",
				"name": "comment"
			},
			{
				"text": "|-",
				"name": "table-delimiter"
			},
			{
				"text": "<!--c3-->",
				"name": "comment"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "x",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Wikitext table with double-line table cell",
		"wikitext": "{|\n|a\nb\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "ab",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Table cell with a single comment",
		"wikitext": "{|\n|<!-- c1 -->\n|a\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "<!-- c1 -->",
				"name": "comment"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Table-cell after a comment-only-empty-line",
		"wikitext": "{|\n|a\n<!--c1-->\n<!--c2-->|b\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "a",
				"name": ""
			},
			{
				"text": "<!--c1--><!--c2-->",
				"name": "comment"
			},
			{
				"text": "|b",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Build table with {{!}}",
		"wikitext": "{{{!}} class=\"wikitable\"\n!header\n!second header\n{{!}}- style=\"color:red;\"\n{{!}}data{{!}}{{!}} style=\"color:red;\" {{!}}second data\n{{!}}}",
		"tokens": [
			{
				"text": "{{{!}} ",
				"name": "table-bracket"
			},
			{
				"text": "class=\"wikitable\"",
				"name": "table-definition html-table"
			},
			{
				"text": "!",
				"name": "table-delimiter"
			},
			{
				"text": "header",
				"name": "strong"
			},
			{
				"text": "!",
				"name": "table-delimiter"
			},
			{
				"text": "second header",
				"name": "strong"
			},
			{
				"text": "{{!}}- ",
				"name": "table-delimiter"
			},
			{
				"text": "style=\"color:red;\"",
				"name": "table-definition html-tr"
			},
			{
				"text": "{{!}}",
				"name": "table-delimiter"
			},
			{
				"text": "data",
				"name": ""
			},
			{
				"text": "{{!}}{{!}} ",
				"name": "table-delimiter"
			},
			{
				"text": "style=\"color:red;\" ",
				"name": "table-definition html-td"
			},
			{
				"text": "{{!}}",
				"name": "table-delimiter2"
			},
			{
				"text": "second data",
				"name": ""
			},
			{
				"text": "{{!}}}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Build table with pipe as data",
		"wikitext": "{| class=\"wikitable\"\n!header\n!second header\n|- style=\"color:red;\"\n|data|| style=\"color:red;\" |second data\n|-\n| style=\"color:red;\" |data with | || style=\"color:red;\" | second data with |\n|-\n||data with | |||second data with |\n|}",
		"tokens": [
			{
				"text": "{| ",
				"name": "table-bracket"
			},
			{
				"text": "class=\"wikitable\"",
				"name": "table-definition html-table"
			},
			{
				"text": "!",
				"name": "table-delimiter"
			},
			{
				"text": "header",
				"name": "strong"
			},
			{
				"text": "!",
				"name": "table-delimiter"
			},
			{
				"text": "second header",
				"name": "strong"
			},
			{
				"text": "|- ",
				"name": "table-delimiter"
			},
			{
				"text": "style=\"color:red;\"",
				"name": "table-definition html-tr"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "data",
				"name": ""
			},
			{
				"text": "|| ",
				"name": "table-delimiter"
			},
			{
				"text": "style=\"color:red;\" ",
				"name": "table-definition html-td"
			},
			{
				"text": "|",
				"name": "table-delimiter2"
			},
			{
				"text": "second data",
				"name": ""
			},
			{
				"text": "|-| ",
				"name": "table-delimiter"
			},
			{
				"text": "style=\"color:red;\" ",
				"name": "table-definition html-td"
			},
			{
				"text": "|",
				"name": "table-delimiter2"
			},
			{
				"text": "data with | ",
				"name": ""
			},
			{
				"text": "|| ",
				"name": "table-delimiter"
			},
			{
				"text": "style=\"color:red;\" ",
				"name": "table-definition html-td"
			},
			{
				"text": "| ",
				"name": "table-delimiter2"
			},
			{
				"text": "second data with |",
				"name": ""
			},
			{
				"text": "|-|",
				"name": "table-delimiter"
			},
			{
				"text": "|",
				"name": "table-delimiter2"
			},
			{
				"text": "data with | ",
				"name": ""
			},
			{
				"text": "||",
				"name": "table-delimiter"
			},
			{
				"text": "|",
				"name": "table-delimiter2"
			},
			{
				"text": "second data with |",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Build table with wikilink",
		"wikitext": "{| class=\"wikitable\"\n!header||second header\n|- style=\"color:red;\"\n|data [[Main Page|linktext]]||second data [[Main Page|linktext]]\n|-\n|data||second data [[Main Page|link|text with pipe]]\n|}",
		"tokens": [
			{
				"text": "{| ",
				"name": "table-bracket"
			},
			{
				"text": "class=\"wikitable\"",
				"name": "table-definition html-table"
			},
			{
				"text": "!",
				"name": "table-delimiter"
			},
			{
				"text": "header",
				"name": "strong"
			},
			{
				"text": "||",
				"name": "table-delimiter"
			},
			{
				"text": "second header",
				"name": "strong"
			},
			{
				"text": "|- ",
				"name": "table-delimiter"
			},
			{
				"text": "style=\"color:red;\"",
				"name": "table-definition html-tr"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "data ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "linktext",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "||",
				"name": "table-delimiter"
			},
			{
				"text": "second data ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "linktext",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "|-|",
				"name": "table-delimiter"
			},
			{
				"text": "data",
				"name": ""
			},
			{
				"text": "||",
				"name": "table-delimiter"
			},
			{
				"text": "second data ",
				"name": ""
			},
			{
				"text": "[[",
				"name": "link-ground link-bracket"
			},
			{
				"text": "Main Page",
				"name": "link-ground link-pagename pagename"
			},
			{
				"text": "|",
				"name": "link-ground link-delimiter"
			},
			{
				"text": "link|text with pipe",
				"name": "link-ground link-text"
			},
			{
				"text": "]]",
				"name": "link-ground link-bracket"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Fostered content in tables: Plain text",
		"wikitext": "{|\n|-\na\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|-",
				"name": "table-delimiter"
			},
			{
				"text": "a",
				"name": "error"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Template generated table cell with attributes",
		"wikitext": "{|\n|-\n{{table_attribs_4}} ||a||b\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|-",
				"name": "table-delimiter"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "table_attribs_4",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": " ||a||b",
				"name": "error"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Templated table cell with untemplated attributes: Cell combination tests",
		"wikitext": "{|\n|-\n!class=\"test\"{{table_cell_content|attr=! align=left}} /* th & th combine */\n|-\n|class=\"test\"{{table_cell_content}} /* td & td combine */\n|-\n!class=\"test\"{{table_cell_content}} /* th & td combine */\n|-\n|class=\"test\"{{table_cell_content|attr=! align=left}} /* td & th combine */\n|-\n|class=\"test\"{{table_cell_content|attr=style='color:red;'}}\n|-\n|class=\"test\"{{table_cell_content|cmt=<!--bar-->}}\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|-!",
				"name": "table-delimiter"
			},
			{
				"text": "class=\"test\"",
				"name": "strong"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "table_cell_content",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "attr=",
				"name": "template-ground template-argument-name"
			},
			{
				"text": "! align=left",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": " /* th & th combine */",
				"name": "strong"
			},
			{
				"text": "|-|",
				"name": "table-delimiter"
			},
			{
				"text": "class=\"test\"",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "table_cell_content",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": " /* td & td combine */",
				"name": ""
			},
			{
				"text": "|-!",
				"name": "table-delimiter"
			},
			{
				"text": "class=\"test\"",
				"name": "strong"
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "table_cell_content",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": " /* th & td combine */",
				"name": "strong"
			},
			{
				"text": "|-|",
				"name": "table-delimiter"
			},
			{
				"text": "class=\"test\"",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "table_cell_content",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "attr=",
				"name": "template-ground template-argument-name"
			},
			{
				"text": "! align=left",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": " /* td & th combine */",
				"name": ""
			},
			{
				"text": "|-|",
				"name": "table-delimiter"
			},
			{
				"text": "class=\"test\"",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "table_cell_content",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "attr=",
				"name": "template-ground template-argument-name"
			},
			{
				"text": "style='color:red;'",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "|-|",
				"name": "table-delimiter"
			},
			{
				"text": "class=\"test\"",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "table_cell_content",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "cmt=",
				"name": "template-ground template-argument-name"
			},
			{
				"text": "<!--bar-->",
				"name": "template-ground comment"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "T343874: Templated table that has a templated cell with untemplated attributes",
		"wikitext": "{{tbl-start}}\n|-\n|class=\"test\"{{table_cell_content}}\n|-\n|class=\"test\"{{table_cell_content|attr=! align=left}}\n{{tbl-end}}",
		"tokens": [
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "tbl-start",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "|-|class=\"test\"",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "table_cell_content",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "|-|class=\"test\"",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "table_cell_content",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "attr=",
				"name": "template-ground template-argument-name"
			},
			{
				"text": "! align=left",
				"name": "template-ground template"
			},
			{
				"text": "}}{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "tbl-end",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			}
		]
	},
	{
		"desc": "Templated table cell with untemplated attributes: Regression tests",
		"wikitext": "{|\n|class=\"foo\"\n{{1x|1={{!}}bar}}\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "class=\"foo\"",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "1=",
				"name": "template-ground template-argument-name"
			},
			{
				"text": "{{",
				"name": "template-ext-ground parserfunction-bracket"
			},
			{
				"text": "!",
				"name": "template-ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "template-ext-ground parserfunction-bracket"
			},
			{
				"text": "bar",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Templated table cell with untemplated attributes: Unsupported (standalone mode) Scenarios",
		"wikitext": "{|\n|-\n|class=\"foo\"{{1x|1= {{!}}bar}}\n|-\n|class=\"foo\"{{1x|1=&nbsp;{{!}}bar}}\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|-|",
				"name": "table-delimiter"
			},
			{
				"text": "class=\"foo\"",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "1=",
				"name": "template-ground template-argument-name"
			},
			{
				"text": " ",
				"name": "template-ground template"
			},
			{
				"text": "{{",
				"name": "template-ext-ground parserfunction-bracket"
			},
			{
				"text": "!",
				"name": "template-ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "template-ext-ground parserfunction-bracket"
			},
			{
				"text": "bar",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "|-|",
				"name": "table-delimiter"
			},
			{
				"text": "class=\"foo\"",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "1=",
				"name": "template-ground template-argument-name"
			},
			{
				"text": "&nbsp;",
				"name": "template-ground entity"
			},
			{
				"text": "{{",
				"name": "template-ext-ground parserfunction-bracket"
			},
			{
				"text": "!",
				"name": "template-ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "template-ext-ground parserfunction-bracket"
			},
			{
				"text": "bar",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Templated table cell with untemplated attributes: Unsupported Scenario",
		"wikitext": "{|\n|-\n|class=\"foo\"{{1x|1={{!}}title=\"fail\"{{!}}bar}}\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|-|",
				"name": "table-delimiter"
			},
			{
				"text": "class=\"foo\"",
				"name": ""
			},
			{
				"text": "{{",
				"name": "template-ground template-bracket"
			},
			{
				"text": "1x",
				"name": "template-ground template-name pagename"
			},
			{
				"text": "|",
				"name": "template-ground template-delimiter"
			},
			{
				"text": "1=",
				"name": "template-ground template-argument-name"
			},
			{
				"text": "{{",
				"name": "template-ext-ground parserfunction-bracket"
			},
			{
				"text": "!",
				"name": "template-ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "template-ext-ground parserfunction-bracket"
			},
			{
				"text": "title=\"fail\"",
				"name": "template-ground template"
			},
			{
				"text": "{{",
				"name": "template-ext-ground parserfunction-bracket"
			},
			{
				"text": "!",
				"name": "template-ext-ground parserfunction-name"
			},
			{
				"text": "}}",
				"name": "template-ext-ground parserfunction-bracket"
			},
			{
				"text": "bar",
				"name": "template-ground template"
			},
			{
				"text": "}}",
				"name": "template-ground template-bracket"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Parsoid: Round-trip tables directly followed by content (T53219)",
		"wikitext": "{|\n|foo\n|} bar\n\n{|\n|baz\n|}<b>quux</b>",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			},
			{
				"text": " bar",
				"name": ""
			},
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "|",
				"name": "table-delimiter"
			},
			{
				"text": "baz",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			},
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "b",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "quux",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "b",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "Parsoid: Row-syntax table headings followed by comment & table cells",
		"wikitext": "{|\n!foo||bar\n<!-- foo -->  ||baz||quux\n|}",
		"tokens": [
			{
				"text": "{|",
				"name": "table-bracket"
			},
			{
				"text": "!",
				"name": "table-delimiter"
			},
			{
				"text": "foo",
				"name": "strong"
			},
			{
				"text": "||",
				"name": "table-delimiter"
			},
			{
				"text": "bar",
				"name": "strong"
			},
			{
				"text": "<!-- foo -->",
				"name": "comment"
			},
			{
				"text": "  ||baz||quux",
				"name": "strong"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Parsoid: Recover better from broken table attributes",
		"wikitext": "{| class=\"foo\n| class=\"bar\" |\nfoo\n|}",
		"tokens": [
			{
				"text": "{| ",
				"name": "table-bracket"
			},
			{
				"text": "class=\"foo",
				"name": "table-definition html-table"
			},
			{
				"text": "| ",
				"name": "table-delimiter"
			},
			{
				"text": "class=\"bar\" ",
				"name": "table-definition html-td"
			},
			{
				"text": "|",
				"name": "table-delimiter2"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Tables: Digest broken attributes on table and tr tag",
		"wikitext": "{| || |} ++\n|- || || ++ --\n|- > [\n|}",
		"tokens": [
			{
				"text": "{| ",
				"name": "table-bracket"
			},
			{
				"text": "|| |} ++",
				"name": "table-definition html-table"
			},
			{
				"text": "|- ",
				"name": "table-delimiter"
			},
			{
				"text": "|| || ++ --",
				"name": "table-definition html-tr"
			},
			{
				"text": "|- ",
				"name": "table-delimiter"
			},
			{
				"text": "> [",
				"name": "table-definition html-tr"
			},
			{
				"text": "|}",
				"name": "table-bracket"
			}
		]
	},
	{
		"desc": "Table with missing opening <tr> tag",
		"wikitext": "<table>\n<td>foo</td>\n</tr>\n</table>",
		"tokens": [
			{
				"text": "<",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": "><",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "foo",
				"name": ""
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "td",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			},
			{
				"text": "</tr>",
				"name": "error"
			},
			{
				"text": "</",
				"name": "htmltag-bracket"
			},
			{
				"text": "table",
				"name": "htmltag-name"
			},
			{
				"text": ">",
				"name": "htmltag-bracket"
			}
		]
	},
	{
		"desc": "wtEscaping"
	},
	{
		"desc": "Headings: 4d. Short headings (2)",
		"wikitext": "=\n==\n===\n====\n=====",
		"tokens": [
			{
				"text": "===",
				"name": ""
			},
			{
				"text": "=",
				"name": "section-header section--1"
			},
			{
				"text": "=",
				"name": "section"
			},
			{
				"text": "=",
				"name": "section-header"
			},
			{
				"text": "=",
				"name": "section-header section--1"
			},
			{
				"text": "==",
				"name": "section"
			},
			{
				"text": "=",
				"name": "section-header"
			},
			{
				"text": "==",
				"name": "section-header section--2"
			},
			{
				"text": "=",
				"name": "section"
			},
			{
				"text": "==",
				"name": "section-header"
			}
		]
	},
	{
		"desc": "Headings: Used as horizontal rule",
		"wikitext": "===============",
		"tokens": [
			{
				"text": "======",
				"name": "section-header section--6"
			},
			{
				"text": "===",
				"name": "section"
			},
			{
				"text": "======",
				"name": "section-header"
			}
		]
	}
]
